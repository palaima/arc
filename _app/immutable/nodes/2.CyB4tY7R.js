var bl=Object.defineProperty;var wl=(s,e,t)=>e in s?bl(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Re=(s,e,t)=>wl(s,typeof e!="symbol"?e+"":e,t);import{s as ve,n as $,d as m,r as qe,P as ue,Q as ie,e as W,f as H,h as f,R as se,A as u,j as b,k as E,S as Z,m as A,T as Pe,l as B,o as w,p as I,U as He,t as j,q as Be,V as Ke,v as Ee,W as kl,X as El,Y as Sl,i as Dl,c as Cl,u as yl,g as Tl,b as Al,Z as Ie,_ as he,B as be,C as cl,$ as Il,a0 as Ul,x as Ll}from"../chunks/DuLw_OxG.js";import{S as me,i as pe,t as Q,a as K,g as we,c as ke,d as Se,m as De,e as Ce,b as ye,f as Vl}from"../chunks/CgOCePFP.js";import{w as Qe,d as fl}from"../chunks/MwhEiSeW.js";function oe(s){return s?.length!==void 0?s:Array.from(s)}const Ml=!0,Nl=!1,Ss=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ml,ssr:Nl},Symbol.toStringTag,{value:"Module"}));function Pl(){const{subscribe:s,set:e,update:t}=Qe({isUnlocked:!1,masterPassword:null,error:null});return{subscribe:s,unlock:l=>{t(r=>({...r,isUnlocked:!0,masterPassword:l,error:null}))},setError:l=>{t(r=>({...r,error:l}))},clearError:()=>{t(l=>({...l,error:null}))},reset:()=>{e({isUnlocked:!1,masterPassword:null,error:null})}}}const Me=Pl();function Hl(){const{subscribe:s,set:e,update:t}=Qe(new Map);return{subscribe:s,add:(l,r)=>{t(a=>{const n=new Map(a);return n.set(l,r),n})},get:l=>{let r;return s(a=>{r=a.get(l)})(),r},has:l=>{let r=!1;return s(a=>{r=a.has(l)})(),r},clear:()=>{e(new Map)}}}const ul=Hl();function Bl(){const{subscribe:s,set:e,update:t}=Qe({archives:[],isLoading:!1,error:null});return{subscribe:s,setArchives:l=>{e({archives:l,isLoading:!1,error:null})},setLoading:l=>{t(r=>({...r,isLoading:l}))},setError:l=>{t(r=>({...r,error:l,isLoading:!1}))},reset:()=>{e({archives:[],isLoading:!1,error:null})}}}const tt=Bl(),jl=fl(tt,s=>{if(!s.archives.length)return[];const e=new Map,t=new Map;return s.archives.forEach(l=>{const r=`${l.server_id}-${l.channel_id}`;t.has(r)||t.set(r,[]),t.get(r).push(l)}),t.forEach((l,r)=>{l.sort((i,o)=>new Date(o.exported_at).getTime()-new Date(i.exported_at).getTime());const a=l[0];e.has(a.server_id)||e.set(a.server_id,{id:a.server_id,name:a.server_name,channels:[]});const n={...a,versions:l,versionCount:l.length};e.get(a.server_id).channels.push(n)}),Array.from(e.values())}),Fl=fl(tt,s=>{const e=new Set(s.archives.map(l=>l.server_id)),t=new Set(s.archives.map(l=>l.channel_id));return{totalArchives:s.archives.length,uniqueServers:e.size,uniqueChannels:t.size}}),Fe={github:{repoUrl:"",branch:"master",pat:void 0}},Je={archiveSource:"github",localServerUrl:"http://127.0.0.1:8000",github:{repoUrl:"",branch:Fe.github.branch,pat:Fe.github.pat}},Ye="discord-archiver-settings";function Ol(){try{const s=localStorage.getItem(Ye);if(s){const e=JSON.parse(s);return e.repoUrl!==void 0?{...Je,github:{repoUrl:e.repoUrl||"",branch:e.branch||"main",pat:e.pat}}:{...Je,...e}}}catch(s){console.error("Failed to load settings from localStorage:",s)}return Je}function ql(){const{subscribe:s,set:e,update:t}=Qe(Ol());return{subscribe:s,set:l=>{try{localStorage.setItem(Ye,JSON.stringify(l))}catch(r){console.error("Failed to save settings to localStorage:",r)}e(l)},update:l=>{t(r=>{const a=l(r);try{localStorage.setItem(Ye,JSON.stringify(a))}catch(n){console.error("Failed to save settings to localStorage:",n)}return a})},reset:()=>{try{localStorage.removeItem(Ye)}catch(l){console.error("Failed to remove settings from localStorage:",l)}e(Je)}}}const Ne=ql();var de=Uint8Array,Oe=Uint16Array,Rl=Int32Array,hl=new de([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dl=new de([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zl=new de([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vl=function(s,e){for(var t=new Oe(31),l=0;l<31;++l)t[l]=e+=1<<s[l-1];for(var r=new Rl(t[30]),l=1;l<30;++l)for(var a=t[l];a<t[l+1];++a)r[a]=a-t[l]<<5|l;return{b:t,r}},ml=vl(hl,2),pl=ml.b,Gl=ml.r;pl[28]=258,Gl[258]=28;var Kl=vl(dl,0),Wl=Kl.b,et=new Oe(32768);for(var ne=0;ne<32768;++ne){var Le=(ne&43690)>>1|(ne&21845)<<1;Le=(Le&52428)>>2|(Le&13107)<<2,Le=(Le&61680)>>4|(Le&3855)<<4,et[ne]=((Le&65280)>>8|(Le&255)<<8)>>1}var Ge=function(s,e,t){for(var l=s.length,r=0,a=new Oe(e);r<l;++r)s[r]&&++a[s[r]-1];var n=new Oe(e);for(r=1;r<e;++r)n[r]=n[r-1]+a[r-1]<<1;var i;if(t){i=new Oe(1<<e);var o=15-e;for(r=0;r<l;++r)if(s[r])for(var c=r<<4|s[r],d=e-s[r],h=n[s[r]-1]++<<d,p=h|(1<<d)-1;h<=p;++h)i[et[h]>>o]=c}else for(i=new Oe(l),r=0;r<l;++r)s[r]&&(i[r]=et[n[s[r]-1]++]>>15-s[r]);return i},We=new de(288);for(var ne=0;ne<144;++ne)We[ne]=8;for(var ne=144;ne<256;++ne)We[ne]=9;for(var ne=256;ne<280;++ne)We[ne]=7;for(var ne=280;ne<288;++ne)We[ne]=8;var _l=new de(32);for(var ne=0;ne<32;++ne)_l[ne]=5;var Jl=Ge(We,9,1),Yl=Ge(_l,5,1),Xe=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},Te=function(s,e,t){var l=e/8|0;return(s[l]|s[l+1]<<8)>>(e&7)&t},xe=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},Zl=function(s){return(s+7)/8|0},Ql=function(s,e,t){return(t==null||t>s.length)&&(t=s.length),new de(s.subarray(e,t))},Xl=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ae=function(s,e,t){var l=new Error(e||Xl[s]);if(l.code=s,Error.captureStackTrace&&Error.captureStackTrace(l,Ae),!t)throw l;return l},xl=function(s,e,t,l){var r=s.length,a=0;if(!r||e.f&&!e.l)return t||new de(0);var n=!t,i=n||e.i!=2,o=e.i;n&&(t=new de(r*3));var c=function(ge){var je=t.length;if(ge>je){var Ve=new de(Math.max(je*2,ge));Ve.set(t),t=Ve}},d=e.f||0,h=e.p||0,p=e.b||0,v=e.l,_=e.d,g=e.m,k=e.n,S=r*8;do{if(!v){d=Te(s,h,1);var N=Te(s,h+1,3);if(h+=3,N)if(N==1)v=Jl,_=Yl,g=9,k=5;else if(N==2){var L=Te(s,h,31)+257,U=Te(s,h+10,15)+4,C=L+Te(s,h+5,31)+1;h+=14;for(var D=new de(C),T=new de(19),y=0;y<U;++y)T[zl[y]]=Te(s,h+y*3,7);h+=U*3;for(var O=Xe(T),F=(1<<O)-1,z=Ge(T,O,1),y=0;y<C;){var X=z[Te(s,h,F)];h+=X&15;var M=X>>4;if(M<16)D[y++]=M;else{var re=0,ae=0;for(M==16?(ae=3+Te(s,h,3),h+=2,re=D[y-1]):M==17?(ae=3+Te(s,h,7),h+=3):M==18&&(ae=11+Te(s,h,127),h+=7);ae--;)D[y++]=re}}var te=D.subarray(0,L),J=D.subarray(L);g=Xe(te),k=Xe(J),v=Ge(te,g,1),_=Ge(J,k,1)}else Ae(1);else{var M=Zl(h)+4,P=s[M-4]|s[M-3]<<8,V=M+P;if(V>r){o&&Ae(0);break}i&&c(p+P),t.set(s.subarray(M,V),p),e.b=p+=P,e.p=h=V*8,e.f=d;continue}if(h>S){o&&Ae(0);break}}i&&c(p+131072);for(var R=(1<<g)-1,le=(1<<k)-1,ee=h;;ee=h){var re=v[xe(s,h)&R],Y=re>>4;if(h+=re&15,h>S){o&&Ae(0);break}if(re||Ae(2),Y<256)t[p++]=Y;else if(Y==256){ee=h,v=null;break}else{var G=Y-254;if(Y>264){var y=Y-257,q=hl[y];G=Te(s,h,(1<<q)-1)+pl[y],h+=q}var x=_[xe(s,h)&le],ce=x>>4;x||Ae(3),h+=x&15;var J=Wl[ce];if(ce>3){var q=dl[ce];J+=xe(s,h)&(1<<q)-1,h+=q}if(h>S){o&&Ae(0);break}i&&c(p+131072);var fe=p+G;if(p<J){var _e=a-J,Ue=Math.min(J,fe);for(_e+p<0&&Ae(3);p<Ue;++p)t[p]=l[_e+p]}for(;p<fe;++p)t[p]=t[p-J]}}e.l=v,e.p=ee,e.b=p,e.f=d,v&&(d=1,e.m=g,e.d=_,e.n=k)}while(!d);return p!=t.length&&n?Ql(t,0,p):t.subarray(0,p)},$l=new de(0),er=function(s){(s[0]!=31||s[1]!=139||s[2]!=8)&&Ae(6,"invalid gzip data");var e=s[3],t=10;e&4&&(t+=(s[10]|s[11]<<8)+2);for(var l=(e>>3&1)+(e>>4&1);l>0;l-=!s[t++]);return t+(e&2)},tr=function(s){var e=s.length;return(s[e-4]|s[e-3]<<8|s[e-2]<<16|s[e-1]<<24)>>>0};function lr(s,e){var t=er(s);return t+8>s.length&&Ae(6,"invalid gzip data"),xl(s.subarray(t,-8),{i:2},new de(tr(s)),e)}var rr=typeof TextDecoder<"u"&&new TextDecoder,sr=0;try{rr.decode($l,{stream:!0}),sr=1}catch{}const nr=6e5;async function ar(s,e){const t=new TextEncoder,l=await crypto.subtle.importKey("raw",t.encode(s),"PBKDF2",!1,["deriveBits"]),r=await crypto.subtle.deriveBits({name:"PBKDF2",salt:e,iterations:nr,hash:"SHA-256"},l,256);return await crypto.subtle.importKey("raw",r,"AES-GCM",!0,["encrypt","decrypt"])}async function ir(s){const t=new TextEncoder().encode(s),l=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(l)).map(n=>n.toString(16).padStart(2,"0")).join("").substring(0,8)}async function or(s,e){return await ir(s)===e}const ze=8,$e=12;async function gl(s,e){if(s.length<ze+$e)throw new Error("Invalid encrypted data: too short");const t=s.slice(0,ze),l=s.slice(ze,ze+$e),r=s.slice(ze+$e),a=await ar(e,t),n=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},a,r);try{return lr(new Uint8Array(n))}catch(i){throw new Error(`Decompression failed: ${i instanceof Error?i.message:"unknown error"}`)}}async function cr(s,e){const t=await gl(s,e),r=new TextDecoder().decode(t);return JSON.parse(r)}async function fr(s,e){const t=await e.fetchMetadata();return await cr(t,s)}async function ur(s,e,t){const l=await t.fetchFile(s);return await gl(l,e)}function hr(s,e){const t=e.format==="html"||e.format.startsWith("html")?"text/html":e.format==="json"?"application/json":"text/plain",l=new Blob([s],{type:t});return URL.createObjectURL(l)}class lt{constructor(e){Re(this,"repoUrl");Re(this,"branch");Re(this,"pat");this.repoUrl=e.repoUrl,this.branch=e.branch,this.pat=e.pat}async fetchFile(e){const t=e.startsWith("/")?e.slice(1):e,l=`https://api.github.com/repos/${this.repoUrl}/contents/${t}?ref=${this.branch}`,r={Accept:"application/vnd.github.v3.raw"};this.pat&&(r.Authorization=`token ${this.pat}`);const a=await fetch(l,{headers:r});if(!a.ok)throw a.status===404?new Error(`File not found in GitHub repository: ${e}`):a.status===401||a.status===403?new Error("GitHub authentication failed. A Personal Access Token is required for private repositories. Please add your PAT in Settings."):new Error(`Failed to fetch file from GitHub: ${a.status} ${a.statusText}`);const n=await a.arrayBuffer();return new Uint8Array(n)}async fetchMetadata(){return this.fetchFile(".archive_metadata.json.enc")}async fetchArchive(e){return this.fetchFile(e)}async testConnection(){try{return await this.fetchMetadata(),!0}catch(e){return console.error("GitHub connection test failed:",e),!1}}}class Ze{constructor(e=""){Re(this,"baseUrl");this.baseUrl=e}async fetchFile(e){const t=e.startsWith("/")?e:`/${e}`,l=this.baseUrl?`${this.baseUrl}${t}`:t,r=await fetch(l);if(!r.ok)throw r.status===404?new Error(`File not found on local server: ${e}`):new Error(`Failed to fetch file from local server: ${r.status} ${r.statusText}`);const a=await r.arrayBuffer();return new Uint8Array(a)}async fetchMetadata(){return this.fetchFile(".archive_metadata.json.enc")}async fetchArchive(e){return this.fetchFile(e)}async testConnection(){try{return await this.fetchMetadata(),!0}catch(e){return console.error("Local server connection test failed:",e),!1}}}function st(s){let e,t,l,r,a,n;return{c(){e=w("div"),t=He("svg"),l=He("path"),r=I(),a=w("span"),n=j(s[2]),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=E(e);t=Pe(o,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var c=E(t);l=Pe(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),E(l).forEach(m),c.forEach(m),r=A(o),a=b(o,"SPAN",{class:!0});var d=E(a);n=B(d,s[2]),d.forEach(m),o.forEach(m),this.h()},h(){u(l,"stroke-linecap","round"),u(l,"stroke-linejoin","round"),u(l,"stroke-width","2"),u(l,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"class","stroke-current shrink-0 h-6 w-6"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(a,"class","text-sm"),u(e,"class","alert alert-error mb-3")},m(i,o){H(i,e,o),f(e,t),f(t,l),f(e,r),f(e,a),f(a,n)},p(i,o){o&4&&W(n,i[2])},d(i){i&&m(e)}}}function dr(s){let e,t,l,r="Master Password Required",a,n,i="Enter your master password to decrypt the archive metadata and browse your archives.",o,c,d,h,p,v,_,g,k,S,N,M,P=s[1]?"Unlocking...":"Unlock",V,L,U,C=s[2]&&st(s);return{c(){e=w("dialog"),t=w("div"),l=w("h3"),l.textContent=r,a=I(),n=w("p"),n.textContent=i,o=I(),c=w("input"),d=I(),C&&C.c(),h=I(),p=w("div"),v=w("button"),_=He("svg"),g=He("path"),k=He("path"),S=j(`
				Settings`),N=I(),M=w("button"),V=j(P),this.h()},l(D){e=b(D,"DIALOG",{class:!0});var T=E(e);t=b(T,"DIV",{class:!0});var y=E(t);l=b(y,"H3",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-12v7ilt"&&(l.textContent=r),a=A(y),n=b(y,"P",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-7uye46"&&(n.textContent=i),o=A(y),c=b(y,"INPUT",{type:!0,placeholder:!0,class:!0}),d=A(y),C&&C.l(y),h=A(y),p=b(y,"DIV",{class:!0});var O=E(p);v=b(O,"BUTTON",{class:!0});var F=E(v);_=Pe(F,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var z=E(_);g=Pe(z,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),E(g).forEach(m),k=Pe(z,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),E(k).forEach(m),z.forEach(m),S=B(F,`
				Settings`),F.forEach(m),N=A(O),M=b(O,"BUTTON",{class:!0});var X=E(M);V=B(X,P),X.forEach(m),O.forEach(m),y.forEach(m),T.forEach(m),this.h()},h(){u(l,"class","font-bold text-lg mb-2"),u(n,"class","text-sm text-base-content/70 mb-4"),u(c,"type","password"),u(c,"placeholder","Master password"),u(c,"class","input input-bordered w-full mb-3"),c.disabled=s[1],c.autofocus=!0,ie(c,"input-error",s[2]),u(g,"stroke-linecap","round"),u(g,"stroke-linejoin","round"),u(g,"stroke-width","2"),u(g,"d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"),u(k,"stroke-linecap","round"),u(k,"stroke-linejoin","round"),u(k,"stroke-width","2"),u(k,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),u(_,"xmlns","http://www.w3.org/2000/svg"),u(_,"class","h-4 w-4 mr-1"),u(_,"fill","none"),u(_,"viewBox","0 0 24 24"),u(_,"stroke","currentColor"),u(v,"class","btn btn-ghost btn-sm"),v.disabled=s[1],u(M,"class","btn btn-primary"),M.disabled=s[1],ie(M,"loading",s[1]),u(p,"class","modal-action flex justify-between items-center"),u(t,"class","modal-box bg-base-200"),u(e,"class","modal modal-open")},m(D,T){H(D,e,T),f(e,t),f(t,l),f(t,a),f(t,n),f(t,o),f(t,c),ue(c,s[0]),f(t,d),C&&C.m(t,null),f(t,h),f(t,p),f(p,v),f(v,_),f(_,g),f(_,k),f(v,S),f(p,N),f(p,M),f(M,V),c.focus(),L||(U=[se(c,"input",s[8]),se(c,"keypress",s[4]),se(v,"click",s[5]),se(M,"click",s[3])],L=!0)},p(D,[T]){T&2&&(c.disabled=D[1]),T&1&&c.value!==D[0]&&ue(c,D[0]),T&4&&ie(c,"input-error",D[2]),D[2]?C?C.p(D,T):(C=st(D),C.c(),C.m(t,h)):C&&(C.d(1),C=null),T&2&&(v.disabled=D[1]),T&2&&P!==(P=D[1]?"Unlocking...":"Unlock")&&W(V,P),T&2&&(M.disabled=D[1]),T&2&&ie(M,"loading",D[1])},i:$,o:$,d(D){D&&m(e),C&&C.d(),L=!1,qe(U)}}}function vr(s,e,t){let l,r,a,n;Be(s,Me,_=>t(6,a=_)),Be(s,Ne,_=>t(7,n=_));const i=Ke();let o="",c=!1;async function d(){if(!o){Me.setError("Password cannot be empty");return}if(n.archiveSource==="github"&&!n.github.repoUrl){Me.setError("GitHub repository not configured. Please check settings.");return}t(1,c=!0),Me.clearError();try{const _=await fr(o,l);Me.unlock(o),tt.setArchives(_.archives||[])}catch(_){console.error("Decryption error:",_),Me.setError("Incorrect password or corrupted metadata file"),t(0,o="")}finally{t(1,c=!1)}}function h(_){_.key==="Enter"&&d()}function p(){i("openSettings")}function v(){o=this.value,t(0,o)}return s.$$.update=()=>{s.$$.dirty&128&&(l=n.archiveSource==="local"?new Ze(n.localServerUrl):new lt(n.github)),s.$$.dirty&64&&t(2,r=a.error)},[o,c,r,d,h,p,a,n,v]}class mr extends me{constructor(e){super(),pe(this,e,vr,dr,ve,{})}}function nt(s){let e,t,l,r="Archive Password Required",a,n,i="This archive is encrypted. Enter the password to decrypt and view it.",o,c,d,h,p,v,_,g,k,S,N=s[3]?"Decrypting...":"Decrypt",M,P,V,L="<button>close</button>",U,C,D=s[1]?.secret_hint&&at(s),T=s[4]&&it(s);return{c(){e=w("dialog"),t=w("div"),l=w("h3"),l.textContent=r,a=I(),n=w("p"),n.textContent=i,o=I(),D&&D.c(),c=I(),d=w("input"),h=I(),T&&T.c(),p=I(),v=w("div"),_=w("button"),g=j("Cancel"),k=I(),S=w("button"),M=j(N),P=I(),V=w("form"),V.innerHTML=L,this.h()},l(y){e=b(y,"DIALOG",{class:!0});var O=E(e);t=b(O,"DIV",{class:!0});var F=E(t);l=b(F,"H3",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-j0hl0n"&&(l.textContent=r),a=A(F),n=b(F,"P",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-oo4ac9"&&(n.textContent=i),o=A(F),D&&D.l(F),c=A(F),d=b(F,"INPUT",{type:!0,placeholder:!0,class:!0}),h=A(F),T&&T.l(F),p=A(F),v=b(F,"DIV",{class:!0});var z=E(v);_=b(z,"BUTTON",{class:!0});var X=E(_);g=B(X,"Cancel"),X.forEach(m),k=A(z),S=b(z,"BUTTON",{class:!0});var re=E(S);M=B(re,N),re.forEach(m),z.forEach(m),F.forEach(m),P=A(O),V=b(O,"FORM",{method:!0,class:!0,"data-svelte-h":!0}),Z(V)!=="svelte-1v3agxd"&&(V.innerHTML=L),O.forEach(m),this.h()},h(){u(l,"class","font-bold text-lg mb-2"),u(n,"class","text-sm text-base-content/70 mb-3"),u(d,"type","password"),u(d,"placeholder","Archive password"),u(d,"class","input input-bordered w-full mb-3"),d.disabled=s[3],d.autofocus=!0,ie(d,"input-error",s[4]),u(_,"class","btn btn-ghost"),_.disabled=s[3],u(S,"class","btn btn-primary"),S.disabled=s[3],ie(S,"loading",s[3]),u(v,"class","modal-action"),u(t,"class","modal-box bg-base-200"),u(V,"method","dialog"),u(V,"class","modal-backdrop"),u(e,"class","modal modal-open")},m(y,O){H(y,e,O),f(e,t),f(t,l),f(t,a),f(t,n),f(t,o),D&&D.m(t,null),f(t,c),f(t,d),ue(d,s[2]),f(t,h),T&&T.m(t,null),f(t,p),f(t,v),f(v,_),f(_,g),f(v,k),f(v,S),f(S,M),f(e,P),f(e,V),d.focus(),U||(C=[se(d,"input",s[8]),se(d,"keypress",s[7]),se(_,"click",s[6]),se(S,"click",s[5]),se(V,"click",s[6])],U=!0)},p(y,O){y[1]?.secret_hint?D?D.p(y,O):(D=at(y),D.c(),D.m(t,c)):D&&(D.d(1),D=null),O&8&&(d.disabled=y[3]),O&4&&d.value!==y[2]&&ue(d,y[2]),O&16&&ie(d,"input-error",y[4]),y[4]?T?T.p(y,O):(T=it(y),T.c(),T.m(t,p)):T&&(T.d(1),T=null),O&8&&(_.disabled=y[3]),O&8&&N!==(N=y[3]?"Decrypting...":"Decrypt")&&W(M,N),O&8&&(S.disabled=y[3]),O&8&&ie(S,"loading",y[3])},d(y){y&&m(e),D&&D.d(),T&&T.d(),U=!1,qe(C)}}}function at(s){let e,t,l="Password hint:",r,a,n=s[1].secret_hint+"",i;return{c(){e=w("div"),t=w("span"),t.textContent=l,r=I(),a=w("span"),i=j(n),this.h()},l(o){e=b(o,"DIV",{class:!0});var c=E(e);t=b(c,"SPAN",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-ngl7h5"&&(t.textContent=l),r=A(c),a=b(c,"SPAN",{class:!0});var d=E(a);i=B(d,n),d.forEach(m),c.forEach(m),this.h()},h(){u(t,"class","text-xs text-base-content/50"),u(a,"class","text-sm font-mono ml-2"),u(e,"class","bg-base-300 rounded px-3 py-2 mb-3")},m(o,c){H(o,e,c),f(e,t),f(e,r),f(e,a),f(a,i)},p(o,c){c&2&&n!==(n=o[1].secret_hint+"")&&W(i,n)},d(o){o&&m(e)}}}function it(s){let e,t,l,r,a,n;return{c(){e=w("div"),t=He("svg"),l=He("path"),r=I(),a=w("span"),n=j(s[4]),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=E(e);t=Pe(o,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var c=E(t);l=Pe(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),E(l).forEach(m),c.forEach(m),r=A(o),a=b(o,"SPAN",{class:!0});var d=E(a);n=B(d,s[4]),d.forEach(m),o.forEach(m),this.h()},h(){u(l,"stroke-linecap","round"),u(l,"stroke-linejoin","round"),u(l,"stroke-width","2"),u(l,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"class","stroke-current shrink-0 h-6 w-6"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(a,"class","text-sm"),u(e,"class","alert alert-error mb-3")},m(i,o){H(i,e,o),f(e,t),f(t,l),f(e,r),f(e,a),f(a,n)},p(i,o){o&16&&W(n,i[4])},d(i){i&&m(e)}}}function pr(s){let e,t=s[0]&&nt(s);return{c(){t&&t.c(),e=Ee()},l(l){t&&t.l(l),e=Ee()},m(l,r){t&&t.m(l,r),H(l,e,r)},p(l,[r]){l[0]?t?t.p(l,r):(t=nt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&m(e),t&&t.d(l)}}}function _r(s,e,t){let{archive:l=null}=e,{show:r=!1}=e;const a=Ke();let n="",i=!1,o="";async function c(){if(!l||!n){t(4,o="Password cannot be empty");return}t(3,i=!0),t(4,o="");try{if(!await or(n,l.secret_hint))throw new Error("Password hint mismatch");ul.add(l.secret_hint,n),a("unlock",{archive:l,password:n}),d()}catch(v){console.error("Archive unlock error:",v),t(4,o="Incorrect password"),t(2,n="")}finally{t(3,i=!1)}}function d(){t(0,r=!1),t(2,n=""),t(4,o="")}function h(v){v.key==="Enter"?c():v.key==="Escape"&&d()}function p(){n=this.value,t(2,n)}return s.$$set=v=>{"archive"in v&&t(1,l=v.archive),"show"in v&&t(0,r=v.show)},[r,l,n,i,o,c,d,h,p]}class gr extends me{constructor(e){super(),pe(this,e,_r,pr,ve,{archive:1,show:0})}}function ot(s){let e,t,l,r,a=s[0]?"Archive Configuration Required":"Archive Settings",n,i,o,c,d,h,p,v,_,g,k,S=s[0]?"Continue":"Save Settings",N,M,P,V;function L(F,z){return F[0]?wr:br}let U=L(s),C=U(s),D=s[8]&&ct(s),T=s[8]&&s[2].archiveSource==="local"&&ft(s),y=(!s[8]||s[2].archiveSource==="github")&&ht(s),O=!s[0]&&mt(s);return{c(){e=w("div"),t=w("div"),l=w("div"),r=w("h2"),n=j(a),i=I(),o=w("p"),C.c(),c=I(),d=w("div"),D&&D.c(),h=I(),T&&T.c(),p=I(),y&&y.c(),v=I(),_=w("div"),O&&O.c(),g=I(),k=w("button"),N=j(S),this.h()},l(F){e=b(F,"DIV",{class:!0,role:!0,"aria-labelledby":!0,"aria-modal":!0});var z=E(e);t=b(z,"DIV",{class:!0,role:!0});var X=E(t);l=b(X,"DIV",{class:!0});var re=E(l);r=b(re,"H2",{id:!0,class:!0});var ae=E(r);n=B(ae,a),ae.forEach(m),i=A(re),o=b(re,"P",{class:!0});var te=E(o);C.l(te),te.forEach(m),re.forEach(m),c=A(X),d=b(X,"DIV",{class:!0});var J=E(d);D&&D.l(J),h=A(J),T&&T.l(J),p=A(J),y&&y.l(J),J.forEach(m),v=A(X),_=b(X,"DIV",{class:!0});var R=E(_);O&&O.l(R),g=A(R),k=b(R,"BUTTON",{class:!0});var le=E(k);N=B(le,S),le.forEach(m),R.forEach(m),X.forEach(m),z.forEach(m),this.h()},h(){u(r,"id","settings-title"),u(r,"class","text-2xl font-bold"),u(o,"class","text-sm text-base-content/70 mt-1"),u(l,"class","border-b border-base-300 p-6"),u(d,"class","p-6 space-y-6"),u(k,"class","btn btn-primary"),k.disabled=M=!s[7],u(_,"class","border-t border-base-300 p-6 flex justify-end gap-3"),u(t,"class","bg-base-200 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"),u(t,"role","document"),u(e,"class","fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center"),u(e,"role","dialog"),u(e,"aria-labelledby","settings-title"),u(e,"aria-modal","true")},m(F,z){H(F,e,z),f(e,t),f(t,l),f(l,r),f(r,n),f(l,i),f(l,o),C.m(o,null),f(t,c),f(t,d),D&&D.m(d,null),f(d,h),T&&T.m(d,null),f(d,p),y&&y.m(d,null),f(t,v),f(t,_),O&&O.m(_,null),f(_,g),f(_,k),f(k,N),P||(V=[se(k,"click",s[9]),se(t,"click",kl(s[15])),se(t,"keydown",s[13]),se(e,"click",function(){Dl(s[0]?void 0:s[10])&&(s[0]?void 0:s[10]).apply(this,arguments)})],P=!0)},p(F,z){s=F,z&1&&a!==(a=s[0]?"Archive Configuration Required":"Archive Settings")&&W(n,a),U!==(U=L(s))&&(C.d(1),C=U(s),C&&(C.c(),C.m(o,null))),s[8]?D?D.p(s,z):(D=ct(s),D.c(),D.m(d,h)):D&&(D.d(1),D=null),s[8]&&s[2].archiveSource==="local"?T?T.p(s,z):(T=ft(s),T.c(),T.m(d,p)):T&&(T.d(1),T=null),!s[8]||s[2].archiveSource==="github"?y?y.p(s,z):(y=ht(s),y.c(),y.m(d,null)):y&&(y.d(1),y=null),s[0]?O&&(O.d(1),O=null):O?O.p(s,z):(O=mt(s),O.c(),O.m(_,g)),z&1&&S!==(S=s[0]?"Continue":"Save Settings")&&W(N,S),z&128&&M!==(M=!s[7])&&(k.disabled=M)},d(F){F&&m(e),C.d(),D&&D.d(),T&&T.d(),y&&y.d(),O&&O.d(),P=!1,qe(V)}}}function br(s){let e;return{c(){e=j("Configure archive source and connection settings")},l(t){e=B(t,"Configure archive source and connection settings")},m(t,l){H(t,e,l)},d(t){t&&m(e)}}}function wr(s){let e;return{c(){e=j("Configure where to load archives from")},l(t){e=B(t,"Configure where to load archives from")},m(t,l){H(t,e,l)},d(t){t&&m(e)}}}function ct(s){let e,t,l='<span class="label-text font-semibold">Archive Source</span>',r,a,n,i,o,c,d='<span class="font-medium">Local Server</span> <p class="text-sm text-base-content/70">Connect to a local development server (requires <code>uv run discord-archiver serve</code>)</p>',h,p,v,_,g,k='<span class="font-medium">GitHub Repository</span> <p class="text-sm text-base-content/70">Fetch encrypted archives from a GitHub repository</p>',S,N,M,P,V;return M=Sl(s[17][0]),{c(){e=w("div"),t=w("label"),t.innerHTML=l,r=I(),a=w("div"),n=w("label"),i=w("input"),o=I(),c=w("div"),c.innerHTML=d,h=I(),p=w("label"),v=w("input"),_=I(),g=w("div"),g.innerHTML=k,S=I(),N=w("div"),this.h()},l(L){e=b(L,"DIV",{class:!0});var U=E(e);t=b(U,"LABEL",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-4yw0a2"&&(t.innerHTML=l),r=A(U),a=b(U,"DIV",{class:!0});var C=E(a);n=b(C,"LABEL",{class:!0});var D=E(n);i=b(D,"INPUT",{type:!0,name:!0,class:!0}),o=A(D),c=b(D,"DIV",{class:!0,"data-svelte-h":!0}),Z(c)!=="svelte-1g0nozf"&&(c.innerHTML=d),D.forEach(m),h=A(C),p=b(C,"LABEL",{class:!0});var T=E(p);v=b(T,"INPUT",{type:!0,name:!0,class:!0}),_=A(T),g=b(T,"DIV",{class:!0,"data-svelte-h":!0}),Z(g)!=="svelte-ci4p9t"&&(g.innerHTML=k),T.forEach(m),C.forEach(m),U.forEach(m),S=A(L),N=b(L,"DIV",{class:!0}),E(N).forEach(m),this.h()},h(){u(t,"class","label"),u(i,"type","radio"),u(i,"name","archiveSource"),i.__value="local",ue(i,i.__value),u(i,"class","radio radio-primary mt-1"),u(c,"class","flex-1"),u(n,"class","flex items-start gap-3 cursor-pointer"),u(v,"type","radio"),u(v,"name","archiveSource"),v.__value="github",ue(v,v.__value),u(v,"class","radio radio-primary mt-1"),u(g,"class","flex-1"),u(p,"class","flex items-start gap-3 cursor-pointer"),u(a,"class","space-y-3"),u(e,"class","form-control"),u(N,"class","divider"),M.p(i,v)},m(L,U){H(L,e,U),f(e,t),f(e,r),f(e,a),f(a,n),f(n,i),i.checked=i.__value===s[2].archiveSource,f(n,o),f(n,c),f(a,h),f(a,p),f(p,v),v.checked=v.__value===s[2].archiveSource,f(p,_),f(p,g),H(L,S,U),H(L,N,U),P||(V=[se(i,"change",s[16]),se(v,"change",s[18])],P=!0)},p(L,U){U&4&&(i.checked=i.__value===L[2].archiveSource),U&4&&(v.checked=v.__value===L[2].archiveSource)},d(L){L&&(m(e),m(S),m(N)),M.r(),P=!1,qe(V)}}}function ft(s){let e,t,l="Local Server Configuration",r,a,n,i='<span class="label-text font-semibold">Server URL</span>',o,c,d,h,p='<span class="label-text-alt">URL of your local archive server</span>',v,_,g,k,S,N;function M(U,C){return U[3]?Er:kr}let P=M(s),V=P(s),L=s[5]&&ut(s);return{c(){e=w("div"),t=w("h3"),t.textContent=l,r=I(),a=w("div"),n=w("label"),n.innerHTML=i,o=I(),c=w("input"),d=I(),h=w("label"),h.innerHTML=p,v=I(),_=w("div"),g=w("button"),V.c(),k=I(),L&&L.c(),this.h()},l(U){e=b(U,"DIV",{class:!0});var C=E(e);t=b(C,"H3",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-132aedx"&&(t.textContent=l),r=A(C),a=b(C,"DIV",{class:!0});var D=E(a);n=b(D,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(n)!=="svelte-r9lki"&&(n.innerHTML=i),o=A(D),c=b(D,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),d=A(D),h=b(D,"LABEL",{class:!0,"data-svelte-h":!0}),Z(h)!=="svelte-7hpdir"&&(h.innerHTML=p),D.forEach(m),v=A(C),_=b(C,"DIV",{class:!0});var T=E(_);g=b(T,"BUTTON",{class:!0});var y=E(g);V.l(y),y.forEach(m),T.forEach(m),k=A(C),L&&L.l(C),C.forEach(m),this.h()},h(){u(t,"class","text-lg font-semibold"),u(n,"class","label"),u(n,"for","local-url"),u(c,"id","local-url"),u(c,"type","text"),u(c,"placeholder","http://127.0.0.1:8000"),u(c,"class","input input-bordered w-full"),u(h,"class","label"),u(a,"class","form-control"),u(g,"class","btn btn-outline btn-sm"),g.disabled=s[3],u(_,"class","form-control"),u(e,"class","space-y-4")},m(U,C){H(U,e,C),f(e,t),f(e,r),f(e,a),f(a,n),f(a,o),f(a,c),ue(c,s[2].localServerUrl),f(a,d),f(a,h),f(e,v),f(e,_),f(_,g),V.m(g,null),f(e,k),L&&L.m(e,null),S||(N=[se(c,"input",s[19]),se(g,"click",s[11])],S=!0)},p(U,C){C&4&&c.value!==U[2].localServerUrl&&ue(c,U[2].localServerUrl),P!==(P=M(U))&&(V.d(1),V=P(U),V&&(V.c(),V.m(g,null))),C&8&&(g.disabled=U[3]),U[5]?L?L.p(U,C):(L=ut(U),L.c(),L.m(e,null)):L&&(L.d(1),L=null)},d(U){U&&m(e),V.d(),L&&L.d(),S=!1,qe(N)}}}function kr(s){let e;return{c(){e=j("Test Connection")},l(t){e=B(t,"Test Connection")},m(t,l){H(t,e,l)},d(t){t&&m(e)}}}function Er(s){let e,t;return{c(){e=w("span"),t=j(`
									Testing...`),this.h()},l(l){e=b(l,"SPAN",{class:!0}),E(e).forEach(m),t=B(l,`
									Testing...`),this.h()},h(){u(e,"class","loading loading-spinner loading-sm")},m(l,r){H(l,e,r),H(l,t,r)},d(l){l&&(m(e),m(t))}}}function ut(s){let e,t,l,r=s[5].success?"Success":"Error",a,n,i,o=s[5].message+"",c;return{c(){e=w("div"),t=w("div"),l=w("span"),a=j(r),n=I(),i=w("p"),c=j(o),this.h()},l(d){e=b(d,"DIV",{class:!0});var h=E(e);t=b(h,"DIV",{});var p=E(t);l=b(p,"SPAN",{class:!0});var v=E(l);a=B(v,r),v.forEach(m),n=A(p),i=b(p,"P",{class:!0});var _=E(i);c=B(_,o),_.forEach(m),p.forEach(m),h.forEach(m),this.h()},h(){u(l,"class","font-semibold"),u(i,"class","text-sm"),u(e,"class","alert"),ie(e,"alert-success",s[5].success),ie(e,"alert-error",!s[5].success)},m(d,h){H(d,e,h),f(e,t),f(t,l),f(l,a),f(t,n),f(t,i),f(i,c)},p(d,h){h&32&&r!==(r=d[5].success?"Success":"Error")&&W(a,r),h&32&&o!==(o=d[5].message+"")&&W(c,o),h&32&&ie(e,"alert-success",d[5].success),h&32&&ie(e,"alert-error",!d[5].success)},d(d){d&&m(e)}}}function ht(s){let e,t,l,r,a='<span class="label-text font-semibold">Repository URL</span>',n,i,o,c,d='<span class="label-text-alt">Format: owner/repo (required)</span>',h,p,v,_='<span class="label-text font-semibold">Branch</span>',g,k,S,N,M='<span class="label-text-alt">Branch containing the archives</span>',P,V,L,U='<span class="label-text font-semibold">Personal Access Token (Optional)</span>',C,D,T,y,O=`<span class="label-text-alt">Required for private repositories.
									<a href="https://github.com/settings/tokens/new?scopes=repo&amp;description=Discord%20Archive%20Viewer" target="_blank" rel="noopener noreferrer" class="link link-primary">Create a token</a> with &quot;Contents: Read&quot; permission.</span>`,F,z,X,re,ae,te,J,R=s[8]&&dt();function le(q,x){return q[4]?Dr:Sr}let ee=le(s),Y=ee(s),G=s[6]&&vt(s);return{c(){e=w("div"),R&&R.c(),t=I(),l=w("div"),r=w("label"),r.innerHTML=a,n=I(),i=w("input"),o=I(),c=w("label"),c.innerHTML=d,h=I(),p=w("div"),v=w("label"),v.innerHTML=_,g=I(),k=w("input"),S=I(),N=w("label"),N.innerHTML=M,P=I(),V=w("div"),L=w("label"),L.innerHTML=U,C=I(),D=w("input"),T=I(),y=w("label"),y.innerHTML=O,F=I(),z=w("div"),X=w("button"),Y.c(),ae=I(),G&&G.c(),this.h()},l(q){e=b(q,"DIV",{class:!0});var x=E(e);R&&R.l(x),t=A(x),l=b(x,"DIV",{class:!0});var ce=E(l);r=b(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1n8t60c"&&(r.innerHTML=a),n=A(ce),i=b(ce,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),o=A(ce),c=b(ce,"LABEL",{class:!0,"data-svelte-h":!0}),Z(c)!=="svelte-fl2y61"&&(c.innerHTML=d),ce.forEach(m),h=A(x),p=b(x,"DIV",{class:!0});var fe=E(p);v=b(fe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(v)!=="svelte-r09qt1"&&(v.innerHTML=_),g=A(fe),k=b(fe,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),S=A(fe),N=b(fe,"LABEL",{class:!0,"data-svelte-h":!0}),Z(N)!=="svelte-1n0gekw"&&(N.innerHTML=M),fe.forEach(m),P=A(x),V=b(x,"DIV",{class:!0});var _e=E(V);L=b(_e,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(L)!=="svelte-fcsc6s"&&(L.innerHTML=U),C=A(_e),D=b(_e,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),T=A(_e),y=b(_e,"LABEL",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-yt4t3v"&&(y.innerHTML=O),_e.forEach(m),F=A(x),z=b(x,"DIV",{class:!0});var Ue=E(z);X=b(Ue,"BUTTON",{class:!0});var ge=E(X);Y.l(ge),ge.forEach(m),Ue.forEach(m),ae=A(x),G&&G.l(x),x.forEach(m),this.h()},h(){u(r,"class","label"),u(r,"for","repo-url"),u(i,"id","repo-url"),u(i,"type","text"),u(i,"placeholder","owner/repo (e.g., palaima/discord-archives)"),u(i,"class","input input-bordered w-full"),i.required=!0,u(c,"class","label"),u(l,"class","form-control"),u(v,"class","label"),u(v,"for","branch"),u(k,"id","branch"),u(k,"type","text"),u(k,"placeholder","main"),u(k,"class","input input-bordered w-full"),u(N,"class","label"),u(p,"class","form-control"),u(L,"class","label"),u(L,"for","pat"),u(D,"id","pat"),u(D,"type","password"),u(D,"placeholder","github_pat_xxxxx..."),u(D,"class","input input-bordered w-full font-mono text-sm"),u(y,"class","label"),u(V,"class","form-control"),u(X,"class","btn btn-outline btn-sm"),X.disabled=re=s[4]||!s[2].github.repoUrl,u(z,"class","form-control"),u(e,"class","space-y-4")},m(q,x){H(q,e,x),R&&R.m(e,null),f(e,t),f(e,l),f(l,r),f(l,n),f(l,i),ue(i,s[2].github.repoUrl),f(l,o),f(l,c),f(e,h),f(e,p),f(p,v),f(p,g),f(p,k),ue(k,s[2].github.branch),f(p,S),f(p,N),f(e,P),f(e,V),f(V,L),f(V,C),f(V,D),ue(D,s[2].github.pat),f(V,T),f(V,y),f(e,F),f(e,z),f(z,X),Y.m(X,null),f(e,ae),G&&G.m(e,null),te||(J=[se(i,"input",s[20]),se(k,"input",s[21]),se(D,"input",s[22]),se(X,"click",s[12])],te=!0)},p(q,x){q[8]?R||(R=dt(),R.c(),R.m(e,t)):R&&(R.d(1),R=null),x&4&&i.value!==q[2].github.repoUrl&&ue(i,q[2].github.repoUrl),x&4&&k.value!==q[2].github.branch&&ue(k,q[2].github.branch),x&4&&D.value!==q[2].github.pat&&ue(D,q[2].github.pat),ee!==(ee=le(q))&&(Y.d(1),Y=ee(q),Y&&(Y.c(),Y.m(X,null))),x&20&&re!==(re=q[4]||!q[2].github.repoUrl)&&(X.disabled=re),q[6]?G?G.p(q,x):(G=vt(q),G.c(),G.m(e,null)):G&&(G.d(1),G=null)},d(q){q&&m(e),R&&R.d(),Y.d(),G&&G.d(),te=!1,qe(J)}}}function dt(s){let e,t="GitHub Repository Configuration";return{c(){e=w("h3"),e.textContent=t,this.h()},l(l){e=b(l,"H3",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-53c2ha"&&(e.textContent=t),this.h()},h(){u(e,"class","text-lg font-semibold")},m(l,r){H(l,e,r)},d(l){l&&m(e)}}}function Sr(s){let e;return{c(){e=j("Test Connection")},l(t){e=B(t,"Test Connection")},m(t,l){H(t,e,l)},d(t){t&&m(e)}}}function Dr(s){let e,t;return{c(){e=w("span"),t=j(`
									Testing...`),this.h()},l(l){e=b(l,"SPAN",{class:!0}),E(e).forEach(m),t=B(l,`
									Testing...`),this.h()},h(){u(e,"class","loading loading-spinner loading-sm")},m(l,r){H(l,e,r),H(l,t,r)},d(l){l&&(m(e),m(t))}}}function vt(s){let e,t,l,r=s[6].success?"Success":"Error",a,n,i,o=s[6].message+"",c;return{c(){e=w("div"),t=w("div"),l=w("span"),a=j(r),n=I(),i=w("p"),c=j(o),this.h()},l(d){e=b(d,"DIV",{class:!0});var h=E(e);t=b(h,"DIV",{});var p=E(t);l=b(p,"SPAN",{class:!0});var v=E(l);a=B(v,r),v.forEach(m),n=A(p),i=b(p,"P",{class:!0});var _=E(i);c=B(_,o),_.forEach(m),p.forEach(m),h.forEach(m),this.h()},h(){u(l,"class","font-semibold"),u(i,"class","text-sm"),u(e,"class","alert"),ie(e,"alert-success",s[6].success),ie(e,"alert-error",!s[6].success)},m(d,h){H(d,e,h),f(e,t),f(t,l),f(l,a),f(t,n),f(t,i),f(i,c)},p(d,h){h&64&&r!==(r=d[6].success?"Success":"Error")&&W(a,r),h&64&&o!==(o=d[6].message+"")&&W(c,o),h&64&&ie(e,"alert-success",d[6].success),h&64&&ie(e,"alert-error",!d[6].success)},d(d){d&&m(e)}}}function mt(s){let e,t="Cancel",l,r;return{c(){e=w("button"),e.textContent=t,this.h()},l(a){e=b(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-121k3bn"&&(e.textContent=t),this.h()},h(){u(e,"class","btn btn-ghost")},m(a,n){H(a,e,n),l||(r=se(e,"click",s[10]),l=!0)},p:$,d(a){a&&m(e),l=!1,r()}}}function Cr(s){let e,t=s[1]&&ot(s);return{c(){t&&t.c(),e=Ee()},l(l){t&&t.l(l),e=Ee()},m(l,r){t&&t.m(l,r),H(l,e,r)},p(l,[r]){l[1]?t?t.p(l,r):(t=ot(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&m(e),t&&t.d(l)}}}function yr(s,e,t){let l,r,a;Be(s,Ne,F=>t(23,a=F));const n=Ke();let{required:i=!1}=e,o=!1,c=a,d=!1,h=!1,p=null,v=null;function _(){t(1,o=!0),t(2,c={...a,github:{...a.github}}),t(5,p=null),t(6,v=null)}function g(){t(1,o=!1),n("close")}function k(){Ne.set(c),g()}function S(){i||(t(2,c={...a,github:{...a.github}}),g())}async function N(){t(3,d=!0),t(5,p=null);try{await new Ze(c.localServerUrl).testConnection()?t(5,p={success:!0,message:"Connected! Local server is reachable."}):t(5,p={success:!1,message:"Connection failed. Is the server running?"})}catch(F){t(5,p={success:!1,message:F instanceof Error?F.message:"Unknown error occurred"})}finally{t(3,d=!1)}}async function M(){if(!c.github.repoUrl){t(6,v={success:!1,message:"Please enter a repository URL"});return}t(4,h=!0),t(6,v=null);try{await new lt(c.github).testConnection()?t(6,v={success:!0,message:"Connection successful! Metadata file found."}):t(6,v={success:!1,message:"Connection failed. Check repository URL and permissions."})}catch(F){t(6,v={success:!1,message:F instanceof Error?F.message:"Unknown error occurred"})}finally{t(4,h=!1)}}function P(F){F.key==="Escape"&&!i&&S()}const V=[[]];function L(F){El.call(this,s,F)}function U(){c.archiveSource=this.__value,t(2,c),t(1,o)}function C(){c.archiveSource=this.__value,t(2,c),t(1,o)}function D(){c.localServerUrl=this.value,t(2,c),t(1,o)}function T(){c.github.repoUrl=this.value,t(2,c),t(1,o)}function y(){c.github.branch=this.value,t(2,c),t(1,o)}function O(){c.github.pat=this.value,t(2,c),t(1,o)}return s.$$set=F=>{"required"in F&&t(0,i=F.required)},s.$$.update=()=>{s.$$.dirty&6&&o&&!c.github.repoUrl&&Fe.github.repoUrl&&t(2,c={...c,github:{...c.github,repoUrl:Fe.github.repoUrl,branch:Fe.github.branch,pat:Fe.github.pat}}),s.$$.dirty&4&&t(7,r=c.archiveSource==="local"?!0:!!c.github.repoUrl)},t(8,l=["localhost","127.0.0.1","0.0.0.0"].includes(window.location.hostname)),[i,o,c,d,h,p,v,r,l,k,S,N,M,P,_,L,U,V,C,D,T,y,O]}class Tr extends me{constructor(e){super(),pe(this,e,yr,Cr,ve,{required:0,open:14})}get open(){return this.$$.ctx[14]}}function Ar(s){let e,t,l,r,a="Discord Archives",n,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',c,d,h,p,v=s[0].totalArchives+"",_,g,k,S,N,M=s[0].uniqueServers+"",P,V,L,U,C,D=s[0].uniqueChannels+"",T,y,O,F,z,X,re;const ae=s[3].default,te=Cl(ae,s,s[2],null);return{c(){e=w("div"),t=w("div"),l=w("div"),r=w("h1"),r.textContent=a,n=I(),i=w("button"),i.innerHTML=o,c=I(),d=w("div"),h=w("div"),p=j("ðŸ“ "),_=j(v),g=j(" archives"),k=I(),S=w("div"),N=j("ðŸ–¥ï¸ "),P=j(M),V=j(" servers"),L=I(),U=w("div"),C=j("ðŸ’¬ "),T=j(D),y=j(" channels"),O=I(),F=w("div"),te&&te.c(),this.h()},l(J){e=b(J,"DIV",{class:!0});var R=E(e);t=b(R,"DIV",{class:!0});var le=E(t);l=b(le,"DIV",{class:!0});var ee=E(l);r=b(ee,"H1",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-176jj07"&&(r.textContent=a),n=A(ee),i=b(ee,"BUTTON",{class:!0,title:!0,"aria-label":!0,"data-svelte-h":!0}),Z(i)!=="svelte-9lg1f1"&&(i.innerHTML=o),ee.forEach(m),c=A(le),d=b(le,"DIV",{class:!0});var Y=E(d);h=b(Y,"DIV",{});var G=E(h);p=B(G,"ðŸ“ "),_=B(G,v),g=B(G," archives"),G.forEach(m),k=A(Y),S=b(Y,"DIV",{});var q=E(S);N=B(q,"ðŸ–¥ï¸ "),P=B(q,M),V=B(q," servers"),q.forEach(m),L=A(Y),U=b(Y,"DIV",{});var x=E(U);C=B(x,"ðŸ’¬ "),T=B(x,D),y=B(x," channels"),x.forEach(m),Y.forEach(m),le.forEach(m),O=A(R),F=b(R,"DIV",{class:!0});var ce=E(F);te&&te.l(ce),ce.forEach(m),R.forEach(m),this.h()},h(){u(r,"class","text-xl font-semibold"),u(i,"class","btn btn-ghost btn-sm btn-square"),u(i,"title","Settings"),u(i,"aria-label","Open settings"),u(l,"class","flex items-center justify-between mb-3"),u(d,"class","text-sm space-y-1 text-base-content/70"),u(t,"class","p-5 bg-base-300 border-b border-base-100"),u(F,"class","flex-1 overflow-y-auto p-3"),u(e,"class","w-80 bg-base-200 border-r border-base-300 flex flex-col h-screen")},m(J,R){H(J,e,R),f(e,t),f(t,l),f(l,r),f(l,n),f(l,i),f(t,c),f(t,d),f(d,h),f(h,p),f(h,_),f(h,g),f(d,k),f(d,S),f(S,N),f(S,P),f(S,V),f(d,L),f(d,U),f(U,C),f(U,T),f(U,y),f(e,O),f(e,F),te&&te.m(F,null),z=!0,X||(re=se(i,"click",s[1]),X=!0)},p(J,[R]){(!z||R&1)&&v!==(v=J[0].totalArchives+"")&&W(_,v),(!z||R&1)&&M!==(M=J[0].uniqueServers+"")&&W(P,M),(!z||R&1)&&D!==(D=J[0].uniqueChannels+"")&&W(T,D),te&&te.p&&(!z||R&4)&&yl(te,ae,J,J[2],z?Al(ae,J[2],R,null):Tl(J[2]),null)},i(J){z||(K(te,J),z=!0)},o(J){Q(te,J),z=!1},d(J){J&&m(e),te&&te.d(J),X=!1,re()}}}function Ir(s,e,t){let l;Be(s,Fl,o=>t(0,l=o));let{$$slots:r={},$$scope:a}=e;const n=Ke();function i(){n("openSettings")}return s.$$set=o=>{"$$scope"in o&&t(2,a=o.$$scope)},[l,i,a,r]}class Ur extends me{constructor(e){super(),pe(this,e,Ir,Ar,ve,{})}}function pt(s,e,t){const l=s.slice();return l[6]=e[t],l}function _t(s){let e,t=oe(s[1].channels),l=[];for(let r=0;r<t.length;r+=1)l[r]=gt(pt(s,t,r));return{c(){e=w("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(m),this.h()},h(){u(e,"class","pl-3 mt-2 space-y-1")},m(r,a){H(r,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(r,a){if(a&10){t=oe(r[1].channels);let n;for(n=0;n<t.length;n+=1){const i=pt(r,t,n);l[n]?l[n].p(i,a):(l[n]=gt(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(r){r&&m(e),Ie(l,r)}}}function gt(s){let e,t,l="#",r,a,n=(s[6].channel_name||s[6].channel_id)+"",i,o,c,d=new Date(s[6].exported_at).toLocaleDateString()+"",h,p,v,_;function g(){return s[4](s[6])}return{c(){e=w("button"),t=w("span"),t.textContent=l,r=I(),a=w("span"),i=j(n),o=I(),c=w("span"),h=j(d),p=I(),this.h()},l(k){e=b(k,"BUTTON",{class:!0});var S=E(e);t=b(S,"SPAN",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-ulfyf0"&&(t.textContent=l),r=A(S),a=b(S,"SPAN",{class:!0});var N=E(a);i=B(N,n),N.forEach(m),o=A(S),c=b(S,"SPAN",{class:!0});var M=E(c);h=B(M,d),M.forEach(m),p=A(S),S.forEach(m),this.h()},h(){u(t,"class","text-base-content/50 group-hover:text-base-content"),u(a,"class","flex-1"),u(c,"class","text-xs text-base-content/40"),u(e,"class","w-full px-3 py-2 rounded hover:bg-base-100 transition-colors flex items-center gap-2 text-sm text-left group")},m(k,S){H(k,e,S),f(e,t),f(e,r),f(e,a),f(a,i),f(e,o),f(e,c),f(c,h),f(e,p),v||(_=se(e,"click",g),v=!0)},p(k,S){s=k,S&2&&n!==(n=(s[6].channel_name||s[6].channel_id)+"")&&W(i,n),S&2&&d!==(d=new Date(s[6].exported_at).toLocaleDateString()+"")&&W(h,d)},d(k){k&&m(e),v=!1,_()}}}function Lr(s){let e,t,l,r="â–¼",a,n,i=s[1].name+"",o,c,d,h,p=!s[0]&&_t(s);return{c(){e=w("div"),t=w("button"),l=w("span"),l.textContent=r,a=I(),n=w("span"),o=j(i),c=I(),p&&p.c(),this.h()},l(v){e=b(v,"DIV",{class:!0});var _=E(e);t=b(_,"BUTTON",{class:!0});var g=E(t);l=b(g,"SPAN",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-1nry6l9"&&(l.textContent=r),a=A(g),n=b(g,"SPAN",{});var k=E(n);o=B(k,i),k.forEach(m),g.forEach(m),c=A(_),p&&p.l(_),_.forEach(m),this.h()},h(){u(l,"class","transform transition-transform text-xs"),ie(l,"rotate-0",!s[0]),ie(l,"-rotate-90",s[0]),u(t,"class","w-full px-3 py-2 bg-base-300 rounded hover:bg-base-100 transition-colors flex items-center gap-2 font-semibold text-sm"),u(e,"class","mb-4")},m(v,_){H(v,e,_),f(e,t),f(t,l),f(t,a),f(t,n),f(n,o),f(e,c),p&&p.m(e,null),d||(h=se(t,"click",s[2]),d=!0)},p(v,[_]){_&1&&ie(l,"rotate-0",!v[0]),_&1&&ie(l,"-rotate-90",v[0]),_&2&&i!==(i=v[1].name+"")&&W(o,i),v[0]?p&&(p.d(1),p=null):p?p.p(v,_):(p=_t(v),p.c(),p.m(e,null))},i:$,o:$,d(v){v&&m(e),p&&p.d(),d=!1,h()}}}function Vr(s,e,t){let{server:l}=e,{collapsed:r=!1}=e;const a=Ke();function n(){t(0,r=!r)}function i(c){a("selectChannel",c)}const o=c=>i(c);return s.$$set=c=>{"server"in c&&t(1,l=c.server),"collapsed"in c&&t(0,r=c.collapsed)},[r,l,n,i,o]}class Mr extends me{constructor(e){super(),pe(this,e,Vr,Lr,ve,{server:1,collapsed:0})}}function Nr(s){let e,t,l="ðŸ“Ž",r,a,n,i=s[0].fileName+"",o,c,d,h,p,v,_='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>',g;return{c(){e=w("a"),t=w("div"),t.textContent=l,r=I(),a=w("div"),n=w("div"),o=j(i),c=I(),d=w("div"),h=j(s[1]),p=I(),v=w("div"),v.innerHTML=_,this.h()},l(k){e=b(k,"A",{href:!0,target:!0,rel:!0,class:!0});var S=E(e);t=b(S,"DIV",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-dlenr"&&(t.textContent=l),r=A(S),a=b(S,"DIV",{class:!0});var N=E(a);n=b(N,"DIV",{class:!0});var M=E(n);o=B(M,i),M.forEach(m),c=A(N),d=b(N,"DIV",{class:!0});var P=E(d);h=B(P,s[1]),P.forEach(m),N.forEach(m),p=A(S),v=b(S,"DIV",{class:!0,"data-svelte-h":!0}),Z(v)!=="svelte-1qs47xs"&&(v.innerHTML=_),S.forEach(m),this.h()},h(){u(t,"class","text-3xl"),u(n,"class","font-medium truncate"),u(d,"class","text-xs text-base-content/60"),u(a,"class","flex-1 min-w-0"),u(v,"class","text-primary"),u(e,"href",g=s[0].url),u(e,"target","_blank"),u(e,"rel","noopener noreferrer"),u(e,"class","flex items-center gap-3 p-3 bg-base-300 rounded hover:bg-base-200 transition max-w-md")},m(k,S){H(k,e,S),f(e,t),f(e,r),f(e,a),f(a,n),f(n,o),f(a,c),f(a,d),f(d,h),f(e,p),f(e,v)},p(k,S){S&1&&i!==(i=k[0].fileName+"")&&W(o,i),S&2&&W(h,k[1]),S&1&&g!==(g=k[0].url)&&u(e,"href",g)},d(k){k&&m(e)}}}function Pr(s){let e,t,l,r,a;return{c(){e=w("a"),t=w("img"),this.h()},l(n){e=b(n,"A",{href:!0,target:!0,rel:!0});var i=E(e);t=b(i,"IMG",{src:!0,alt:!0,class:!0,loading:!0}),i.forEach(m),this.h()},h(){he(t.src,l=s[0].url)||u(t,"src",l),u(t,"alt",r=s[0].fileName),u(t,"class","max-w-md max-h-96 rounded hover:opacity-90 transition cursor-pointer"),u(t,"loading","lazy"),u(e,"href",a=s[0].url),u(e,"target","_blank"),u(e,"rel","noopener noreferrer")},m(n,i){H(n,e,i),f(e,t)},p(n,i){i&1&&!he(t.src,l=n[0].url)&&u(t,"src",l),i&1&&r!==(r=n[0].fileName)&&u(t,"alt",r),i&1&&a!==(a=n[0].url)&&u(e,"href",a)},d(n){n&&m(e)}}}function Hr(s){let e;function t(a,n){return a[2]?Pr:Nr}let l=t(s),r=l(s);return{c(){e=w("div"),r.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var n=E(e);r.l(n),n.forEach(m),this.h()},h(){u(e,"class","mt-2")},m(a,n){H(a,e,n),r.m(e,null)},p(a,[n]){l===(l=t(a))&&r?r.p(a,n):(r.d(1),r=l(a),r&&(r.c(),r.m(e,null)))},i:$,o:$,d(a){a&&m(e),r.d()}}}function Br(s){return s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/(1024*1024)).toFixed(1)} MB`}function jr(s,e,t){let l,r,{attachment:a}=e;return s.$$set=n=>{"attachment"in n&&t(0,a=n.attachment)},s.$$.update=()=>{s.$$.dirty&1&&t(2,l=/\.(jpg|jpeg|png|gif|webp)$/i.test(a.fileName)),s.$$.dirty&1&&t(1,r=Br(a.fileSizeBytes))},[a,r,l]}class Fr extends me{constructor(e){super(),pe(this,e,jr,Hr,ve,{attachment:0})}}function bt(s,e,t){const l=s.slice();return l[2]=e[t],l}function wt(s,e,t){const l=s.slice();return l[5]=e[t],l}function kt(s){let e,t,l,r,a,n,i=s[0].title&&Et(s),o=s[0].description&&St(s),c=s[0].fields&&s[0].fields.length>0&&Dt(s),d=s[0].thumbnail&&yt(s),h=s[0].video&&Tt(s),p=s[0].images&&s[0].images.length>0&&At(s);return{c(){e=w("div"),i&&i.c(),t=I(),o&&o.c(),l=I(),c&&c.c(),r=I(),d&&d.c(),a=I(),h&&h.c(),n=I(),p&&p.c(),this.h()},l(v){e=b(v,"DIV",{class:!0});var _=E(e);i&&i.l(_),t=A(_),o&&o.l(_),l=A(_),c&&c.l(_),r=A(_),d&&d.l(_),a=A(_),h&&h.l(_),n=A(_),p&&p.l(_),_.forEach(m),this.h()},h(){u(e,"class","mt-2 border-l-4 border-primary pl-3 py-2 bg-base-200/50 rounded max-w-lg")},m(v,_){H(v,e,_),i&&i.m(e,null),f(e,t),o&&o.m(e,null),f(e,l),c&&c.m(e,null),f(e,r),d&&d.m(e,null),f(e,a),h&&h.m(e,null),f(e,n),p&&p.m(e,null)},p(v,_){v[0].title?i?i.p(v,_):(i=Et(v),i.c(),i.m(e,t)):i&&(i.d(1),i=null),v[0].description?o?o.p(v,_):(o=St(v),o.c(),o.m(e,l)):o&&(o.d(1),o=null),v[0].fields&&v[0].fields.length>0?c?c.p(v,_):(c=Dt(v),c.c(),c.m(e,r)):c&&(c.d(1),c=null),v[0].thumbnail?d?d.p(v,_):(d=yt(v),d.c(),d.m(e,a)):d&&(d.d(1),d=null),v[0].video?h?h.p(v,_):(h=Tt(v),h.c(),h.m(e,n)):h&&(h.d(1),h=null),v[0].images&&v[0].images.length>0?p?p.p(v,_):(p=At(v),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},d(v){v&&m(e),i&&i.d(),o&&o.d(),c&&c.d(),d&&d.d(),h&&h.d(),p&&p.d()}}}function Et(s){let e;function t(a,n){return a[0].url?qr:Or}let l=t(s),r=l(s);return{c(){e=w("div"),r.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var n=E(e);r.l(n),n.forEach(m),this.h()},h(){u(e,"class","font-semibold mb-1")},m(a,n){H(a,e,n),r.m(e,null)},p(a,n){l===(l=t(a))&&r?r.p(a,n):(r.d(1),r=l(a),r&&(r.c(),r.m(e,null)))},d(a){a&&m(e),r.d()}}}function Or(s){let e=s[0].title+"",t;return{c(){t=j(e)},l(l){t=B(l,e)},m(l,r){H(l,t,r)},p(l,r){r&1&&e!==(e=l[0].title+"")&&W(t,e)},d(l){l&&m(t)}}}function qr(s){let e,t=s[0].title+"",l,r;return{c(){e=w("a"),l=j(t),this.h()},l(a){e=b(a,"A",{href:!0,target:!0,rel:!0,class:!0});var n=E(e);l=B(n,t),n.forEach(m),this.h()},h(){u(e,"href",r=s[0].url),u(e,"target","_blank"),u(e,"rel","noopener noreferrer"),u(e,"class","text-primary hover:underline")},m(a,n){H(a,e,n),f(e,l)},p(a,n){n&1&&t!==(t=a[0].title+"")&&W(l,t),n&1&&r!==(r=a[0].url)&&u(e,"href",r)},d(a){a&&m(e)}}}function St(s){let e,t=s[0].description+"",l;return{c(){e=w("div"),l=j(t),this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);l=B(a,t),a.forEach(m),this.h()},h(){u(e,"class","text-sm text-base-content/80 mb-2 whitespace-pre-wrap")},m(r,a){H(r,e,a),f(e,l)},p(r,a){a&1&&t!==(t=r[0].description+"")&&W(l,t)},d(r){r&&m(e)}}}function Dt(s){let e,t=oe(s[0].fields),l=[];for(let r=0;r<t.length;r+=1)l[r]=Ct(wt(s,t,r));return{c(){e=w("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(m),this.h()},h(){u(e,"class","grid gap-2 mt-2")},m(r,a){H(r,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(r,a){if(a&1){t=oe(r[0].fields);let n;for(n=0;n<t.length;n+=1){const i=wt(r,t,n);l[n]?l[n].p(i,a):(l[n]=Ct(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(r){r&&m(e),Ie(l,r)}}}function Ct(s){let e,t,l=s[5].name+"",r,a,n,i=s[5].value+"",o,c;return{c(){e=w("div"),t=w("div"),r=j(l),a=I(),n=w("div"),o=j(i),c=I(),this.h()},l(d){e=b(d,"DIV",{});var h=E(e);t=b(h,"DIV",{class:!0});var p=E(t);r=B(p,l),p.forEach(m),a=A(h),n=b(h,"DIV",{class:!0});var v=E(n);o=B(v,i),v.forEach(m),c=A(h),h.forEach(m),this.h()},h(){u(t,"class","font-semibold text-sm"),u(n,"class","text-sm text-base-content/80")},m(d,h){H(d,e,h),f(e,t),f(t,r),f(e,a),f(e,n),f(n,o),f(e,c)},p(d,h){h&1&&l!==(l=d[5].name+"")&&W(r,l),h&1&&i!==(i=d[5].value+"")&&W(o,i)},d(d){d&&m(e)}}}function yt(s){let e,t,l;return{c(){e=w("div"),t=w("img"),this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);t=b(a,"IMG",{src:!0,alt:!0,class:!0,loading:!0,style:!0}),a.forEach(m),this.h()},h(){he(t.src,l=s[0].thumbnail.url)||u(t,"src",l),u(t,"alt","Thumbnail"),u(t,"class","rounded max-w-xs"),u(t,"loading","lazy"),be(t,"max-width",s[0].thumbnail.width+"px"),be(t,"max-height",s[0].thumbnail.height+"px"),u(e,"class","mt-2")},m(r,a){H(r,e,a),f(e,t)},p(r,a){a&1&&!he(t.src,l=r[0].thumbnail.url)&&u(t,"src",l),a&1&&be(t,"max-width",r[0].thumbnail.width+"px"),a&1&&be(t,"max-height",r[0].thumbnail.height+"px")},d(r){r&&m(e)}}}function Tt(s){let e,t,l,r,a,n;return{c(){e=w("div"),t=w("video"),l=w("source"),a=w("track"),n=j(`
					Your browser does not support the video tag.`),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=E(e);t=b(o,"VIDEO",{class:!0,style:!0});var c=E(t);l=b(c,"SOURCE",{src:!0}),a=b(c,"TRACK",{kind:!0}),n=B(c,`
					Your browser does not support the video tag.`),c.forEach(m),o.forEach(m),this.h()},h(){he(l.src,r=s[0].video.url)||u(l,"src",r),u(a,"kind","captions"),t.controls=!0,u(t,"class","rounded max-w-md"),be(t,"max-width",s[0].video.width+"px"),be(t,"max-height",s[0].video.height+"px"),u(e,"class","mt-2")},m(i,o){H(i,e,o),f(e,t),f(t,l),f(t,a),f(t,n)},p(i,o){o&1&&!he(l.src,r=i[0].video.url)&&u(l,"src",r),o&1&&be(t,"max-width",i[0].video.width+"px"),o&1&&be(t,"max-height",i[0].video.height+"px")},d(i){i&&m(e)}}}function At(s){let e,t=oe(s[0].images),l=[];for(let r=0;r<t.length;r+=1)l[r]=It(bt(s,t,r));return{c(){e=w("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(m),this.h()},h(){u(e,"class","flex flex-wrap gap-2 mt-2")},m(r,a){H(r,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(r,a){if(a&1){t=oe(r[0].images);let n;for(n=0;n<t.length;n+=1){const i=bt(r,t,n);l[n]?l[n].p(i,a):(l[n]=It(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(r){r&&m(e),Ie(l,r)}}}function It(s){let e,t;return{c(){e=w("img"),this.h()},l(l){e=b(l,"IMG",{src:!0,alt:!0,class:!0,loading:!0,style:!0}),this.h()},h(){he(e.src,t=s[2].url)||u(e,"src",t),u(e,"alt","Embed"),u(e,"class","rounded"),u(e,"loading","lazy"),be(e,"max-width",s[2].width+"px"),be(e,"max-height",s[2].height+"px")},m(l,r){H(l,e,r)},p(l,r){r&1&&!he(e.src,t=l[2].url)&&u(e,"src",t),r&1&&be(e,"max-width",l[2].width+"px"),r&1&&be(e,"max-height",l[2].height+"px")},d(l){l&&m(e)}}}function Rr(s){let e,t=s[1]&&kt(s);return{c(){t&&t.c(),e=Ee()},l(l){t&&t.l(l),e=Ee()},m(l,r){t&&t.m(l,r),H(l,e,r)},p(l,[r]){l[1]?t?t.p(l,r):(t=kt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&m(e),t&&t.d(l)}}}function zr(s,e,t){let l,{embed:r}=e;return s.$$set=a=>{"embed"in a&&t(0,r=a.embed)},s.$$.update=()=>{s.$$.dirty&1&&t(1,l=r.title||r.description||r.thumbnail||r.video)},[r,l]}class Gr extends me{constructor(e){super(),pe(this,e,zr,Rr,ve,{embed:0})}}function Ut(s,e,t){const l=s.slice();return l[3]=e[t],l}function Lt(s){let e,t,l,r=s[0].emoji.name+"",a,n,i=oe(s[0].users),o=[];for(let c=0;c<i.length;c+=1)o[c]=Vt(Ut(s,i,c));return{c(){e=w("div"),t=w("div"),l=j("Reacted with "),a=j(r),n=I();for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){e=b(c,"DIV",{class:!0});var d=E(e);t=b(d,"DIV",{class:!0});var h=E(t);l=B(h,"Reacted with "),a=B(h,r),h.forEach(m),n=A(d);for(let p=0;p<o.length;p+=1)o[p].l(d);d.forEach(m),this.h()},h(){u(t,"class","text-xs font-semibold mb-1"),u(e,"class","absolute bottom-full left-0 mb-2 bg-base-300 rounded p-2 shadow-lg z-10 whitespace-nowrap")},m(c,d){H(c,e,d),f(e,t),f(t,l),f(t,a),f(e,n);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(e,null)},p(c,d){if(d&1&&r!==(r=c[0].emoji.name+"")&&W(a,r),d&1){i=oe(c[0].users);let h;for(h=0;h<i.length;h+=1){const p=Ut(c,i,h);o[h]?o[h].p(p,d):(o[h]=Vt(p),o[h].c(),o[h].m(e,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=i.length}},d(c){c&&m(e),Ie(o,c)}}}function Vt(s){let e,t=(s[3].nickname||s[3].name)+"",l,r;return{c(){e=w("div"),l=j(t),r=I(),this.h()},l(a){e=b(a,"DIV",{class:!0});var n=E(e);l=B(n,t),r=A(n),n.forEach(m),this.h()},h(){u(e,"class","text-xs py-0.5")},m(a,n){H(a,e,n),f(e,l),f(e,r)},p(a,n){n&1&&t!==(t=(a[3].nickname||a[3].name)+"")&&W(l,t)},d(a){a&&m(e)}}}function Kr(s){let e,t,l,r=s[0].emoji.name+"",a,n,i,o=s[0].count+"",c,d,h,p,v,_=s[1]&&s[0].users.length>0&&Lt(s);return{c(){e=w("div"),t=w("button"),l=w("span"),a=j(r),n=I(),i=w("span"),c=j(o),h=I(),_&&_.c(),this.h()},l(g){e=b(g,"DIV",{class:!0});var k=E(e);t=b(k,"BUTTON",{class:!0,title:!0});var S=E(t);l=b(S,"SPAN",{class:!0});var N=E(l);a=B(N,r),N.forEach(m),n=A(S),i=b(S,"SPAN",{class:!0});var M=E(i);c=B(M,o),M.forEach(m),S.forEach(m),h=A(k),_&&_.l(k),k.forEach(m),this.h()},h(){u(l,"class","text-base"),u(i,"class","text-xs opacity-70"),u(t,"class","badge badge-ghost gap-1 cursor-pointer hover:bg-base-300 transition"),u(t,"title",d=s[0].users.map(Mt).join(", ")),u(e,"class","relative inline-block")},m(g,k){H(g,e,k),f(e,t),f(t,l),f(l,a),f(t,n),f(t,i),f(i,c),f(e,h),_&&_.m(e,null),p||(v=se(t,"click",s[2]),p=!0)},p(g,[k]){k&1&&r!==(r=g[0].emoji.name+"")&&W(a,r),k&1&&o!==(o=g[0].count+"")&&W(c,o),k&1&&d!==(d=g[0].users.map(Mt).join(", "))&&u(t,"title",d),g[1]&&g[0].users.length>0?_?_.p(g,k):(_=Lt(g),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},i:$,o:$,d(g){g&&m(e),_&&_.d(),p=!1,v()}}}const Mt=s=>s.nickname||s.name;function Wr(s,e,t){let{reaction:l}=e,r=!1;function a(){t(1,r=!r)}return s.$$set=n=>{"reaction"in n&&t(0,l=n.reaction)},[l,r,a]}class Jr extends me{constructor(e){super(),pe(this,e,Wr,Kr,ve,{reaction:0})}}function Nt(s,e,t){const l=s.slice();return l[8]=e[t],l}function Pt(s,e,t){const l=s.slice();return l[11]=e[t],l}function Ht(s,e,t){const l=s.slice();return l[14]=e[t],l}function Bt(s,e,t){const l=s.slice();return l[17]=e[t],l}function Yr(s){let e,t=new Date(s[0].timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})+"",l;return{c(){e=w("span"),l=j(t),this.h()},l(r){e=b(r,"SPAN",{class:!0});var a=E(e);l=B(a,t),a.forEach(m),this.h()},h(){u(e,"class","text-xs text-base-content/30 opacity-0 group-hover:opacity-100 transition text-right block pr-1")},m(r,a){H(r,e,a),f(e,l)},p(r,a){a&1&&t!==(t=new Date(r[0].timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})+"")&&W(l,t)},d(r){r&&m(e)}}}function Zr(s){let e,t;return{c(){e=w("img"),this.h()},l(l){e=b(l,"IMG",{src:!0,alt:!0,class:!0,loading:!0}),this.h()},h(){he(e.src,t=s[0].author.avatarUrl)||u(e,"src",t),u(e,"alt",s[3]),u(e,"class","w-10 h-10 rounded-full"),u(e,"loading","lazy")},m(l,r){H(l,e,r)},p(l,r){r&1&&!he(e.src,t=l[0].author.avatarUrl)&&u(e,"src",t),r&8&&u(e,"alt",l[3])},d(l){l&&m(e)}}}function jt(s){let e,t,l,r,a,n,i,o,c,d,h=s[2]&&Ft(),p=s[0].timestampEdited&&Ot(s),v=s[0].isPinned&&qt();return{c(){e=w("div"),t=w("span"),l=j(s[3]),a=I(),h&&h.c(),n=I(),i=w("span"),o=j(s[6]),c=I(),p&&p.c(),d=I(),v&&v.c(),this.h()},l(_){e=b(_,"DIV",{class:!0});var g=E(e);t=b(g,"SPAN",{class:!0,style:!0});var k=E(t);l=B(k,s[3]),k.forEach(m),a=A(g),h&&h.l(g),n=A(g),i=b(g,"SPAN",{class:!0,title:!0});var S=E(i);o=B(S,s[6]),S.forEach(m),c=A(g),p&&p.l(g),d=A(g),v&&v.l(g),g.forEach(m),this.h()},h(){u(t,"class","font-semibold text-base"),u(t,"style",r=s[0].author.color?`color: ${s[0].author.color}`:""),u(i,"class","text-xs text-base-content/50"),u(i,"title",s[5]),u(e,"class","flex items-baseline gap-2 mb-0.5")},m(_,g){H(_,e,g),f(e,t),f(t,l),f(e,a),h&&h.m(e,null),f(e,n),f(e,i),f(i,o),f(e,c),p&&p.m(e,null),f(e,d),v&&v.m(e,null)},p(_,g){g&8&&W(l,_[3]),g&1&&r!==(r=_[0].author.color?`color: ${_[0].author.color}`:"")&&u(t,"style",r),_[2]?h||(h=Ft(),h.c(),h.m(e,n)):h&&(h.d(1),h=null),g&64&&W(o,_[6]),g&32&&u(i,"title",_[5]),_[0].timestampEdited?p?p.p(_,g):(p=Ot(_),p.c(),p.m(e,d)):p&&(p.d(1),p=null),_[0].isPinned?v||(v=qt(),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},d(_){_&&m(e),h&&h.d(),p&&p.d(),v&&v.d()}}}function Ft(s){let e,t="BOT";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-7rau7y"&&(e.textContent=t),this.h()},h(){u(e,"class","badge badge-primary badge-xs")},m(l,r){H(l,e,r)},d(l){l&&m(e)}}}function Ot(s){let e,t,l;return{c(){e=w("span"),t=j("(edited)"),this.h()},l(r){e=b(r,"SPAN",{class:!0,title:!0});var a=E(e);t=B(a,"(edited)"),a.forEach(m),this.h()},h(){u(e,"class","text-xs text-base-content/40"),u(e,"title",l=new Date(s[0].timestampEdited).toLocaleString())},m(r,a){H(r,e,a),f(e,t)},p(r,a){a&1&&l!==(l=new Date(r[0].timestampEdited).toLocaleString())&&u(e,"title",l)},d(r){r&&m(e)}}}function qt(s){let e,t="ðŸ“Œ";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),Z(e)!=="svelte-hpo2nn"&&(e.textContent=t),this.h()},h(){u(e,"class","text-xs"),u(e,"title","Pinned message")},m(l,r){H(l,e,r)},d(l){l&&m(e)}}}function Rt(s){let e,t='<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M10 8.5L14 12l-4 3.5v-7zm8 6V8l-8-6v6H4v8h6v6l8-6z"></path></svg> <span>Replying to a message</span>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1frdbuq"&&(e.innerHTML=t),this.h()},h(){u(e,"class","text-xs text-base-content/60 mb-1 flex items-center gap-1")},m(l,r){H(l,e,r)},d(l){l&&m(e)}}}function zt(s){let e,t=s[0].content+"",l;return{c(){e=w("div"),l=j(t),this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);l=B(a,t),a.forEach(m),this.h()},h(){u(e,"class","text-base-content break-words whitespace-pre-wrap")},m(r,a){H(r,e,a),f(e,l)},p(r,a){a&1&&t!==(t=r[0].content+"")&&W(l,t)},d(r){r&&m(e)}}}function Gt(s){let e,t,l=oe(s[0].attachments),r=[];for(let n=0;n<l.length;n+=1)r[n]=Kt(Bt(s,l,n));const a=n=>Q(r[n],1,1,()=>{r[n]=null});return{c(){for(let n=0;n<r.length;n+=1)r[n].c();e=Ee()},l(n){for(let i=0;i<r.length;i+=1)r[i].l(n);e=Ee()},m(n,i){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(n,i);H(n,e,i),t=!0},p(n,i){if(i&1){l=oe(n[0].attachments);let o;for(o=0;o<l.length;o+=1){const c=Bt(n,l,o);r[o]?(r[o].p(c,i),K(r[o],1)):(r[o]=Kt(c),r[o].c(),K(r[o],1),r[o].m(e.parentNode,e))}for(we(),o=l.length;o<r.length;o+=1)a(o);ke()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)K(r[i]);t=!0}},o(n){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)Q(r[i]);t=!1},d(n){n&&m(e),Ie(r,n)}}}function Kt(s){let e,t;return e=new Fr({props:{attachment:s[17]}}),{c(){ye(e.$$.fragment)},l(l){Ce(e.$$.fragment,l)},m(l,r){De(e,l,r),t=!0},p(l,r){const a={};r&1&&(a.attachment=l[17]),e.$set(a)},i(l){t||(K(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){Se(e,l)}}}function Wt(s){let e,t,l=oe(s[0].embeds),r=[];for(let n=0;n<l.length;n+=1)r[n]=Jt(Ht(s,l,n));const a=n=>Q(r[n],1,1,()=>{r[n]=null});return{c(){for(let n=0;n<r.length;n+=1)r[n].c();e=Ee()},l(n){for(let i=0;i<r.length;i+=1)r[i].l(n);e=Ee()},m(n,i){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(n,i);H(n,e,i),t=!0},p(n,i){if(i&1){l=oe(n[0].embeds);let o;for(o=0;o<l.length;o+=1){const c=Ht(n,l,o);r[o]?(r[o].p(c,i),K(r[o],1)):(r[o]=Jt(c),r[o].c(),K(r[o],1),r[o].m(e.parentNode,e))}for(we(),o=l.length;o<r.length;o+=1)a(o);ke()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)K(r[i]);t=!0}},o(n){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)Q(r[i]);t=!1},d(n){n&&m(e),Ie(r,n)}}}function Jt(s){let e,t;return e=new Gr({props:{embed:s[14]}}),{c(){ye(e.$$.fragment)},l(l){Ce(e.$$.fragment,l)},m(l,r){De(e,l,r),t=!0},p(l,r){const a={};r&1&&(a.embed=l[14]),e.$set(a)},i(l){t||(K(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){Se(e,l)}}}function Yt(s){let e,t=oe(s[0].stickers),l=[];for(let r=0;r<t.length;r+=1)l[r]=Zt(Pt(s,t,r));return{c(){e=w("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(m),this.h()},h(){u(e,"class","mt-2 flex flex-wrap gap-2")},m(r,a){H(r,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(r,a){if(a&1){t=oe(r[0].stickers);let n;for(n=0;n<t.length;n+=1){const i=Pt(r,t,n);l[n]?l[n].p(i,a):(l[n]=Zt(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(r){r&&m(e),Ie(l,r)}}}function Zt(s){let e,t,l,r=s[11].name+"",a,n,i;return{c(){e=w("div"),t=w("span"),l=j("[Sticker: "),a=j(r),n=j("]"),i=I(),this.h()},l(o){e=b(o,"DIV",{class:!0});var c=E(e);t=b(c,"SPAN",{class:!0});var d=E(t);l=B(d,"[Sticker: "),a=B(d,r),n=B(d,"]"),d.forEach(m),i=A(c),c.forEach(m),this.h()},h(){u(t,"class","font-medium"),u(e,"class","text-sm text-base-content/70")},m(o,c){H(o,e,c),f(e,t),f(t,l),f(t,a),f(t,n),f(e,i)},p(o,c){c&1&&r!==(r=o[11].name+"")&&W(a,r)},d(o){o&&m(e)}}}function Qt(s){let e,t,l=oe(s[0].reactions),r=[];for(let n=0;n<l.length;n+=1)r[n]=Xt(Nt(s,l,n));const a=n=>Q(r[n],1,1,()=>{r[n]=null});return{c(){e=w("div");for(let n=0;n<r.length;n+=1)r[n].c();this.h()},l(n){e=b(n,"DIV",{class:!0});var i=E(e);for(let o=0;o<r.length;o+=1)r[o].l(i);i.forEach(m),this.h()},h(){u(e,"class","flex flex-wrap gap-1 mt-2")},m(n,i){H(n,e,i);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null);t=!0},p(n,i){if(i&1){l=oe(n[0].reactions);let o;for(o=0;o<l.length;o+=1){const c=Nt(n,l,o);r[o]?(r[o].p(c,i),K(r[o],1)):(r[o]=Xt(c),r[o].c(),K(r[o],1),r[o].m(e,null))}for(we(),o=l.length;o<r.length;o+=1)a(o);ke()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)K(r[i]);t=!0}},o(n){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)Q(r[i]);t=!1},d(n){n&&m(e),Ie(r,n)}}}function Xt(s){let e,t;return e=new Jr({props:{reaction:s[8]}}),{c(){ye(e.$$.fragment)},l(l){Ce(e.$$.fragment,l)},m(l,r){De(e,l,r),t=!0},p(l,r){const a={};r&1&&(a.reaction=l[8]),e.$set(a)},i(l){t||(K(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){Se(e,l)}}}function Qr(s){let e,t,l,r,a,n,i,o,c,d,h,p;function v(U,C){return U[1]&&!U[4]?Zr:Yr}let _=v(s),g=_(s),k=s[1]&&!s[4]&&jt(s),S=s[0].reference&&Rt(),N=s[0].content&&zt(s),M=s[0].attachments.length>0&&Gt(s),P=s[0].embeds.length>0&&Wt(s),V=s[0].stickers.length>0&&Yt(s),L=s[0].reactions.length>0&&Qt(s);return{c(){e=w("div"),t=w("div"),l=w("div"),g.c(),r=I(),a=w("div"),k&&k.c(),n=I(),S&&S.c(),i=I(),N&&N.c(),o=I(),M&&M.c(),c=I(),P&&P.c(),d=I(),V&&V.c(),h=I(),L&&L.c(),this.h()},l(U){e=b(U,"DIV",{class:!0});var C=E(e);t=b(C,"DIV",{class:!0});var D=E(t);l=b(D,"DIV",{class:!0});var T=E(l);g.l(T),T.forEach(m),r=A(D),a=b(D,"DIV",{class:!0});var y=E(a);k&&k.l(y),n=A(y),S&&S.l(y),i=A(y),N&&N.l(y),o=A(y),M&&M.l(y),c=A(y),P&&P.l(y),d=A(y),V&&V.l(y),h=A(y),L&&L.l(y),y.forEach(m),D.forEach(m),C.forEach(m),this.h()},h(){u(l,"class","w-10 flex-shrink-0 mt-0.5"),u(a,"class","flex-1 min-w-0"),u(t,"class","flex gap-4"),u(e,"class","message-container group hover:bg-base-200/50 py-0.5 px-4 transition svelte-1x2tzye")},m(U,C){H(U,e,C),f(e,t),f(t,l),g.m(l,null),f(t,r),f(t,a),k&&k.m(a,null),f(a,n),S&&S.m(a,null),f(a,i),N&&N.m(a,null),f(a,o),M&&M.m(a,null),f(a,c),P&&P.m(a,null),f(a,d),V&&V.m(a,null),f(a,h),L&&L.m(a,null),p=!0},p(U,[C]){_===(_=v(U))&&g?g.p(U,C):(g.d(1),g=_(U),g&&(g.c(),g.m(l,null))),U[1]&&!U[4]?k?k.p(U,C):(k=jt(U),k.c(),k.m(a,n)):k&&(k.d(1),k=null),U[0].reference?S||(S=Rt(),S.c(),S.m(a,i)):S&&(S.d(1),S=null),U[0].content?N?N.p(U,C):(N=zt(U),N.c(),N.m(a,o)):N&&(N.d(1),N=null),U[0].attachments.length>0?M?(M.p(U,C),C&1&&K(M,1)):(M=Gt(U),M.c(),K(M,1),M.m(a,c)):M&&(we(),Q(M,1,1,()=>{M=null}),ke()),U[0].embeds.length>0?P?(P.p(U,C),C&1&&K(P,1)):(P=Wt(U),P.c(),K(P,1),P.m(a,d)):P&&(we(),Q(P,1,1,()=>{P=null}),ke()),U[0].stickers.length>0?V?V.p(U,C):(V=Yt(U),V.c(),V.m(a,h)):V&&(V.d(1),V=null),U[0].reactions.length>0?L?(L.p(U,C),C&1&&K(L,1)):(L=Qt(U),L.c(),K(L,1),L.m(a,null)):L&&(we(),Q(L,1,1,()=>{L=null}),ke())},i(U){p||(K(M),K(P),K(L),p=!0)},o(U){Q(M),Q(P),Q(L),p=!1},d(U){U&&m(e),g.d(),k&&k.d(),S&&S.d(),N&&N.d(),M&&M.d(),P&&P.d(),V&&V.d(),L&&L.d()}}}function Xr(s){const e=new Date(s),t=new Date,l=e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear(),r=new Date(t);r.setDate(r.getDate()-1);const a=e.getDate()===r.getDate()&&e.getMonth()===r.getMonth()&&e.getFullYear()===r.getFullYear(),n=e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return l?`Today at ${n}`:a?`Yesterday at ${n}`:`${e.toLocaleDateString()} at ${n}`}function xr(s,e,t){let l,r,a,n,i,{message:o}=e,{showAvatar:c=!0}=e,{previousMessage:d=null}=e;return s.$$set=h=>{"message"in h&&t(0,o=h.message),"showAvatar"in h&&t(1,c=h.showAvatar),"previousMessage"in h&&t(7,d=h.previousMessage)},s.$$.update=()=>{s.$$.dirty&1&&t(6,l=Xr(o.timestamp)),s.$$.dirty&1&&t(5,r=new Date(o.timestamp).toLocaleString()),s.$$.dirty&131&&t(4,a=!c&&d&&d.author.id===o.author.id&&new Date(o.timestamp).getTime()-new Date(d.timestamp).getTime()<5*60*1e3),s.$$.dirty&1&&t(3,n=o.author.nickname||o.author.name),s.$$.dirty&1&&t(2,i=o.author.isBot)},[o,c,i,n,a,r,l,d]}class $r extends me{constructor(e){super(),pe(this,e,xr,Qr,ve,{message:0,showAvatar:1,previousMessage:7})}}function xt(s){let e,t,l;return{c(){e=w("img"),this.h()},l(r){e=b(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){he(e.src,t=s[0].iconUrl)||u(e,"src",t),u(e,"alt",l=s[0].name),u(e,"class","w-8 h-8 rounded-full")},m(r,a){H(r,e,a)},p(r,a){a&1&&!he(e.src,t=r[0].iconUrl)&&u(e,"src",t),a&1&&l!==(l=r[0].name)&&u(e,"alt",l)},d(r){r&&m(e)}}}function $t(s){let e,t="ðŸ”’";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1vmpw4h"&&(e.textContent=t),this.h()},h(){u(e,"class","text-lg")},m(l,r){H(l,e,r)},d(l){l&&m(e)}}}function el(s){let e,t="â€¢",l,r=s[1].category+"",a;return{c(){e=w("span"),e.textContent=t,l=I(),a=j(r),this.h()},l(n){e=b(n,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-3gu6cy"&&(e.textContent=t),l=A(n),a=B(n,r),this.h()},h(){u(e,"class","mx-1")},m(n,i){H(n,e,i),H(n,l,i),H(n,a,i)},p(n,i){i&2&&r!==(r=n[1].category+"")&&W(a,r)},d(n){n&&(m(e),m(l),m(a))}}}function tl(s){let e,t=s[1].topic+"",l;return{c(){e=w("div"),l=j(t),this.h()},l(r){e=b(r,"DIV",{class:!0});var a=E(e);l=B(a,t),a.forEach(m),this.h()},h(){u(e,"class","mt-2 text-sm text-base-content/70")},m(r,a){H(r,e,a),f(e,l)},p(r,a){a&2&&t!==(t=r[1].topic+"")&&W(l,t)},d(r){r&&m(e)}}}function es(s){let e,t,l,r,a,n,i="#",o,c,d=s[1].name+"",h,p,v=s[2].export_path.endsWith(".enc"),_,g,k=s[0].name+"",S,N,M,P,V,L,U,C=new Date(s[2].exported_at).toLocaleString()+"",D,T,y,O,F,z=s[3]===1?"message":"messages",X,re,ae,te=s[2].format+"",J,R=s[0].iconUrl&&xt(s),le=v&&$t(),ee=s[1].category&&el(s),Y=s[1].topic&&tl(s);return{c(){e=w("div"),t=w("div"),R&&R.c(),l=I(),r=w("div"),a=w("div"),n=w("span"),n.textContent=i,o=I(),c=w("h2"),h=j(d),p=I(),le&&le.c(),_=I(),g=w("div"),S=j(k),N=I(),ee&&ee.c(),M=I(),Y&&Y.c(),P=I(),V=w("div"),L=w("span"),U=j("Exported: "),D=j(C),T=I(),y=w("span"),O=j(s[3]),F=I(),X=j(z),re=I(),ae=w("span"),J=j(te),this.h()},l(G){e=b(G,"DIV",{class:!0});var q=E(e);t=b(q,"DIV",{class:!0});var x=E(t);R&&R.l(x),l=A(x),r=b(x,"DIV",{class:!0});var ce=E(r);a=b(ce,"DIV",{class:!0});var fe=E(a);n=b(fe,"SPAN",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-kcoxxm"&&(n.textContent=i),o=A(fe),c=b(fe,"H2",{class:!0});var _e=E(c);h=B(_e,d),_e.forEach(m),p=A(fe),le&&le.l(fe),fe.forEach(m),_=A(ce),g=b(ce,"DIV",{class:!0});var Ue=E(g);S=B(Ue,k),N=A(Ue),ee&&ee.l(Ue),Ue.forEach(m),ce.forEach(m),x.forEach(m),M=A(q),Y&&Y.l(q),P=A(q),V=b(q,"DIV",{class:!0});var ge=E(V);L=b(ge,"SPAN",{});var je=E(L);U=B(je,"Exported: "),D=B(je,C),je.forEach(m),T=A(ge),y=b(ge,"SPAN",{});var Ve=E(y);O=B(Ve,s[3]),F=A(Ve),X=B(Ve,z),Ve.forEach(m),re=A(ge),ae=b(ge,"SPAN",{class:!0});var rt=E(ae);J=B(rt,te),rt.forEach(m),ge.forEach(m),q.forEach(m),this.h()},h(){u(n,"class","text-base-content/60"),u(c,"class","text-lg font-semibold"),u(a,"class","flex items-center gap-2"),u(g,"class","text-sm text-base-content/60"),u(r,"class","flex-1"),u(t,"class","flex items-center gap-3"),u(ae,"class","uppercase font-semibold"),u(V,"class","mt-2 text-xs text-base-content/50 flex gap-4"),u(e,"class","p-4 bg-base-200 border-b border-base-300")},m(G,q){H(G,e,q),f(e,t),R&&R.m(t,null),f(t,l),f(t,r),f(r,a),f(a,n),f(a,o),f(a,c),f(c,h),f(a,p),le&&le.m(a,null),f(r,_),f(r,g),f(g,S),f(g,N),ee&&ee.m(g,null),f(e,M),Y&&Y.m(e,null),f(e,P),f(e,V),f(V,L),f(L,U),f(L,D),f(V,T),f(V,y),f(y,O),f(y,F),f(y,X),f(V,re),f(V,ae),f(ae,J)},p(G,[q]){G[0].iconUrl?R?R.p(G,q):(R=xt(G),R.c(),R.m(t,l)):R&&(R.d(1),R=null),q&2&&d!==(d=G[1].name+"")&&W(h,d),q&4&&(v=G[2].export_path.endsWith(".enc")),v?le||(le=$t(),le.c(),le.m(a,null)):le&&(le.d(1),le=null),q&1&&k!==(k=G[0].name+"")&&W(S,k),G[1].category?ee?ee.p(G,q):(ee=el(G),ee.c(),ee.m(g,null)):ee&&(ee.d(1),ee=null),G[1].topic?Y?Y.p(G,q):(Y=tl(G),Y.c(),Y.m(e,P)):Y&&(Y.d(1),Y=null),q&4&&C!==(C=new Date(G[2].exported_at).toLocaleString()+"")&&W(D,C),q&8&&W(O,G[3]),q&8&&z!==(z=G[3]===1?"message":"messages")&&W(X,z),q&4&&te!==(te=G[2].format+"")&&W(J,te)},i:$,o:$,d(G){G&&m(e),R&&R.d(),le&&le.d(),ee&&ee.d(),Y&&Y.d()}}}function ts(s,e,t){let{guild:l}=e,{channel:r}=e,{archive:a}=e,{messageCount:n}=e;return s.$$set=i=>{"guild"in i&&t(0,l=i.guild),"channel"in i&&t(1,r=i.channel),"archive"in i&&t(2,a=i.archive),"messageCount"in i&&t(3,n=i.messageCount)},[l,r,a,n]}class ls extends me{constructor(e){super(),pe(this,e,ts,es,ve,{guild:0,channel:1,archive:2,messageCount:3})}}function ll(s,e,t){const l=s.slice();return l[7]=e[t],l[9]=t,l}function rs(s){let e,t,l,r,a,n,i=s[2]===1?"message":"messages",o,c,d=oe(s[1]),h=[];for(let v=0;v<d.length;v+=1)h[v]=rl(ll(s,d,v));const p=v=>Q(h[v],1,1,()=>{h[v]=null});return{c(){e=w("div");for(let v=0;v<h.length;v+=1)h[v].c();t=I(),l=w("div"),r=j("End of archive â€¢ "),a=j(s[2]),n=I(),o=j(i),this.h()},l(v){e=b(v,"DIV",{class:!0});var _=E(e);for(let k=0;k<h.length;k+=1)h[k].l(_);_.forEach(m),t=A(v),l=b(v,"DIV",{class:!0});var g=E(l);r=B(g,"End of archive â€¢ "),a=B(g,s[2]),n=A(g),o=B(g,i),g.forEach(m),this.h()},h(){u(e,"class","py-4"),u(l,"class","px-4 pb-4 text-center text-sm text-base-content/50")},m(v,_){H(v,e,_);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(e,null);H(v,t,_),H(v,l,_),f(l,r),f(l,a),f(l,n),f(l,o),c=!0},p(v,_){if(_&34){d=oe(v[1]);let g;for(g=0;g<d.length;g+=1){const k=ll(v,d,g);h[g]?(h[g].p(k,_),K(h[g],1)):(h[g]=rl(k),h[g].c(),K(h[g],1),h[g].m(e,null))}for(we(),g=d.length;g<h.length;g+=1)p(g);ke()}(!c||_&4)&&W(a,v[2]),(!c||_&4)&&i!==(i=v[2]===1?"message":"messages")&&W(o,i)},i(v){if(!c){for(let _=0;_<d.length;_+=1)K(h[_]);c=!0}},o(v){h=h.filter(Boolean);for(let _=0;_<h.length;_+=1)Q(h[_]);c=!1},d(v){v&&(m(e),m(t),m(l)),Ie(h,v)}}}function ss(s){let e,t='<div class="text-6xl mb-4">ðŸ’¬</div> <div class="text-lg">No messages in this archive</div>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-aq7gij"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex flex-col items-center justify-center h-full text-base-content/40")},m(l,r){H(l,e,r)},p:$,i:$,o:$,d(l){l&&m(e)}}}function rl(s){let e,t;return e=new $r({props:{message:s[7],showAvatar:s[5](s[9]),previousMessage:s[9]>0?s[1][s[9]-1]:null}}),{c(){ye(e.$$.fragment)},l(l){Ce(e.$$.fragment,l)},m(l,r){De(e,l,r),t=!0},p(l,r){const a={};r&2&&(a.message=l[7]),r&2&&(a.previousMessage=l[9]>0?l[1][l[9]-1]:null),e.$set(a)},i(l){t||(K(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){Se(e,l)}}}function ns(s){let e,t,l,r,a,n,i;t=new ls({props:{guild:s[4],channel:s[3],archive:s[0],messageCount:s[2]}});const o=[ss,rs],c=[];function d(h,p){return h[1].length===0?0:1}return a=d(s),n=c[a]=o[a](s),{c(){e=w("div"),ye(t.$$.fragment),l=I(),r=w("div"),n.c(),this.h()},l(h){e=b(h,"DIV",{class:!0});var p=E(e);Ce(t.$$.fragment,p),l=A(p),r=b(p,"DIV",{class:!0});var v=E(r);n.l(v),v.forEach(m),p.forEach(m),this.h()},h(){u(r,"class","flex-1 overflow-y-auto"),u(e,"class","flex flex-col h-full bg-base-100")},m(h,p){H(h,e,p),De(t,e,null),f(e,l),f(e,r),c[a].m(r,null),i=!0},p(h,[p]){const v={};p&16&&(v.guild=h[4]),p&8&&(v.channel=h[3]),p&1&&(v.archive=h[0]),p&4&&(v.messageCount=h[2]),t.$set(v);let _=a;a=d(h),a===_?c[a].p(h,p):(we(),Q(c[_],1,1,()=>{c[_]=null}),ke(),n=c[a],n?n.p(h,p):(n=c[a]=o[a](h),n.c()),K(n,1),n.m(r,null))},i(h){i||(K(t.$$.fragment,h),K(n),i=!0)},o(h){Q(t.$$.fragment,h),Q(n),i=!1},d(h){h&&m(e),Se(t),c[a].d()}}}function as(s,e,t){let l,r,a,n,{jsonData:i}=e,{archive:o}=e;function c(d){if(d===0)return!0;const h=l[d],p=l[d-1];return h.author.id!==p.author.id?!0:new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime()>5*60*1e3}return s.$$set=d=>{"jsonData"in d&&t(6,i=d.jsonData),"archive"in d&&t(0,o=d.archive)},s.$$.update=()=>{s.$$.dirty&64&&t(1,l=i.messages||[]),s.$$.dirty&64&&t(4,r=i.guild),s.$$.dirty&64&&t(3,a=i.channel),s.$$.dirty&64&&t(2,n=i.messageCount)},[o,l,n,a,r,c,i]}class is extends me{constructor(e){super(),pe(this,e,as,ns,ve,{jsonData:6,archive:0})}}function os(s){let e,t='<div class="text-6xl mb-4">ðŸ“–</div> <div class="text-lg">Select a channel from the sidebar to start browsing</div>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1qodbfi"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex flex-col items-center justify-center h-full text-base-content/40")},m(l,r){H(l,e,r)},p:$,i:$,o:$,d(l){l&&m(e)}}}function cs(s){let e,t,l="âš ï¸",r,a,n,i=s[0].format+"",o,c,d,h="Supported: HTML, JSON";return{c(){e=w("div"),t=w("div"),t.textContent=l,r=I(),a=w("div"),n=j("Unsupported format: "),o=j(i),c=I(),d=w("div"),d.textContent=h,this.h()},l(p){e=b(p,"DIV",{class:!0});var v=E(e);t=b(v,"DIV",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-gp558o"&&(t.textContent=l),r=A(v),a=b(v,"DIV",{class:!0});var _=E(a);n=B(_,"Unsupported format: "),o=B(_,i),_.forEach(m),c=A(v),d=b(v,"DIV",{class:!0,"data-svelte-h":!0}),Z(d)!=="svelte-vafbzw"&&(d.textContent=h),v.forEach(m),this.h()},h(){u(t,"class","text-6xl mb-4"),u(a,"class","text-lg"),u(d,"class","text-sm mt-2"),u(e,"class","flex flex-col items-center justify-center h-full text-base-content/40")},m(p,v){H(p,e,v),f(e,t),f(e,r),f(e,a),f(a,n),f(a,o),f(e,c),f(e,d)},p(p,v){v&1&&i!==(i=p[0].format+"")&&W(o,i)},i:$,o:$,d(p){p&&m(e)}}}function fs(s){let e,t,l,r,a=(s[0]?.channel_name||s[0]?.channel_id||"Archive")+"",n,i,o=s[0]?.export_path.endsWith(".enc"),c,d,h,p=(s[0]?new Date(s[0].exported_at).toLocaleString():"N/A")+"",v,_,g=s[0]?.format.toUpperCase()+"",k,S,N,M,P=o&&sl();return{c(){e=w("div"),t=w("div"),l=w("div"),r=w("h2"),n=j(a),i=I(),P&&P.c(),c=I(),d=w("div"),h=j("Latest export: "),v=j(p),_=j(" â€¢ "),k=j(g),S=I(),N=w("iframe"),this.h()},l(V){e=b(V,"DIV",{class:!0});var L=E(e);t=b(L,"DIV",{class:!0});var U=E(t);l=b(U,"DIV",{class:!0});var C=E(l);r=b(C,"H2",{class:!0});var D=E(r);n=B(D,a),i=A(D),P&&P.l(D),D.forEach(m),C.forEach(m),c=A(U),d=b(U,"DIV",{class:!0});var T=E(d);h=B(T,"Latest export: "),v=B(T,p),_=B(T," â€¢ "),k=B(T,g),T.forEach(m),U.forEach(m),S=A(L),N=b(L,"IFRAME",{src:!0,title:!0,class:!0}),E(N).forEach(m),L.forEach(m),this.h()},h(){u(r,"class","text-lg font-semibold"),u(l,"class","flex items-center gap-2"),u(d,"class","text-sm text-base-content/60 mt-1"),u(t,"class","p-4 bg-base-200 border-b border-base-300"),he(N.src,M=s[1])||u(N,"src",M),u(N,"title","Archive viewer"),u(N,"class","flex-1 w-full border-0"),u(e,"class","flex-1 flex flex-col")},m(V,L){H(V,e,L),f(e,t),f(t,l),f(l,r),f(r,n),f(r,i),P&&P.m(r,null),f(t,c),f(t,d),f(d,h),f(d,v),f(d,_),f(d,k),f(e,S),f(e,N)},p(V,L){L&1&&a!==(a=(V[0]?.channel_name||V[0]?.channel_id||"Archive")+"")&&W(n,a),L&1&&(o=V[0]?.export_path.endsWith(".enc")),o?P||(P=sl(),P.c(),P.m(r,null)):P&&(P.d(1),P=null),L&1&&p!==(p=(V[0]?new Date(V[0].exported_at).toLocaleString():"N/A")+"")&&W(v,p),L&1&&g!==(g=V[0]?.format.toUpperCase()+"")&&W(k,g),L&2&&!he(N.src,M=V[1])&&u(N,"src",M)},i:$,o:$,d(V){V&&m(e),P&&P.d()}}}function us(s){let e,t;return e=new is({props:{jsonData:s[2],archive:s[0]}}),{c(){ye(e.$$.fragment)},l(l){Ce(e.$$.fragment,l)},m(l,r){De(e,l,r),t=!0},p(l,r){const a={};r&4&&(a.jsonData=l[2]),r&1&&(a.archive=l[0]),e.$set(a)},i(l){t||(K(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){Se(e,l)}}}function hs(s){let e,t='<div class="loading loading-spinner loading-lg"></div>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1urjiaz"&&(e.innerHTML=t),this.h()},h(){u(e,"class","flex items-center justify-center h-full")},m(l,r){H(l,e,r)},p:$,i:$,o:$,d(l){l&&m(e)}}}function sl(s){let e,t="ðŸ”’";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1cny2mi"&&(e.textContent=t),this.h()},h(){u(e,"class","ml-2")},m(l,r){H(l,e,r)},d(l){l&&m(e)}}}function ds(s){let e,t,l,r,a;const n=[hs,us,fs,cs,os],i=[];function o(c,d){return c[3]?0:c[5]&&c[2]&&c[0]?1:c[4]&&c[1]?2:c[0]?3:4}return l=o(s),r=i[l]=n[l](s),{c(){e=w("div"),t=w("div"),r.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var d=E(e);t=b(d,"DIV",{class:!0});var h=E(t);r.l(h),h.forEach(m),d.forEach(m),this.h()},h(){u(t,"class","flex-1 overflow-hidden"),u(e,"class","flex-1 flex flex-col bg-base-100")},m(c,d){H(c,e,d),f(e,t),i[l].m(t,null),a=!0},p(c,[d]){let h=l;l=o(c),l===h?i[l].p(c,d):(we(),Q(i[h],1,1,()=>{i[h]=null}),ke(),r=i[l],r?r.p(c,d):(r=i[l]=n[l](c),r.c()),K(r,1),r.m(t,null))},i(c){a||(K(r),a=!0)},o(c){Q(r),a=!1},d(c){c&&m(e),i[l].d()}}}function vs(s,e,t){let l,r,{archive:a=null}=e,{blobUrl:n=null}=e,{jsonData:i=null}=e,{isLoading:o=!1}=e;return s.$$set=c=>{"archive"in c&&t(0,a=c.archive),"blobUrl"in c&&t(1,n=c.blobUrl),"jsonData"in c&&t(2,i=c.jsonData),"isLoading"in c&&t(3,o=c.isLoading)},s.$$.update=()=>{s.$$.dirty&1&&t(5,l=a?.format==="json"),s.$$.dirty&1&&t(4,r=a?.format?.startsWith("html")||!1)},[a,n,i,o,r,l]}class ms extends me{constructor(e){super(),pe(this,e,vs,ds,ve,{archive:0,blobUrl:1,jsonData:2,isLoading:3})}}function nl(s,e,t){const l=s.slice();return l[21]=e[t],l}function al(s){let e,t;return e=new mr({}),e.$on("openSettings",s[12]),{c(){ye(e.$$.fragment)},l(l){Ce(e.$$.fragment,l)},m(l,r){De(e,l,r),t=!0},p:$,i(l){t||(K(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){Se(e,l)}}}function il(s){let e,t,l,r;return e=new Ur({props:{$$slots:{default:[ps]},$$scope:{ctx:s}}}),e.$on("openSettings",s[12]),l=new ms({props:{archive:s[3],blobUrl:s[4],jsonData:s[5],isLoading:s[6]}}),{c(){ye(e.$$.fragment),t=I(),ye(l.$$.fragment)},l(a){Ce(e.$$.fragment,a),t=A(a),Ce(l.$$.fragment,a)},m(a,n){De(e,a,n),H(a,t,n),De(l,a,n),r=!0},p(a,n){const i={};n&16777728&&(i.$$scope={dirty:n,ctx:a}),e.$set(i);const o={};n&8&&(o.archive=a[3]),n&16&&(o.blobUrl=a[4]),n&32&&(o.jsonData=a[5]),n&64&&(o.isLoading=a[6]),l.$set(o)},i(a){r||(K(e.$$.fragment,a),K(l.$$.fragment,a),r=!0)},o(a){Q(e.$$.fragment,a),Q(l.$$.fragment,a),r=!1},d(a){a&&m(t),Se(e,a),Se(l,a)}}}function ol(s){let e,t;return e=new Mr({props:{server:s[21]}}),e.$on("selectChannel",s[10]),{c(){ye(e.$$.fragment)},l(l){Ce(e.$$.fragment,l)},m(l,r){De(e,l,r),t=!0},p(l,r){const a={};r&512&&(a.server=l[21]),e.$set(a)},i(l){t||(K(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){Se(e,l)}}}function ps(s){let e,t,l=oe(s[9]),r=[];for(let n=0;n<l.length;n+=1)r[n]=ol(nl(s,l,n));const a=n=>Q(r[n],1,1,()=>{r[n]=null});return{c(){for(let n=0;n<r.length;n+=1)r[n].c();e=Ee()},l(n){for(let i=0;i<r.length;i+=1)r[i].l(n);e=Ee()},m(n,i){for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(n,i);H(n,e,i),t=!0},p(n,i){if(i&1536){l=oe(n[9]);let o;for(o=0;o<l.length;o+=1){const c=nl(n,l,o);r[o]?(r[o].p(c,i),K(r[o],1)):(r[o]=ol(c),r[o].c(),K(r[o],1),r[o].m(e.parentNode,e))}for(we(),o=l.length;o<r.length;o+=1)a(o);ke()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)K(r[i]);t=!0}},o(n){r=r.filter(Boolean);for(let i=0;i<r.length;i+=1)Q(r[i]);t=!1},d(n){n&&m(e),Ie(r,n)}}}function _s(s){let e,t,l,r,a,n,i,o,c,d=!s[2].isUnlocked&&s[1]&&al(s);function h(g){s[15](g)}let p={archive:s[8]};s[7]!==void 0&&(p.show=s[7]),r=new gr({props:p}),cl.push(()=>Vl(r,"show",h)),r.$on("unlock",s[11]);let v={required:!s[1]&&!s[2].isUnlocked};i=new Tr({props:v}),s[16](i);let _=s[2].isUnlocked&&il(s);return{c(){e=I(),t=w("div"),d&&d.c(),l=I(),ye(r.$$.fragment),n=I(),ye(i.$$.fragment),o=I(),_&&_.c(),this.h()},l(g){Ul("svelte-1nkvhcm",document.head).forEach(m),e=A(g),t=b(g,"DIV",{class:!0});var S=E(t);d&&d.l(S),l=A(S),Ce(r.$$.fragment,S),n=A(S),Ce(i.$$.fragment,S),o=A(S),_&&_.l(S),S.forEach(m),this.h()},h(){document.title="Discord Archive Browser",u(t,"class","flex h-screen overflow-hidden")},m(g,k){H(g,e,k),H(g,t,k),d&&d.m(t,null),f(t,l),De(r,t,null),f(t,n),De(i,t,null),f(t,o),_&&_.m(t,null),c=!0},p(g,[k]){!g[2].isUnlocked&&g[1]?d?(d.p(g,k),k&6&&K(d,1)):(d=al(g),d.c(),K(d,1),d.m(t,l)):d&&(we(),Q(d,1,1,()=>{d=null}),ke());const S={};k&256&&(S.archive=g[8]),!a&&k&128&&(a=!0,S.show=g[7],Il(()=>a=!1)),r.$set(S);const N={};k&6&&(N.required=!g[1]&&!g[2].isUnlocked),i.$set(N),g[2].isUnlocked?_?(_.p(g,k),k&4&&K(_,1)):(_=il(g),_.c(),K(_,1),_.m(t,null)):_&&(we(),Q(_,1,1,()=>{_=null}),ke())},i(g){c||(K(d),K(r.$$.fragment,g),K(i.$$.fragment,g),K(_),c=!0)},o(g){Q(d),Q(r.$$.fragment,g),Q(i.$$.fragment,g),Q(_),c=!1},d(g){g&&(m(e),m(t)),d&&d.d(),Se(r),s[16](null),Se(i),_&&_.d()}}}function gs(s,e,t){let l,r,a,n,i,o;Be(s,Ne,C=>t(14,n=C)),Be(s,Me,C=>t(2,i=C)),Be(s,jl,C=>t(9,o=C));let c=null,d=null,h=null,p=!1,v=!1,_=null,g,k=!1;Ll(async()=>{if(l&&!n.archiveSource)try{await new Ze(n.localServerUrl).testConnection()?Ne.update(T=>({...T,archiveSource:"local"})):Ne.update(T=>({...T,archiveSource:"github"}))}catch{Ne.update(C=>({...C,archiveSource:"github"}))}});async function S(C){const D=C.detail;if(t(3,c=D),t(5,h=null),d&&d.startsWith("blob:")&&URL.revokeObjectURL(d),t(4,d=null),D.export_path.endsWith(".enc")){const T=ul.get(D.secret_hint);T?await M(D,T):(t(8,_=D),t(7,v=!0))}else await P(D)}async function N(C){const{archive:D,password:T}=C.detail;await M(D,T),t(7,v=!1)}async function M(C,D){t(6,p=!0);try{const T=await ur(C.export_path,D,a);if(C.format==="json"){const O=new TextDecoder().decode(T);t(5,h=JSON.parse(O)),t(4,d=null)}else t(4,d=hr(T,C)),t(5,h=null)}catch(T){console.error("Failed to load encrypted archive:",T);const y=T instanceof Error?T.message:"The file may be corrupted.";alert(`Failed to decrypt and load archive: ${y}`)}finally{t(6,p=!1)}}async function P(C){t(6,p=!0);try{const D=await a.fetchFile(C.export_path);if(C.format==="json"){const y=new TextDecoder().decode(D);t(5,h=JSON.parse(y)),t(4,d=null)}else{const T=C.format.startsWith("html")?"text/html":"text/plain",y=new Blob([new Uint8Array(D)],{type:T});t(4,d=URL.createObjectURL(y)),t(5,h=null)}}catch(D){console.error("Failed to load unencrypted archive:",D);const T=D instanceof Error?D.message:"Failed to load from GitHub";alert(`Failed to load archive: ${T}`)}finally{t(6,p=!1)}}function V(){g.open()}function L(C){v=C,t(7,v)}function U(C){cl[C?"unshift":"push"](()=>{g=C,t(0,g)})}return s.$$.update=()=>{s.$$.dirty&16384&&t(1,r=n.archiveSource==="local"?!0:!!n.github.repoUrl),s.$$.dirty&8199&&!r&&!i.isUnlocked&&!k&&(t(13,k=!0),setTimeout(()=>g?.open(),100)),s.$$.dirty&16384&&(a=n.archiveSource==="local"?new Ze(n.localServerUrl):new lt(n.github))},l=["localhost","127.0.0.1","0.0.0.0"].includes(window.location.hostname),[g,r,i,c,d,h,p,v,_,o,S,N,V,k,n,L,U]}class Ds extends me{constructor(e){super(),pe(this,e,gs,_s,ve,{})}}export{Ds as component,Ss as universal};

var ll=Object.defineProperty;var sl=(r,e,t)=>e in r?ll(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ne=(r,e,t)=>sl(r,typeof e!="symbol"?e+"":e,t);import{s as he,n as $,d as p,r as Me,P as ce,Q as re,e as K,f as N,h as u,R as se,A as f,j as b,k,S as J,m as y,T as Ae,l as H,o as g,p as I,U as Ue,t as B,q as Le,V as je,v as be,W as rl,X as nl,Y as al,i as il,c as ol,u as cl,g as ul,b as fl,Z as Se,_ as ue,B as pe,C as xt,$ as hl,a0 as dl,x as ml}from"../chunks/DuLw_OxG.js";import{S as de,i as me,t as Y,a as z,g as ve,c as _e,d as ge,m as we,e as ke,b as Ee,f as pl}from"../chunks/CgOCePFP.js";import{w as qe,d as $t}from"../chunks/MwhEiSeW.js";function ne(r){return r?.length!==void 0?r:Array.from(r)}const vl=!0,_l=!1,Gs=Object.freeze(Object.defineProperty({__proto__:null,prerender:vl,ssr:_l},Symbol.toStringTag,{value:"Module"}));function bl(){const{subscribe:r,set:e,update:t}=qe({isUnlocked:!1,masterPassword:null,error:null});return{subscribe:r,unlock:l=>{t(s=>({...s,isUnlocked:!0,masterPassword:l,error:null}))},setError:l=>{t(s=>({...s,error:l}))},clearError:()=>{t(l=>({...l,error:null}))},reset:()=>{e({isUnlocked:!1,masterPassword:null,error:null})}}}const Ie=bl();function gl(){const{subscribe:r,set:e,update:t}=qe(new Map);return{subscribe:r,add:(l,s)=>{t(a=>{const n=new Map(a);return n.set(l,s),n})},get:l=>{let s;return r(a=>{s=a.get(l)})(),s},has:l=>{let s=!1;return r(a=>{s=a.has(l)})(),s},clear:()=>{e(new Map)}}}const el=gl();function wl(){const{subscribe:r,set:e,update:t}=qe({archives:[],isLoading:!1,error:null});return{subscribe:r,setArchives:l=>{e({archives:l,isLoading:!1,error:null})},setLoading:l=>{t(s=>({...s,isLoading:l}))},setError:l=>{t(s=>({...s,error:l,isLoading:!1}))},reset:()=>{e({archives:[],isLoading:!1,error:null})}}}const ze=wl(),kl=$t(ze,r=>{if(!r.archives.length)return[];const e=new Map,t=new Map;return r.archives.forEach(l=>{const s=`${l.server_id}-${l.channel_id}`;t.has(s)||t.set(s,[]),t.get(s).push(l)}),t.forEach((l,s)=>{l.sort((i,o)=>new Date(o.exported_at).getTime()-new Date(i.exported_at).getTime());const a=l[0];e.has(a.server_id)||e.set(a.server_id,{id:a.server_id,name:a.server_name,channels:[]});const n={...a,versions:l,versionCount:l.length};e.get(a.server_id).channels.push(n)}),Array.from(e.values())}),El=$t(ze,r=>{const e=new Set(r.archives.map(l=>l.server_id)),t=new Set(r.archives.map(l=>l.channel_id));return{totalArchives:r.archives.length,uniqueServers:e.size,uniqueChannels:t.size}}),Ve={github:{repoUrl:void 0,branch:"main",pat:void 0}},Be={archiveSource:"github",localServerUrl:"http://localhost:8000",github:{repoUrl:"",branch:Ve.github.branch,pat:Ve.github.pat}},Oe="discord-archiver-settings";function Sl(){try{const r=localStorage.getItem(Oe);if(r){const e=JSON.parse(r);return e.repoUrl!==void 0?{...Be,github:{repoUrl:e.repoUrl||"",branch:e.branch||"main",pat:e.pat}}:{...Be,...e}}}catch(r){console.error("Failed to load settings from localStorage:",r)}return Be}function Dl(){const{subscribe:r,set:e,update:t}=qe(Sl());return{subscribe:r,set:l=>{try{localStorage.setItem(Oe,JSON.stringify(l))}catch(s){console.error("Failed to save settings to localStorage:",s)}e(l)},update:l=>{t(s=>{const a=l(s);try{localStorage.setItem(Oe,JSON.stringify(a))}catch(n){console.error("Failed to save settings to localStorage:",n)}return a})},reset:()=>{try{localStorage.removeItem(Oe)}catch(l){console.error("Failed to remove settings from localStorage:",l)}e(Be)}}}const Te=Dl(),Cl=6e5;async function yl(r,e){const t=new TextEncoder,l=await crypto.subtle.importKey("raw",t.encode(r),"PBKDF2",!1,["deriveBits"]),s=await crypto.subtle.deriveBits({name:"PBKDF2",salt:e,iterations:Cl,hash:"SHA-256"},l,256);return await crypto.subtle.importKey("raw",s,"AES-GCM",!0,["encrypt","decrypt"])}async function Il(r){const t=new TextEncoder().encode(r),l=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(l)).map(n=>n.toString(16).padStart(2,"0")).join("").substring(0,8)}async function Tl(r,e){return await Il(r)===e}const Pe=8,Ge=12;async function tl(r,e){if(r.length<Pe+Ge)throw new Error("Invalid encrypted data: too short");const t=r.slice(0,Pe),l=r.slice(Pe,Pe+Ge),s=r.slice(Pe+Ge),a=await yl(e,t),n=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},a,s);return new Uint8Array(n)}async function Al(r,e){const t=await tl(r,e),s=new TextDecoder().decode(t);return JSON.parse(s)}async function Ul(r,e){const t=await e.fetchFile("archives/.archive_metadata.json.enc");return await Al(t,r)}async function Ll(r,e,t){const l=await t.fetchFile(r);return await tl(l,e)}function Vl(r,e){const t=e.format==="html"||e.format.startsWith("html")?"text/html":e.format==="json"?"application/json":"text/plain",l=new Blob([r],{type:t});return URL.createObjectURL(l)}class Ke{constructor(e){Ne(this,"repoUrl");Ne(this,"branch");Ne(this,"pat");this.repoUrl=e.repoUrl,this.branch=e.branch,this.pat=e.pat}async fetchFile(e){const t=e.startsWith("/")?e.slice(1):e,l=`https://api.github.com/repos/${this.repoUrl}/contents/${t}?ref=${this.branch}`,s={Accept:"application/vnd.github.v3.raw"};this.pat&&(s.Authorization=`token ${this.pat}`);const a=await fetch(l,{headers:s});if(!a.ok)throw a.status===404?new Error(`File not found in GitHub repository: ${e}`):a.status===401||a.status===403?new Error("GitHub authentication failed. A Personal Access Token is required for private repositories. Please add your PAT in Settings."):new Error(`Failed to fetch file from GitHub: ${a.status} ${a.statusText}`);const n=await a.arrayBuffer();return new Uint8Array(n)}async fetchMetadata(){return this.fetchFile(".archive_metadata.json.enc")}async fetchArchive(e){return this.fetchFile(e)}async testConnection(){try{return await this.fetchMetadata(),!0}catch(e){return console.error("GitHub connection test failed:",e),!1}}}class Fe{constructor(e=""){Ne(this,"baseUrl");this.baseUrl=e}async fetchFile(e){const t=e.startsWith("/")?e:`/${e}`,l=this.baseUrl?`${this.baseUrl}${t}`:t,s=await fetch(l);if(!s.ok)throw s.status===404?new Error(`File not found on local server: ${e}`):new Error(`Failed to fetch file from local server: ${s.status} ${s.statusText}`);const a=await s.arrayBuffer();return new Uint8Array(a)}async fetchMetadata(){return this.fetchFile("archives/.archive_metadata.json.enc")}async fetchArchive(e){return this.fetchFile(e)}async testConnection(){try{return await this.fetchMetadata(),!0}catch(e){return console.error("Local server connection test failed:",e),!1}}}function Je(r){let e,t,l,s,a,n;return{c(){e=g("div"),t=Ue("svg"),l=Ue("path"),s=I(),a=g("span"),n=B(r[2]),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=k(e);t=Ae(o,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var c=k(t);l=Ae(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(l).forEach(p),c.forEach(p),s=y(o),a=b(o,"SPAN",{class:!0});var h=k(a);n=H(h,r[2]),h.forEach(p),o.forEach(p),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"stroke-width","2"),f(l,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"class","stroke-current shrink-0 h-6 w-6"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(a,"class","text-sm"),f(e,"class","alert alert-error mb-3")},m(i,o){N(i,e,o),u(e,t),u(t,l),u(e,s),u(e,a),u(a,n)},p(i,o){o&4&&K(n,i[2])},d(i){i&&p(e)}}}function Ml(r){let e,t,l,s="Master Password Required",a,n,i="Enter your master password to decrypt the archive metadata and browse your archives.",o,c,h,d,_,m,v,w,E,S,M,P,j=r[1]?"Unlocking...":"Unlock",V,U,A,C=r[2]&&Je(r);return{c(){e=g("dialog"),t=g("div"),l=g("h3"),l.textContent=s,a=I(),n=g("p"),n.textContent=i,o=I(),c=g("input"),h=I(),C&&C.c(),d=I(),_=g("div"),m=g("button"),v=Ue("svg"),w=Ue("path"),E=Ue("path"),S=B(`
				Settings`),M=I(),P=g("button"),V=B(j),this.h()},l(D){e=b(D,"DIALOG",{class:!0});var T=k(e);t=b(T,"DIV",{class:!0});var L=k(t);l=b(L,"H3",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-12v7ilt"&&(l.textContent=s),a=y(L),n=b(L,"P",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-7uye46"&&(n.textContent=i),o=y(L),c=b(L,"INPUT",{type:!0,placeholder:!0,class:!0}),h=y(L),C&&C.l(L),d=y(L),_=b(L,"DIV",{class:!0});var F=k(_);m=b(F,"BUTTON",{class:!0});var O=k(m);v=Ae(O,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var R=k(v);w=Ae(R,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(w).forEach(p),E=Ae(R,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(E).forEach(p),R.forEach(p),S=H(O,`
				Settings`),O.forEach(p),M=y(F),P=b(F,"BUTTON",{class:!0});var X=k(P);V=H(X,j),X.forEach(p),F.forEach(p),L.forEach(p),T.forEach(p),this.h()},h(){f(l,"class","font-bold text-lg mb-2"),f(n,"class","text-sm text-base-content/70 mb-4"),f(c,"type","password"),f(c,"placeholder","Master password"),f(c,"class","input input-bordered w-full mb-3"),c.disabled=r[1],c.autofocus=!0,re(c,"input-error",r[2]),f(w,"stroke-linecap","round"),f(w,"stroke-linejoin","round"),f(w,"stroke-width","2"),f(w,"d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"),f(E,"stroke-linecap","round"),f(E,"stroke-linejoin","round"),f(E,"stroke-width","2"),f(E,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),f(v,"xmlns","http://www.w3.org/2000/svg"),f(v,"class","h-4 w-4 mr-1"),f(v,"fill","none"),f(v,"viewBox","0 0 24 24"),f(v,"stroke","currentColor"),f(m,"class","btn btn-ghost btn-sm"),m.disabled=r[1],f(P,"class","btn btn-primary"),P.disabled=r[1],re(P,"loading",r[1]),f(_,"class","modal-action flex justify-between items-center"),f(t,"class","modal-box bg-base-200"),f(e,"class","modal modal-open")},m(D,T){N(D,e,T),u(e,t),u(t,l),u(t,a),u(t,n),u(t,o),u(t,c),ce(c,r[0]),u(t,h),C&&C.m(t,null),u(t,d),u(t,_),u(_,m),u(m,v),u(v,w),u(v,E),u(m,S),u(_,M),u(_,P),u(P,V),c.focus(),U||(A=[se(c,"input",r[8]),se(c,"keypress",r[4]),se(m,"click",r[5]),se(P,"click",r[3])],U=!0)},p(D,[T]){T&2&&(c.disabled=D[1]),T&1&&c.value!==D[0]&&ce(c,D[0]),T&4&&re(c,"input-error",D[2]),D[2]?C?C.p(D,T):(C=Je(D),C.c(),C.m(t,d)):C&&(C.d(1),C=null),T&2&&(m.disabled=D[1]),T&2&&j!==(j=D[1]?"Unlocking...":"Unlock")&&K(V,j),T&2&&(P.disabled=D[1]),T&2&&re(P,"loading",D[1])},i:$,o:$,d(D){D&&p(e),C&&C.d(),U=!1,Me(A)}}}function Nl(r,e,t){let l,s,a,n;Le(r,Ie,v=>t(6,a=v)),Le(r,Te,v=>t(7,n=v));const i=je();let o="",c=!1;async function h(){if(!o){Ie.setError("Password cannot be empty");return}if(n.archiveSource==="github"&&!n.github.repoUrl){Ie.setError("GitHub repository not configured. Please check settings.");return}t(1,c=!0),Ie.clearError();try{const v=await Ul(o,l);Ie.unlock(o),ze.setArchives(v.archives||[])}catch(v){console.error("Decryption error:",v),Ie.setError("Incorrect password or corrupted metadata file"),t(0,o="")}finally{t(1,c=!1)}}function d(v){v.key==="Enter"&&h()}function _(){i("openSettings")}function m(){o=this.value,t(0,o)}return r.$$.update=()=>{r.$$.dirty&128&&(l=n.archiveSource==="local"?new Fe(n.localServerUrl):new Ke(n.github)),r.$$.dirty&64&&t(2,s=a.error)},[o,c,s,h,d,_,a,n,m]}class Pl extends de{constructor(e){super(),me(this,e,Nl,Ml,he,{})}}function Ye(r){let e,t,l,s="Archive Password Required",a,n,i="This archive is encrypted. Enter the password to decrypt and view it.",o,c,h,d,_,m,v,w,E,S,M=r[3]?"Decrypting...":"Decrypt",P,j,V,U="<button>close</button>",A,C,D=r[1]?.secret_hint&&Ze(r),T=r[4]&&Qe(r);return{c(){e=g("dialog"),t=g("div"),l=g("h3"),l.textContent=s,a=I(),n=g("p"),n.textContent=i,o=I(),D&&D.c(),c=I(),h=g("input"),d=I(),T&&T.c(),_=I(),m=g("div"),v=g("button"),w=B("Cancel"),E=I(),S=g("button"),P=B(M),j=I(),V=g("form"),V.innerHTML=U,this.h()},l(L){e=b(L,"DIALOG",{class:!0});var F=k(e);t=b(F,"DIV",{class:!0});var O=k(t);l=b(O,"H3",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-j0hl0n"&&(l.textContent=s),a=y(O),n=b(O,"P",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-oo4ac9"&&(n.textContent=i),o=y(O),D&&D.l(O),c=y(O),h=b(O,"INPUT",{type:!0,placeholder:!0,class:!0}),d=y(O),T&&T.l(O),_=y(O),m=b(O,"DIV",{class:!0});var R=k(m);v=b(R,"BUTTON",{class:!0});var X=k(v);w=H(X,"Cancel"),X.forEach(p),E=y(R),S=b(R,"BUTTON",{class:!0});var ae=k(S);P=H(ae,M),ae.forEach(p),R.forEach(p),O.forEach(p),j=y(F),V=b(F,"FORM",{method:!0,class:!0,"data-svelte-h":!0}),J(V)!=="svelte-1v3agxd"&&(V.innerHTML=U),F.forEach(p),this.h()},h(){f(l,"class","font-bold text-lg mb-2"),f(n,"class","text-sm text-base-content/70 mb-3"),f(h,"type","password"),f(h,"placeholder","Archive password"),f(h,"class","input input-bordered w-full mb-3"),h.disabled=r[3],h.autofocus=!0,re(h,"input-error",r[4]),f(v,"class","btn btn-ghost"),v.disabled=r[3],f(S,"class","btn btn-primary"),S.disabled=r[3],re(S,"loading",r[3]),f(m,"class","modal-action"),f(t,"class","modal-box bg-base-200"),f(V,"method","dialog"),f(V,"class","modal-backdrop"),f(e,"class","modal modal-open")},m(L,F){N(L,e,F),u(e,t),u(t,l),u(t,a),u(t,n),u(t,o),D&&D.m(t,null),u(t,c),u(t,h),ce(h,r[2]),u(t,d),T&&T.m(t,null),u(t,_),u(t,m),u(m,v),u(v,w),u(m,E),u(m,S),u(S,P),u(e,j),u(e,V),h.focus(),A||(C=[se(h,"input",r[8]),se(h,"keypress",r[7]),se(v,"click",r[6]),se(S,"click",r[5]),se(V,"click",r[6])],A=!0)},p(L,F){L[1]?.secret_hint?D?D.p(L,F):(D=Ze(L),D.c(),D.m(t,c)):D&&(D.d(1),D=null),F&8&&(h.disabled=L[3]),F&4&&h.value!==L[2]&&ce(h,L[2]),F&16&&re(h,"input-error",L[4]),L[4]?T?T.p(L,F):(T=Qe(L),T.c(),T.m(t,_)):T&&(T.d(1),T=null),F&8&&(v.disabled=L[3]),F&8&&M!==(M=L[3]?"Decrypting...":"Decrypt")&&K(P,M),F&8&&(S.disabled=L[3]),F&8&&re(S,"loading",L[3])},d(L){L&&p(e),D&&D.d(),T&&T.d(),A=!1,Me(C)}}}function Ze(r){let e,t,l="Password hint:",s,a,n=r[1].secret_hint+"",i;return{c(){e=g("div"),t=g("span"),t.textContent=l,s=I(),a=g("span"),i=B(n),this.h()},l(o){e=b(o,"DIV",{class:!0});var c=k(e);t=b(c,"SPAN",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-ngl7h5"&&(t.textContent=l),s=y(c),a=b(c,"SPAN",{class:!0});var h=k(a);i=H(h,n),h.forEach(p),c.forEach(p),this.h()},h(){f(t,"class","text-xs text-base-content/50"),f(a,"class","text-sm font-mono ml-2"),f(e,"class","bg-base-300 rounded px-3 py-2 mb-3")},m(o,c){N(o,e,c),u(e,t),u(e,s),u(e,a),u(a,i)},p(o,c){c&2&&n!==(n=o[1].secret_hint+"")&&K(i,n)},d(o){o&&p(e)}}}function Qe(r){let e,t,l,s,a,n;return{c(){e=g("div"),t=Ue("svg"),l=Ue("path"),s=I(),a=g("span"),n=B(r[4]),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=k(e);t=Ae(o,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var c=k(t);l=Ae(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(l).forEach(p),c.forEach(p),s=y(o),a=b(o,"SPAN",{class:!0});var h=k(a);n=H(h,r[4]),h.forEach(p),o.forEach(p),this.h()},h(){f(l,"stroke-linecap","round"),f(l,"stroke-linejoin","round"),f(l,"stroke-width","2"),f(l,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"class","stroke-current shrink-0 h-6 w-6"),f(t,"fill","none"),f(t,"viewBox","0 0 24 24"),f(a,"class","text-sm"),f(e,"class","alert alert-error mb-3")},m(i,o){N(i,e,o),u(e,t),u(t,l),u(e,s),u(e,a),u(a,n)},p(i,o){o&16&&K(n,i[4])},d(i){i&&p(e)}}}function jl(r){let e,t=r[0]&&Ye(r);return{c(){t&&t.c(),e=be()},l(l){t&&t.l(l),e=be()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,[s]){l[0]?t?t.p(l,s):(t=Ye(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&p(e),t&&t.d(l)}}}function Hl(r,e,t){let{archive:l=null}=e,{show:s=!1}=e;const a=je();let n="",i=!1,o="";async function c(){if(!l||!n){t(4,o="Password cannot be empty");return}t(3,i=!0),t(4,o="");try{if(!await Tl(n,l.secret_hint))throw new Error("Password hint mismatch");el.add(l.secret_hint,n),a("unlock",{archive:l,password:n}),h()}catch(m){console.error("Archive unlock error:",m),t(4,o="Incorrect password"),t(2,n="")}finally{t(3,i=!1)}}function h(){t(0,s=!1),t(2,n=""),t(4,o="")}function d(m){m.key==="Enter"?c():m.key==="Escape"&&h()}function _(){n=this.value,t(2,n)}return r.$$set=m=>{"archive"in m&&t(1,l=m.archive),"show"in m&&t(0,s=m.show)},[s,l,n,i,o,c,h,d,_]}class Bl extends de{constructor(e){super(),me(this,e,Hl,jl,he,{archive:1,show:0})}}function Xe(r){let e,t,l,s,a=r[0]?"Archive Configuration Required":"Archive Settings",n,i,o,c,h,d,_,m,v,w,E,S=r[0]?"Continue":"Save Settings",M,P,j,V;function U(O,R){return O[0]?Fl:Ol}let A=U(r),C=A(r),D=r[8]&&xe(r),T=r[8]&&r[2].archiveSource==="local"&&$e(r),L=(!r[8]||r[2].archiveSource==="github")&&tt(r),F=!r[0]&&rt(r);return{c(){e=g("div"),t=g("div"),l=g("div"),s=g("h2"),n=B(a),i=I(),o=g("p"),C.c(),c=I(),h=g("div"),D&&D.c(),d=I(),T&&T.c(),_=I(),L&&L.c(),m=I(),v=g("div"),F&&F.c(),w=I(),E=g("button"),M=B(S),this.h()},l(O){e=b(O,"DIV",{class:!0,role:!0,"aria-labelledby":!0,"aria-modal":!0});var R=k(e);t=b(R,"DIV",{class:!0,role:!0});var X=k(t);l=b(X,"DIV",{class:!0});var ae=k(l);s=b(ae,"H2",{id:!0,class:!0});var ie=k(s);n=H(ie,a),ie.forEach(p),i=y(ae),o=b(ae,"P",{class:!0});var ee=k(o);C.l(ee),ee.forEach(p),ae.forEach(p),c=y(X),h=b(X,"DIV",{class:!0});var Z=k(h);D&&D.l(Z),d=y(Z),T&&T.l(Z),_=y(Z),L&&L.l(Z),Z.forEach(p),m=y(X),v=b(X,"DIV",{class:!0});var q=k(v);F&&F.l(q),w=y(q),E=b(q,"BUTTON",{class:!0});var te=k(E);M=H(te,S),te.forEach(p),q.forEach(p),X.forEach(p),R.forEach(p),this.h()},h(){f(s,"id","settings-title"),f(s,"class","text-2xl font-bold"),f(o,"class","text-sm text-base-content/70 mt-1"),f(l,"class","border-b border-base-300 p-6"),f(h,"class","p-6 space-y-6"),f(E,"class","btn btn-primary"),E.disabled=P=!r[7],f(v,"class","border-t border-base-300 p-6 flex justify-end gap-3"),f(t,"class","bg-base-200 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"),f(t,"role","document"),f(e,"class","fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center"),f(e,"role","dialog"),f(e,"aria-labelledby","settings-title"),f(e,"aria-modal","true")},m(O,R){N(O,e,R),u(e,t),u(t,l),u(l,s),u(s,n),u(l,i),u(l,o),C.m(o,null),u(t,c),u(t,h),D&&D.m(h,null),u(h,d),T&&T.m(h,null),u(h,_),L&&L.m(h,null),u(t,m),u(t,v),F&&F.m(v,null),u(v,w),u(v,E),u(E,M),j||(V=[se(E,"click",r[9]),se(t,"click",rl(r[15])),se(t,"keydown",r[13]),se(e,"click",function(){il(r[0]?void 0:r[10])&&(r[0]?void 0:r[10]).apply(this,arguments)})],j=!0)},p(O,R){r=O,R&1&&a!==(a=r[0]?"Archive Configuration Required":"Archive Settings")&&K(n,a),A!==(A=U(r))&&(C.d(1),C=A(r),C&&(C.c(),C.m(o,null))),r[8]?D?D.p(r,R):(D=xe(r),D.c(),D.m(h,d)):D&&(D.d(1),D=null),r[8]&&r[2].archiveSource==="local"?T?T.p(r,R):(T=$e(r),T.c(),T.m(h,_)):T&&(T.d(1),T=null),!r[8]||r[2].archiveSource==="github"?L?L.p(r,R):(L=tt(r),L.c(),L.m(h,null)):L&&(L.d(1),L=null),r[0]?F&&(F.d(1),F=null):F?F.p(r,R):(F=rt(r),F.c(),F.m(v,w)),R&1&&S!==(S=r[0]?"Continue":"Save Settings")&&K(M,S),R&128&&P!==(P=!r[7])&&(E.disabled=P)},d(O){O&&p(e),C.d(),D&&D.d(),T&&T.d(),L&&L.d(),F&&F.d(),j=!1,Me(V)}}}function Ol(r){let e;return{c(){e=B("Configure archive source and connection settings")},l(t){e=H(t,"Configure archive source and connection settings")},m(t,l){N(t,e,l)},d(t){t&&p(e)}}}function Fl(r){let e;return{c(){e=B("Configure where to load archives from")},l(t){e=H(t,"Configure where to load archives from")},m(t,l){N(t,e,l)},d(t){t&&p(e)}}}function xe(r){let e,t,l='<span class="label-text font-semibold">Archive Source</span>',s,a,n,i,o,c,h='<span class="font-medium">Local Server</span> <p class="text-sm text-base-content/70">Connect to a local development server (requires <code>uv run discord-archiver serve</code>)</p>',d,_,m,v,w,E='<span class="font-medium">GitHub Repository</span> <p class="text-sm text-base-content/70">Fetch encrypted archives from a GitHub repository</p>',S,M,P,j,V;return P=al(r[17][0]),{c(){e=g("div"),t=g("label"),t.innerHTML=l,s=I(),a=g("div"),n=g("label"),i=g("input"),o=I(),c=g("div"),c.innerHTML=h,d=I(),_=g("label"),m=g("input"),v=I(),w=g("div"),w.innerHTML=E,S=I(),M=g("div"),this.h()},l(U){e=b(U,"DIV",{class:!0});var A=k(e);t=b(A,"LABEL",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-4yw0a2"&&(t.innerHTML=l),s=y(A),a=b(A,"DIV",{class:!0});var C=k(a);n=b(C,"LABEL",{class:!0});var D=k(n);i=b(D,"INPUT",{type:!0,name:!0,class:!0}),o=y(D),c=b(D,"DIV",{class:!0,"data-svelte-h":!0}),J(c)!=="svelte-1g0nozf"&&(c.innerHTML=h),D.forEach(p),d=y(C),_=b(C,"LABEL",{class:!0});var T=k(_);m=b(T,"INPUT",{type:!0,name:!0,class:!0}),v=y(T),w=b(T,"DIV",{class:!0,"data-svelte-h":!0}),J(w)!=="svelte-ci4p9t"&&(w.innerHTML=E),T.forEach(p),C.forEach(p),A.forEach(p),S=y(U),M=b(U,"DIV",{class:!0}),k(M).forEach(p),this.h()},h(){f(t,"class","label"),f(i,"type","radio"),f(i,"name","archiveSource"),i.__value="local",ce(i,i.__value),f(i,"class","radio radio-primary mt-1"),f(c,"class","flex-1"),f(n,"class","flex items-start gap-3 cursor-pointer"),f(m,"type","radio"),f(m,"name","archiveSource"),m.__value="github",ce(m,m.__value),f(m,"class","radio radio-primary mt-1"),f(w,"class","flex-1"),f(_,"class","flex items-start gap-3 cursor-pointer"),f(a,"class","space-y-3"),f(e,"class","form-control"),f(M,"class","divider"),P.p(i,m)},m(U,A){N(U,e,A),u(e,t),u(e,s),u(e,a),u(a,n),u(n,i),i.checked=i.__value===r[2].archiveSource,u(n,o),u(n,c),u(a,d),u(a,_),u(_,m),m.checked=m.__value===r[2].archiveSource,u(_,v),u(_,w),N(U,S,A),N(U,M,A),j||(V=[se(i,"change",r[16]),se(m,"change",r[18])],j=!0)},p(U,A){A&4&&(i.checked=i.__value===U[2].archiveSource),A&4&&(m.checked=m.__value===U[2].archiveSource)},d(U){U&&(p(e),p(S),p(M)),P.r(),j=!1,Me(V)}}}function $e(r){let e,t,l="Local Server Configuration",s,a,n,i='<span class="label-text font-semibold">Server URL</span>',o,c,h,d,_='<span class="label-text-alt">URL of your local archive server</span>',m,v,w,E,S,M;function P(A,C){return A[3]?Rl:ql}let j=P(r),V=j(r),U=r[5]&&et(r);return{c(){e=g("div"),t=g("h3"),t.textContent=l,s=I(),a=g("div"),n=g("label"),n.innerHTML=i,o=I(),c=g("input"),h=I(),d=g("label"),d.innerHTML=_,m=I(),v=g("div"),w=g("button"),V.c(),E=I(),U&&U.c(),this.h()},l(A){e=b(A,"DIV",{class:!0});var C=k(e);t=b(C,"H3",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-132aedx"&&(t.textContent=l),s=y(C),a=b(C,"DIV",{class:!0});var D=k(a);n=b(D,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(n)!=="svelte-r9lki"&&(n.innerHTML=i),o=y(D),c=b(D,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),h=y(D),d=b(D,"LABEL",{class:!0,"data-svelte-h":!0}),J(d)!=="svelte-7hpdir"&&(d.innerHTML=_),D.forEach(p),m=y(C),v=b(C,"DIV",{class:!0});var T=k(v);w=b(T,"BUTTON",{class:!0});var L=k(w);V.l(L),L.forEach(p),T.forEach(p),E=y(C),U&&U.l(C),C.forEach(p),this.h()},h(){f(t,"class","text-lg font-semibold"),f(n,"class","label"),f(n,"for","local-url"),f(c,"id","local-url"),f(c,"type","text"),f(c,"placeholder","http://localhost:8000"),f(c,"class","input input-bordered w-full"),f(d,"class","label"),f(a,"class","form-control"),f(w,"class","btn btn-outline btn-sm"),w.disabled=r[3],f(v,"class","form-control"),f(e,"class","space-y-4")},m(A,C){N(A,e,C),u(e,t),u(e,s),u(e,a),u(a,n),u(a,o),u(a,c),ce(c,r[2].localServerUrl),u(a,h),u(a,d),u(e,m),u(e,v),u(v,w),V.m(w,null),u(e,E),U&&U.m(e,null),S||(M=[se(c,"input",r[19]),se(w,"click",r[11])],S=!0)},p(A,C){C&4&&c.value!==A[2].localServerUrl&&ce(c,A[2].localServerUrl),j!==(j=P(A))&&(V.d(1),V=j(A),V&&(V.c(),V.m(w,null))),C&8&&(w.disabled=A[3]),A[5]?U?U.p(A,C):(U=et(A),U.c(),U.m(e,null)):U&&(U.d(1),U=null)},d(A){A&&p(e),V.d(),U&&U.d(),S=!1,Me(M)}}}function ql(r){let e;return{c(){e=B("Test Connection")},l(t){e=H(t,"Test Connection")},m(t,l){N(t,e,l)},d(t){t&&p(e)}}}function Rl(r){let e,t;return{c(){e=g("span"),t=B(`
									Testing...`),this.h()},l(l){e=b(l,"SPAN",{class:!0}),k(e).forEach(p),t=H(l,`
									Testing...`),this.h()},h(){f(e,"class","loading loading-spinner loading-sm")},m(l,s){N(l,e,s),N(l,t,s)},d(l){l&&(p(e),p(t))}}}function et(r){let e,t,l,s=r[5].success?"Success":"Error",a,n,i,o=r[5].message+"",c;return{c(){e=g("div"),t=g("div"),l=g("span"),a=B(s),n=I(),i=g("p"),c=B(o),this.h()},l(h){e=b(h,"DIV",{class:!0});var d=k(e);t=b(d,"DIV",{});var _=k(t);l=b(_,"SPAN",{class:!0});var m=k(l);a=H(m,s),m.forEach(p),n=y(_),i=b(_,"P",{class:!0});var v=k(i);c=H(v,o),v.forEach(p),_.forEach(p),d.forEach(p),this.h()},h(){f(l,"class","font-semibold"),f(i,"class","text-sm"),f(e,"class","alert"),re(e,"alert-success",r[5].success),re(e,"alert-error",!r[5].success)},m(h,d){N(h,e,d),u(e,t),u(t,l),u(l,a),u(t,n),u(t,i),u(i,c)},p(h,d){d&32&&s!==(s=h[5].success?"Success":"Error")&&K(a,s),d&32&&o!==(o=h[5].message+"")&&K(c,o),d&32&&re(e,"alert-success",h[5].success),d&32&&re(e,"alert-error",!h[5].success)},d(h){h&&p(e)}}}function tt(r){let e,t,l,s,a='<span class="label-text font-semibold">Repository URL</span>',n,i,o,c,h='<span class="label-text-alt">Format: owner/repo (required)</span>',d,_,m,v='<span class="label-text font-semibold">Branch</span>',w,E,S,M,P='<span class="label-text-alt">Branch containing the archives</span>',j,V,U,A='<span class="label-text font-semibold">Personal Access Token (Optional)</span>',C,D,T,L,F=`<span class="label-text-alt">Required for private repositories.
									<a href="https://github.com/settings/tokens/new?scopes=repo&amp;description=Discord%20Archive%20Viewer" target="_blank" rel="noopener noreferrer" class="link link-primary">Create a token</a> with &quot;Contents: Read&quot; permission.</span>`,O,R,X,ae,ie,ee,Z,q=r[8]&&lt();function te(G,x){return G[4]?zl:Gl}let le=te(r),Q=le(r),W=r[6]&&st(r);return{c(){e=g("div"),q&&q.c(),t=I(),l=g("div"),s=g("label"),s.innerHTML=a,n=I(),i=g("input"),o=I(),c=g("label"),c.innerHTML=h,d=I(),_=g("div"),m=g("label"),m.innerHTML=v,w=I(),E=g("input"),S=I(),M=g("label"),M.innerHTML=P,j=I(),V=g("div"),U=g("label"),U.innerHTML=A,C=I(),D=g("input"),T=I(),L=g("label"),L.innerHTML=F,O=I(),R=g("div"),X=g("button"),Q.c(),ie=I(),W&&W.c(),this.h()},l(G){e=b(G,"DIV",{class:!0});var x=k(e);q&&q.l(x),t=y(x),l=b(x,"DIV",{class:!0});var oe=k(l);s=b(oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(s)!=="svelte-1n8t60c"&&(s.innerHTML=a),n=y(oe),i=b(oe,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),o=y(oe),c=b(oe,"LABEL",{class:!0,"data-svelte-h":!0}),J(c)!=="svelte-fl2y61"&&(c.innerHTML=h),oe.forEach(p),d=y(x),_=b(x,"DIV",{class:!0});var fe=k(_);m=b(fe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(m)!=="svelte-r09qt1"&&(m.innerHTML=v),w=y(fe),E=b(fe,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),S=y(fe),M=b(fe,"LABEL",{class:!0,"data-svelte-h":!0}),J(M)!=="svelte-1n0gekw"&&(M.innerHTML=P),fe.forEach(p),j=y(x),V=b(x,"DIV",{class:!0});var De=k(V);U=b(De,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),J(U)!=="svelte-fcsc6s"&&(U.innerHTML=A),C=y(De),D=b(De,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),T=y(De),L=b(De,"LABEL",{class:!0,"data-svelte-h":!0}),J(L)!=="svelte-yt4t3v"&&(L.innerHTML=F),De.forEach(p),O=y(x),R=b(x,"DIV",{class:!0});var ye=k(R);X=b(ye,"BUTTON",{class:!0});var Ce=k(X);Q.l(Ce),Ce.forEach(p),ye.forEach(p),ie=y(x),W&&W.l(x),x.forEach(p),this.h()},h(){f(s,"class","label"),f(s,"for","repo-url"),f(i,"id","repo-url"),f(i,"type","text"),f(i,"placeholder","owner/repo (e.g., palaima/discord-archives)"),f(i,"class","input input-bordered w-full"),i.required=!0,f(c,"class","label"),f(l,"class","form-control"),f(m,"class","label"),f(m,"for","branch"),f(E,"id","branch"),f(E,"type","text"),f(E,"placeholder","main"),f(E,"class","input input-bordered w-full"),f(M,"class","label"),f(_,"class","form-control"),f(U,"class","label"),f(U,"for","pat"),f(D,"id","pat"),f(D,"type","password"),f(D,"placeholder","github_pat_xxxxx..."),f(D,"class","input input-bordered w-full font-mono text-sm"),f(L,"class","label"),f(V,"class","form-control"),f(X,"class","btn btn-outline btn-sm"),X.disabled=ae=r[4]||!r[2].github.repoUrl,f(R,"class","form-control"),f(e,"class","space-y-4")},m(G,x){N(G,e,x),q&&q.m(e,null),u(e,t),u(e,l),u(l,s),u(l,n),u(l,i),ce(i,r[2].github.repoUrl),u(l,o),u(l,c),u(e,d),u(e,_),u(_,m),u(_,w),u(_,E),ce(E,r[2].github.branch),u(_,S),u(_,M),u(e,j),u(e,V),u(V,U),u(V,C),u(V,D),ce(D,r[2].github.pat),u(V,T),u(V,L),u(e,O),u(e,R),u(R,X),Q.m(X,null),u(e,ie),W&&W.m(e,null),ee||(Z=[se(i,"input",r[20]),se(E,"input",r[21]),se(D,"input",r[22]),se(X,"click",r[12])],ee=!0)},p(G,x){G[8]?q||(q=lt(),q.c(),q.m(e,t)):q&&(q.d(1),q=null),x&4&&i.value!==G[2].github.repoUrl&&ce(i,G[2].github.repoUrl),x&4&&E.value!==G[2].github.branch&&ce(E,G[2].github.branch),x&4&&D.value!==G[2].github.pat&&ce(D,G[2].github.pat),le!==(le=te(G))&&(Q.d(1),Q=le(G),Q&&(Q.c(),Q.m(X,null))),x&20&&ae!==(ae=G[4]||!G[2].github.repoUrl)&&(X.disabled=ae),G[6]?W?W.p(G,x):(W=st(G),W.c(),W.m(e,null)):W&&(W.d(1),W=null)},d(G){G&&p(e),q&&q.d(),Q.d(),W&&W.d(),ee=!1,Me(Z)}}}function lt(r){let e,t="GitHub Repository Configuration";return{c(){e=g("h3"),e.textContent=t,this.h()},l(l){e=b(l,"H3",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-53c2ha"&&(e.textContent=t),this.h()},h(){f(e,"class","text-lg font-semibold")},m(l,s){N(l,e,s)},d(l){l&&p(e)}}}function Gl(r){let e;return{c(){e=B("Test Connection")},l(t){e=H(t,"Test Connection")},m(t,l){N(t,e,l)},d(t){t&&p(e)}}}function zl(r){let e,t;return{c(){e=g("span"),t=B(`
									Testing...`),this.h()},l(l){e=b(l,"SPAN",{class:!0}),k(e).forEach(p),t=H(l,`
									Testing...`),this.h()},h(){f(e,"class","loading loading-spinner loading-sm")},m(l,s){N(l,e,s),N(l,t,s)},d(l){l&&(p(e),p(t))}}}function st(r){let e,t,l,s=r[6].success?"Success":"Error",a,n,i,o=r[6].message+"",c;return{c(){e=g("div"),t=g("div"),l=g("span"),a=B(s),n=I(),i=g("p"),c=B(o),this.h()},l(h){e=b(h,"DIV",{class:!0});var d=k(e);t=b(d,"DIV",{});var _=k(t);l=b(_,"SPAN",{class:!0});var m=k(l);a=H(m,s),m.forEach(p),n=y(_),i=b(_,"P",{class:!0});var v=k(i);c=H(v,o),v.forEach(p),_.forEach(p),d.forEach(p),this.h()},h(){f(l,"class","font-semibold"),f(i,"class","text-sm"),f(e,"class","alert"),re(e,"alert-success",r[6].success),re(e,"alert-error",!r[6].success)},m(h,d){N(h,e,d),u(e,t),u(t,l),u(l,a),u(t,n),u(t,i),u(i,c)},p(h,d){d&64&&s!==(s=h[6].success?"Success":"Error")&&K(a,s),d&64&&o!==(o=h[6].message+"")&&K(c,o),d&64&&re(e,"alert-success",h[6].success),d&64&&re(e,"alert-error",!h[6].success)},d(h){h&&p(e)}}}function rt(r){let e,t="Cancel",l,s;return{c(){e=g("button"),e.textContent=t,this.h()},l(a){e=b(a,"BUTTON",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-121k3bn"&&(e.textContent=t),this.h()},h(){f(e,"class","btn btn-ghost")},m(a,n){N(a,e,n),l||(s=se(e,"click",r[10]),l=!0)},p:$,d(a){a&&p(e),l=!1,s()}}}function Kl(r){let e,t=r[1]&&Xe(r);return{c(){t&&t.c(),e=be()},l(l){t&&t.l(l),e=be()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,[s]){l[1]?t?t.p(l,s):(t=Xe(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&p(e),t&&t.d(l)}}}function Wl(r,e,t){let l,s,a;Le(r,Te,O=>t(23,a=O));const n=je();let{required:i=!1}=e,o=!1,c=a,h=!1,d=!1,_=null,m=null;function v(){t(1,o=!0),t(2,c={...a,github:{...a.github}}),t(5,_=null),t(6,m=null)}function w(){t(1,o=!1),n("close")}function E(){Te.set(c),w()}function S(){i||(t(2,c={...a,github:{...a.github}}),w())}async function M(){t(3,h=!0),t(5,_=null);try{await new Fe(c.localServerUrl).testConnection()?t(5,_={success:!0,message:"Connected! Local server is reachable."}):t(5,_={success:!1,message:"Connection failed. Is the server running?"})}catch(O){t(5,_={success:!1,message:O instanceof Error?O.message:"Unknown error occurred"})}finally{t(3,h=!1)}}async function P(){if(!c.github.repoUrl){t(6,m={success:!1,message:"Please enter a repository URL"});return}t(4,d=!0),t(6,m=null);try{await new Ke(c.github).testConnection()?t(6,m={success:!0,message:"Connection successful! Metadata file found."}):t(6,m={success:!1,message:"Connection failed. Check repository URL and permissions."})}catch(O){t(6,m={success:!1,message:O instanceof Error?O.message:"Unknown error occurred"})}finally{t(4,d=!1)}}function j(O){O.key==="Escape"&&!i&&S()}const V=[[]];function U(O){nl.call(this,r,O)}function A(){c.archiveSource=this.__value,t(2,c),t(1,o)}function C(){c.archiveSource=this.__value,t(2,c),t(1,o)}function D(){c.localServerUrl=this.value,t(2,c),t(1,o)}function T(){c.github.repoUrl=this.value,t(2,c),t(1,o)}function L(){c.github.branch=this.value,t(2,c),t(1,o)}function F(){c.github.pat=this.value,t(2,c),t(1,o)}return r.$$set=O=>{"required"in O&&t(0,i=O.required)},r.$$.update=()=>{r.$$.dirty&6&&o&&!c.github.repoUrl&&Ve.github.repoUrl&&t(2,c={...c,github:{...c.github,repoUrl:Ve.github.repoUrl,branch:Ve.github.branch,pat:Ve.github.pat}}),r.$$.dirty&4&&t(7,s=c.archiveSource==="local"?!0:!!c.github.repoUrl)},t(8,l=["localhost","127.0.0.1","0.0.0.0"].includes(window.location.hostname)),[i,o,c,h,d,_,m,s,l,E,S,M,P,j,v,U,A,V,C,D,T,L,F]}class Jl extends de{constructor(e){super(),me(this,e,Wl,Kl,he,{required:0,open:14})}get open(){return this.$$.ctx[14]}}function Yl(r){let e,t,l,s,a="Discord Archives",n,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',c,h,d,_,m=r[0].totalArchives+"",v,w,E,S,M,P=r[0].uniqueServers+"",j,V,U,A,C,D=r[0].uniqueChannels+"",T,L,F,O,R,X,ae;const ie=r[3].default,ee=ol(ie,r,r[2],null);return{c(){e=g("div"),t=g("div"),l=g("div"),s=g("h1"),s.textContent=a,n=I(),i=g("button"),i.innerHTML=o,c=I(),h=g("div"),d=g("div"),_=B("ðŸ“ "),v=B(m),w=B(" archives"),E=I(),S=g("div"),M=B("ðŸ–¥ï¸ "),j=B(P),V=B(" servers"),U=I(),A=g("div"),C=B("ðŸ’¬ "),T=B(D),L=B(" channels"),F=I(),O=g("div"),ee&&ee.c(),this.h()},l(Z){e=b(Z,"DIV",{class:!0});var q=k(e);t=b(q,"DIV",{class:!0});var te=k(t);l=b(te,"DIV",{class:!0});var le=k(l);s=b(le,"H1",{class:!0,"data-svelte-h":!0}),J(s)!=="svelte-176jj07"&&(s.textContent=a),n=y(le),i=b(le,"BUTTON",{class:!0,title:!0,"aria-label":!0,"data-svelte-h":!0}),J(i)!=="svelte-9lg1f1"&&(i.innerHTML=o),le.forEach(p),c=y(te),h=b(te,"DIV",{class:!0});var Q=k(h);d=b(Q,"DIV",{});var W=k(d);_=H(W,"ðŸ“ "),v=H(W,m),w=H(W," archives"),W.forEach(p),E=y(Q),S=b(Q,"DIV",{});var G=k(S);M=H(G,"ðŸ–¥ï¸ "),j=H(G,P),V=H(G," servers"),G.forEach(p),U=y(Q),A=b(Q,"DIV",{});var x=k(A);C=H(x,"ðŸ’¬ "),T=H(x,D),L=H(x," channels"),x.forEach(p),Q.forEach(p),te.forEach(p),F=y(q),O=b(q,"DIV",{class:!0});var oe=k(O);ee&&ee.l(oe),oe.forEach(p),q.forEach(p),this.h()},h(){f(s,"class","text-xl font-semibold"),f(i,"class","btn btn-ghost btn-sm btn-square"),f(i,"title","Settings"),f(i,"aria-label","Open settings"),f(l,"class","flex items-center justify-between mb-3"),f(h,"class","text-sm space-y-1 text-base-content/70"),f(t,"class","p-5 bg-base-300 border-b border-base-100"),f(O,"class","flex-1 overflow-y-auto p-3"),f(e,"class","w-80 bg-base-200 border-r border-base-300 flex flex-col h-screen")},m(Z,q){N(Z,e,q),u(e,t),u(t,l),u(l,s),u(l,n),u(l,i),u(t,c),u(t,h),u(h,d),u(d,_),u(d,v),u(d,w),u(h,E),u(h,S),u(S,M),u(S,j),u(S,V),u(h,U),u(h,A),u(A,C),u(A,T),u(A,L),u(e,F),u(e,O),ee&&ee.m(O,null),R=!0,X||(ae=se(i,"click",r[1]),X=!0)},p(Z,[q]){(!R||q&1)&&m!==(m=Z[0].totalArchives+"")&&K(v,m),(!R||q&1)&&P!==(P=Z[0].uniqueServers+"")&&K(j,P),(!R||q&1)&&D!==(D=Z[0].uniqueChannels+"")&&K(T,D),ee&&ee.p&&(!R||q&4)&&cl(ee,ie,Z,Z[2],R?fl(ie,Z[2],q,null):ul(Z[2]),null)},i(Z){R||(z(ee,Z),R=!0)},o(Z){Y(ee,Z),R=!1},d(Z){Z&&p(e),ee&&ee.d(Z),X=!1,ae()}}}function Zl(r,e,t){let l;Le(r,El,o=>t(0,l=o));let{$$slots:s={},$$scope:a}=e;const n=je();function i(){n("openSettings")}return r.$$set=o=>{"$$scope"in o&&t(2,a=o.$$scope)},[l,i,a,s]}class Ql extends de{constructor(e){super(),me(this,e,Zl,Yl,he,{})}}function nt(r,e,t){const l=r.slice();return l[6]=e[t],l}function at(r){let e,t=ne(r[1].channels),l=[];for(let s=0;s<t.length;s+=1)l[s]=it(nt(r,t,s));return{c(){e=g("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(p),this.h()},h(){f(e,"class","pl-3 mt-2 space-y-1")},m(s,a){N(s,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(s,a){if(a&10){t=ne(s[1].channels);let n;for(n=0;n<t.length;n+=1){const i=nt(s,t,n);l[n]?l[n].p(i,a):(l[n]=it(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(s){s&&p(e),Se(l,s)}}}function it(r){let e,t,l="#",s,a,n=(r[6].channel_name||r[6].channel_id)+"",i,o,c,h=new Date(r[6].exported_at).toLocaleDateString()+"",d,_,m,v;function w(){return r[4](r[6])}return{c(){e=g("button"),t=g("span"),t.textContent=l,s=I(),a=g("span"),i=B(n),o=I(),c=g("span"),d=B(h),_=I(),this.h()},l(E){e=b(E,"BUTTON",{class:!0});var S=k(e);t=b(S,"SPAN",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-ulfyf0"&&(t.textContent=l),s=y(S),a=b(S,"SPAN",{class:!0});var M=k(a);i=H(M,n),M.forEach(p),o=y(S),c=b(S,"SPAN",{class:!0});var P=k(c);d=H(P,h),P.forEach(p),_=y(S),S.forEach(p),this.h()},h(){f(t,"class","text-base-content/50 group-hover:text-base-content"),f(a,"class","flex-1"),f(c,"class","text-xs text-base-content/40"),f(e,"class","w-full px-3 py-2 rounded hover:bg-base-100 transition-colors flex items-center gap-2 text-sm text-left group")},m(E,S){N(E,e,S),u(e,t),u(e,s),u(e,a),u(a,i),u(e,o),u(e,c),u(c,d),u(e,_),m||(v=se(e,"click",w),m=!0)},p(E,S){r=E,S&2&&n!==(n=(r[6].channel_name||r[6].channel_id)+"")&&K(i,n),S&2&&h!==(h=new Date(r[6].exported_at).toLocaleDateString()+"")&&K(d,h)},d(E){E&&p(e),m=!1,v()}}}function Xl(r){let e,t,l,s="â–¼",a,n,i=r[1].name+"",o,c,h,d,_=!r[0]&&at(r);return{c(){e=g("div"),t=g("button"),l=g("span"),l.textContent=s,a=I(),n=g("span"),o=B(i),c=I(),_&&_.c(),this.h()},l(m){e=b(m,"DIV",{class:!0});var v=k(e);t=b(v,"BUTTON",{class:!0});var w=k(t);l=b(w,"SPAN",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-1nry6l9"&&(l.textContent=s),a=y(w),n=b(w,"SPAN",{});var E=k(n);o=H(E,i),E.forEach(p),w.forEach(p),c=y(v),_&&_.l(v),v.forEach(p),this.h()},h(){f(l,"class","transform transition-transform text-xs"),re(l,"rotate-0",!r[0]),re(l,"-rotate-90",r[0]),f(t,"class","w-full px-3 py-2 bg-base-300 rounded hover:bg-base-100 transition-colors flex items-center gap-2 font-semibold text-sm"),f(e,"class","mb-4")},m(m,v){N(m,e,v),u(e,t),u(t,l),u(t,a),u(t,n),u(n,o),u(e,c),_&&_.m(e,null),h||(d=se(t,"click",r[2]),h=!0)},p(m,[v]){v&1&&re(l,"rotate-0",!m[0]),v&1&&re(l,"-rotate-90",m[0]),v&2&&i!==(i=m[1].name+"")&&K(o,i),m[0]?_&&(_.d(1),_=null):_?_.p(m,v):(_=at(m),_.c(),_.m(e,null))},i:$,o:$,d(m){m&&p(e),_&&_.d(),h=!1,d()}}}function xl(r,e,t){let{server:l}=e,{collapsed:s=!1}=e;const a=je();function n(){t(0,s=!s)}function i(c){a("selectChannel",c)}const o=c=>i(c);return r.$$set=c=>{"server"in c&&t(1,l=c.server),"collapsed"in c&&t(0,s=c.collapsed)},[s,l,n,i,o]}class $l extends de{constructor(e){super(),me(this,e,xl,Xl,he,{server:1,collapsed:0})}}function es(r){let e,t,l="ðŸ“Ž",s,a,n,i=r[0].fileName+"",o,c,h,d,_,m,v='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>',w;return{c(){e=g("a"),t=g("div"),t.textContent=l,s=I(),a=g("div"),n=g("div"),o=B(i),c=I(),h=g("div"),d=B(r[1]),_=I(),m=g("div"),m.innerHTML=v,this.h()},l(E){e=b(E,"A",{href:!0,target:!0,rel:!0,class:!0});var S=k(e);t=b(S,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-dlenr"&&(t.textContent=l),s=y(S),a=b(S,"DIV",{class:!0});var M=k(a);n=b(M,"DIV",{class:!0});var P=k(n);o=H(P,i),P.forEach(p),c=y(M),h=b(M,"DIV",{class:!0});var j=k(h);d=H(j,r[1]),j.forEach(p),M.forEach(p),_=y(S),m=b(S,"DIV",{class:!0,"data-svelte-h":!0}),J(m)!=="svelte-1qs47xs"&&(m.innerHTML=v),S.forEach(p),this.h()},h(){f(t,"class","text-3xl"),f(n,"class","font-medium truncate"),f(h,"class","text-xs text-base-content/60"),f(a,"class","flex-1 min-w-0"),f(m,"class","text-primary"),f(e,"href",w=r[0].url),f(e,"target","_blank"),f(e,"rel","noopener noreferrer"),f(e,"class","flex items-center gap-3 p-3 bg-base-300 rounded hover:bg-base-200 transition max-w-md")},m(E,S){N(E,e,S),u(e,t),u(e,s),u(e,a),u(a,n),u(n,o),u(a,c),u(a,h),u(h,d),u(e,_),u(e,m)},p(E,S){S&1&&i!==(i=E[0].fileName+"")&&K(o,i),S&2&&K(d,E[1]),S&1&&w!==(w=E[0].url)&&f(e,"href",w)},d(E){E&&p(e)}}}function ts(r){let e,t,l,s,a;return{c(){e=g("a"),t=g("img"),this.h()},l(n){e=b(n,"A",{href:!0,target:!0,rel:!0});var i=k(e);t=b(i,"IMG",{src:!0,alt:!0,class:!0,loading:!0}),i.forEach(p),this.h()},h(){ue(t.src,l=r[0].url)||f(t,"src",l),f(t,"alt",s=r[0].fileName),f(t,"class","max-w-md max-h-96 rounded hover:opacity-90 transition cursor-pointer"),f(t,"loading","lazy"),f(e,"href",a=r[0].url),f(e,"target","_blank"),f(e,"rel","noopener noreferrer")},m(n,i){N(n,e,i),u(e,t)},p(n,i){i&1&&!ue(t.src,l=n[0].url)&&f(t,"src",l),i&1&&s!==(s=n[0].fileName)&&f(t,"alt",s),i&1&&a!==(a=n[0].url)&&f(e,"href",a)},d(n){n&&p(e)}}}function ls(r){let e;function t(a,n){return a[2]?ts:es}let l=t(r),s=l(r);return{c(){e=g("div"),s.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var n=k(e);s.l(n),n.forEach(p),this.h()},h(){f(e,"class","mt-2")},m(a,n){N(a,e,n),s.m(e,null)},p(a,[n]){l===(l=t(a))&&s?s.p(a,n):(s.d(1),s=l(a),s&&(s.c(),s.m(e,null)))},i:$,o:$,d(a){a&&p(e),s.d()}}}function ss(r){return r<1024?`${r} B`:r<1024*1024?`${(r/1024).toFixed(1)} KB`:`${(r/(1024*1024)).toFixed(1)} MB`}function rs(r,e,t){let l,s,{attachment:a}=e;return r.$$set=n=>{"attachment"in n&&t(0,a=n.attachment)},r.$$.update=()=>{r.$$.dirty&1&&t(2,l=/\.(jpg|jpeg|png|gif|webp)$/i.test(a.fileName)),r.$$.dirty&1&&t(1,s=ss(a.fileSizeBytes))},[a,s,l]}class ns extends de{constructor(e){super(),me(this,e,rs,ls,he,{attachment:0})}}function ot(r,e,t){const l=r.slice();return l[2]=e[t],l}function ct(r,e,t){const l=r.slice();return l[5]=e[t],l}function ut(r){let e,t,l,s,a,n,i=r[0].title&&ft(r),o=r[0].description&&ht(r),c=r[0].fields&&r[0].fields.length>0&&dt(r),h=r[0].thumbnail&&pt(r),d=r[0].video&&vt(r),_=r[0].images&&r[0].images.length>0&&_t(r);return{c(){e=g("div"),i&&i.c(),t=I(),o&&o.c(),l=I(),c&&c.c(),s=I(),h&&h.c(),a=I(),d&&d.c(),n=I(),_&&_.c(),this.h()},l(m){e=b(m,"DIV",{class:!0});var v=k(e);i&&i.l(v),t=y(v),o&&o.l(v),l=y(v),c&&c.l(v),s=y(v),h&&h.l(v),a=y(v),d&&d.l(v),n=y(v),_&&_.l(v),v.forEach(p),this.h()},h(){f(e,"class","mt-2 border-l-4 border-primary pl-3 py-2 bg-base-200/50 rounded max-w-lg")},m(m,v){N(m,e,v),i&&i.m(e,null),u(e,t),o&&o.m(e,null),u(e,l),c&&c.m(e,null),u(e,s),h&&h.m(e,null),u(e,a),d&&d.m(e,null),u(e,n),_&&_.m(e,null)},p(m,v){m[0].title?i?i.p(m,v):(i=ft(m),i.c(),i.m(e,t)):i&&(i.d(1),i=null),m[0].description?o?o.p(m,v):(o=ht(m),o.c(),o.m(e,l)):o&&(o.d(1),o=null),m[0].fields&&m[0].fields.length>0?c?c.p(m,v):(c=dt(m),c.c(),c.m(e,s)):c&&(c.d(1),c=null),m[0].thumbnail?h?h.p(m,v):(h=pt(m),h.c(),h.m(e,a)):h&&(h.d(1),h=null),m[0].video?d?d.p(m,v):(d=vt(m),d.c(),d.m(e,n)):d&&(d.d(1),d=null),m[0].images&&m[0].images.length>0?_?_.p(m,v):(_=_t(m),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(m){m&&p(e),i&&i.d(),o&&o.d(),c&&c.d(),h&&h.d(),d&&d.d(),_&&_.d()}}}function ft(r){let e;function t(a,n){return a[0].url?is:as}let l=t(r),s=l(r);return{c(){e=g("div"),s.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var n=k(e);s.l(n),n.forEach(p),this.h()},h(){f(e,"class","font-semibold mb-1")},m(a,n){N(a,e,n),s.m(e,null)},p(a,n){l===(l=t(a))&&s?s.p(a,n):(s.d(1),s=l(a),s&&(s.c(),s.m(e,null)))},d(a){a&&p(e),s.d()}}}function as(r){let e=r[0].title+"",t;return{c(){t=B(e)},l(l){t=H(l,e)},m(l,s){N(l,t,s)},p(l,s){s&1&&e!==(e=l[0].title+"")&&K(t,e)},d(l){l&&p(t)}}}function is(r){let e,t=r[0].title+"",l,s;return{c(){e=g("a"),l=B(t),this.h()},l(a){e=b(a,"A",{href:!0,target:!0,rel:!0,class:!0});var n=k(e);l=H(n,t),n.forEach(p),this.h()},h(){f(e,"href",s=r[0].url),f(e,"target","_blank"),f(e,"rel","noopener noreferrer"),f(e,"class","text-primary hover:underline")},m(a,n){N(a,e,n),u(e,l)},p(a,n){n&1&&t!==(t=a[0].title+"")&&K(l,t),n&1&&s!==(s=a[0].url)&&f(e,"href",s)},d(a){a&&p(e)}}}function ht(r){let e,t=r[0].description+"",l;return{c(){e=g("div"),l=B(t),this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);l=H(a,t),a.forEach(p),this.h()},h(){f(e,"class","text-sm text-base-content/80 mb-2 whitespace-pre-wrap")},m(s,a){N(s,e,a),u(e,l)},p(s,a){a&1&&t!==(t=s[0].description+"")&&K(l,t)},d(s){s&&p(e)}}}function dt(r){let e,t=ne(r[0].fields),l=[];for(let s=0;s<t.length;s+=1)l[s]=mt(ct(r,t,s));return{c(){e=g("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(p),this.h()},h(){f(e,"class","grid gap-2 mt-2")},m(s,a){N(s,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(s,a){if(a&1){t=ne(s[0].fields);let n;for(n=0;n<t.length;n+=1){const i=ct(s,t,n);l[n]?l[n].p(i,a):(l[n]=mt(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(s){s&&p(e),Se(l,s)}}}function mt(r){let e,t,l=r[5].name+"",s,a,n,i=r[5].value+"",o,c;return{c(){e=g("div"),t=g("div"),s=B(l),a=I(),n=g("div"),o=B(i),c=I(),this.h()},l(h){e=b(h,"DIV",{});var d=k(e);t=b(d,"DIV",{class:!0});var _=k(t);s=H(_,l),_.forEach(p),a=y(d),n=b(d,"DIV",{class:!0});var m=k(n);o=H(m,i),m.forEach(p),c=y(d),d.forEach(p),this.h()},h(){f(t,"class","font-semibold text-sm"),f(n,"class","text-sm text-base-content/80")},m(h,d){N(h,e,d),u(e,t),u(t,s),u(e,a),u(e,n),u(n,o),u(e,c)},p(h,d){d&1&&l!==(l=h[5].name+"")&&K(s,l),d&1&&i!==(i=h[5].value+"")&&K(o,i)},d(h){h&&p(e)}}}function pt(r){let e,t,l;return{c(){e=g("div"),t=g("img"),this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);t=b(a,"IMG",{src:!0,alt:!0,class:!0,loading:!0,style:!0}),a.forEach(p),this.h()},h(){ue(t.src,l=r[0].thumbnail.url)||f(t,"src",l),f(t,"alt","Thumbnail"),f(t,"class","rounded max-w-xs"),f(t,"loading","lazy"),pe(t,"max-width",r[0].thumbnail.width+"px"),pe(t,"max-height",r[0].thumbnail.height+"px"),f(e,"class","mt-2")},m(s,a){N(s,e,a),u(e,t)},p(s,a){a&1&&!ue(t.src,l=s[0].thumbnail.url)&&f(t,"src",l),a&1&&pe(t,"max-width",s[0].thumbnail.width+"px"),a&1&&pe(t,"max-height",s[0].thumbnail.height+"px")},d(s){s&&p(e)}}}function vt(r){let e,t,l,s,a,n;return{c(){e=g("div"),t=g("video"),l=g("source"),a=g("track"),n=B(`
					Your browser does not support the video tag.`),this.h()},l(i){e=b(i,"DIV",{class:!0});var o=k(e);t=b(o,"VIDEO",{class:!0,style:!0});var c=k(t);l=b(c,"SOURCE",{src:!0}),a=b(c,"TRACK",{kind:!0}),n=H(c,`
					Your browser does not support the video tag.`),c.forEach(p),o.forEach(p),this.h()},h(){ue(l.src,s=r[0].video.url)||f(l,"src",s),f(a,"kind","captions"),t.controls=!0,f(t,"class","rounded max-w-md"),pe(t,"max-width",r[0].video.width+"px"),pe(t,"max-height",r[0].video.height+"px"),f(e,"class","mt-2")},m(i,o){N(i,e,o),u(e,t),u(t,l),u(t,a),u(t,n)},p(i,o){o&1&&!ue(l.src,s=i[0].video.url)&&f(l,"src",s),o&1&&pe(t,"max-width",i[0].video.width+"px"),o&1&&pe(t,"max-height",i[0].video.height+"px")},d(i){i&&p(e)}}}function _t(r){let e,t=ne(r[0].images),l=[];for(let s=0;s<t.length;s+=1)l[s]=bt(ot(r,t,s));return{c(){e=g("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(p),this.h()},h(){f(e,"class","flex flex-wrap gap-2 mt-2")},m(s,a){N(s,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(s,a){if(a&1){t=ne(s[0].images);let n;for(n=0;n<t.length;n+=1){const i=ot(s,t,n);l[n]?l[n].p(i,a):(l[n]=bt(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(s){s&&p(e),Se(l,s)}}}function bt(r){let e,t;return{c(){e=g("img"),this.h()},l(l){e=b(l,"IMG",{src:!0,alt:!0,class:!0,loading:!0,style:!0}),this.h()},h(){ue(e.src,t=r[2].url)||f(e,"src",t),f(e,"alt","Embed"),f(e,"class","rounded"),f(e,"loading","lazy"),pe(e,"max-width",r[2].width+"px"),pe(e,"max-height",r[2].height+"px")},m(l,s){N(l,e,s)},p(l,s){s&1&&!ue(e.src,t=l[2].url)&&f(e,"src",t),s&1&&pe(e,"max-width",l[2].width+"px"),s&1&&pe(e,"max-height",l[2].height+"px")},d(l){l&&p(e)}}}function os(r){let e,t=r[1]&&ut(r);return{c(){t&&t.c(),e=be()},l(l){t&&t.l(l),e=be()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,[s]){l[1]?t?t.p(l,s):(t=ut(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&p(e),t&&t.d(l)}}}function cs(r,e,t){let l,{embed:s}=e;return r.$$set=a=>{"embed"in a&&t(0,s=a.embed)},r.$$.update=()=>{r.$$.dirty&1&&t(1,l=s.title||s.description||s.thumbnail||s.video)},[s,l]}class us extends de{constructor(e){super(),me(this,e,cs,os,he,{embed:0})}}function gt(r,e,t){const l=r.slice();return l[3]=e[t],l}function wt(r){let e,t,l,s=r[0].emoji.name+"",a,n,i=ne(r[0].users),o=[];for(let c=0;c<i.length;c+=1)o[c]=kt(gt(r,i,c));return{c(){e=g("div"),t=g("div"),l=B("Reacted with "),a=B(s),n=I();for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){e=b(c,"DIV",{class:!0});var h=k(e);t=b(h,"DIV",{class:!0});var d=k(t);l=H(d,"Reacted with "),a=H(d,s),d.forEach(p),n=y(h);for(let _=0;_<o.length;_+=1)o[_].l(h);h.forEach(p),this.h()},h(){f(t,"class","text-xs font-semibold mb-1"),f(e,"class","absolute bottom-full left-0 mb-2 bg-base-300 rounded p-2 shadow-lg z-10 whitespace-nowrap")},m(c,h){N(c,e,h),u(e,t),u(t,l),u(t,a),u(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(e,null)},p(c,h){if(h&1&&s!==(s=c[0].emoji.name+"")&&K(a,s),h&1){i=ne(c[0].users);let d;for(d=0;d<i.length;d+=1){const _=gt(c,i,d);o[d]?o[d].p(_,h):(o[d]=kt(_),o[d].c(),o[d].m(e,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=i.length}},d(c){c&&p(e),Se(o,c)}}}function kt(r){let e,t=(r[3].nickname||r[3].name)+"",l,s;return{c(){e=g("div"),l=B(t),s=I(),this.h()},l(a){e=b(a,"DIV",{class:!0});var n=k(e);l=H(n,t),s=y(n),n.forEach(p),this.h()},h(){f(e,"class","text-xs py-0.5")},m(a,n){N(a,e,n),u(e,l),u(e,s)},p(a,n){n&1&&t!==(t=(a[3].nickname||a[3].name)+"")&&K(l,t)},d(a){a&&p(e)}}}function fs(r){let e,t,l,s=r[0].emoji.name+"",a,n,i,o=r[0].count+"",c,h,d,_,m,v=r[1]&&r[0].users.length>0&&wt(r);return{c(){e=g("div"),t=g("button"),l=g("span"),a=B(s),n=I(),i=g("span"),c=B(o),d=I(),v&&v.c(),this.h()},l(w){e=b(w,"DIV",{class:!0});var E=k(e);t=b(E,"BUTTON",{class:!0,title:!0});var S=k(t);l=b(S,"SPAN",{class:!0});var M=k(l);a=H(M,s),M.forEach(p),n=y(S),i=b(S,"SPAN",{class:!0});var P=k(i);c=H(P,o),P.forEach(p),S.forEach(p),d=y(E),v&&v.l(E),E.forEach(p),this.h()},h(){f(l,"class","text-base"),f(i,"class","text-xs opacity-70"),f(t,"class","badge badge-ghost gap-1 cursor-pointer hover:bg-base-300 transition"),f(t,"title",h=r[0].users.map(Et).join(", ")),f(e,"class","relative inline-block")},m(w,E){N(w,e,E),u(e,t),u(t,l),u(l,a),u(t,n),u(t,i),u(i,c),u(e,d),v&&v.m(e,null),_||(m=se(t,"click",r[2]),_=!0)},p(w,[E]){E&1&&s!==(s=w[0].emoji.name+"")&&K(a,s),E&1&&o!==(o=w[0].count+"")&&K(c,o),E&1&&h!==(h=w[0].users.map(Et).join(", "))&&f(t,"title",h),w[1]&&w[0].users.length>0?v?v.p(w,E):(v=wt(w),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i:$,o:$,d(w){w&&p(e),v&&v.d(),_=!1,m()}}}const Et=r=>r.nickname||r.name;function hs(r,e,t){let{reaction:l}=e,s=!1;function a(){t(1,s=!s)}return r.$$set=n=>{"reaction"in n&&t(0,l=n.reaction)},[l,s,a]}class ds extends de{constructor(e){super(),me(this,e,hs,fs,he,{reaction:0})}}function St(r,e,t){const l=r.slice();return l[8]=e[t],l}function Dt(r,e,t){const l=r.slice();return l[11]=e[t],l}function Ct(r,e,t){const l=r.slice();return l[14]=e[t],l}function yt(r,e,t){const l=r.slice();return l[17]=e[t],l}function ms(r){let e,t=new Date(r[0].timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})+"",l;return{c(){e=g("span"),l=B(t),this.h()},l(s){e=b(s,"SPAN",{class:!0});var a=k(e);l=H(a,t),a.forEach(p),this.h()},h(){f(e,"class","text-xs text-base-content/30 opacity-0 group-hover:opacity-100 transition text-right block pr-1")},m(s,a){N(s,e,a),u(e,l)},p(s,a){a&1&&t!==(t=new Date(s[0].timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})+"")&&K(l,t)},d(s){s&&p(e)}}}function ps(r){let e,t;return{c(){e=g("img"),this.h()},l(l){e=b(l,"IMG",{src:!0,alt:!0,class:!0,loading:!0}),this.h()},h(){ue(e.src,t=r[0].author.avatarUrl)||f(e,"src",t),f(e,"alt",r[3]),f(e,"class","w-10 h-10 rounded-full"),f(e,"loading","lazy")},m(l,s){N(l,e,s)},p(l,s){s&1&&!ue(e.src,t=l[0].author.avatarUrl)&&f(e,"src",t),s&8&&f(e,"alt",l[3])},d(l){l&&p(e)}}}function It(r){let e,t,l,s,a,n,i,o,c,h,d=r[2]&&Tt(),_=r[0].timestampEdited&&At(r),m=r[0].isPinned&&Ut();return{c(){e=g("div"),t=g("span"),l=B(r[3]),a=I(),d&&d.c(),n=I(),i=g("span"),o=B(r[6]),c=I(),_&&_.c(),h=I(),m&&m.c(),this.h()},l(v){e=b(v,"DIV",{class:!0});var w=k(e);t=b(w,"SPAN",{class:!0,style:!0});var E=k(t);l=H(E,r[3]),E.forEach(p),a=y(w),d&&d.l(w),n=y(w),i=b(w,"SPAN",{class:!0,title:!0});var S=k(i);o=H(S,r[6]),S.forEach(p),c=y(w),_&&_.l(w),h=y(w),m&&m.l(w),w.forEach(p),this.h()},h(){f(t,"class","font-semibold text-base"),f(t,"style",s=r[0].author.color?`color: ${r[0].author.color}`:""),f(i,"class","text-xs text-base-content/50"),f(i,"title",r[5]),f(e,"class","flex items-baseline gap-2 mb-0.5")},m(v,w){N(v,e,w),u(e,t),u(t,l),u(e,a),d&&d.m(e,null),u(e,n),u(e,i),u(i,o),u(e,c),_&&_.m(e,null),u(e,h),m&&m.m(e,null)},p(v,w){w&8&&K(l,v[3]),w&1&&s!==(s=v[0].author.color?`color: ${v[0].author.color}`:"")&&f(t,"style",s),v[2]?d||(d=Tt(),d.c(),d.m(e,n)):d&&(d.d(1),d=null),w&64&&K(o,v[6]),w&32&&f(i,"title",v[5]),v[0].timestampEdited?_?_.p(v,w):(_=At(v),_.c(),_.m(e,h)):_&&(_.d(1),_=null),v[0].isPinned?m||(m=Ut(),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(v){v&&p(e),d&&d.d(),_&&_.d(),m&&m.d()}}}function Tt(r){let e,t="BOT";return{c(){e=g("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-7rau7y"&&(e.textContent=t),this.h()},h(){f(e,"class","badge badge-primary badge-xs")},m(l,s){N(l,e,s)},d(l){l&&p(e)}}}function At(r){let e,t,l;return{c(){e=g("span"),t=B("(edited)"),this.h()},l(s){e=b(s,"SPAN",{class:!0,title:!0});var a=k(e);t=H(a,"(edited)"),a.forEach(p),this.h()},h(){f(e,"class","text-xs text-base-content/40"),f(e,"title",l=new Date(r[0].timestampEdited).toLocaleString())},m(s,a){N(s,e,a),u(e,t)},p(s,a){a&1&&l!==(l=new Date(s[0].timestampEdited).toLocaleString())&&f(e,"title",l)},d(s){s&&p(e)}}}function Ut(r){let e,t="ðŸ“Œ";return{c(){e=g("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,title:!0,"data-svelte-h":!0}),J(e)!=="svelte-hpo2nn"&&(e.textContent=t),this.h()},h(){f(e,"class","text-xs"),f(e,"title","Pinned message")},m(l,s){N(l,e,s)},d(l){l&&p(e)}}}function Lt(r){let e,t='<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M10 8.5L14 12l-4 3.5v-7zm8 6V8l-8-6v6H4v8h6v6l8-6z"></path></svg> <span>Replying to a message</span>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1frdbuq"&&(e.innerHTML=t),this.h()},h(){f(e,"class","text-xs text-base-content/60 mb-1 flex items-center gap-1")},m(l,s){N(l,e,s)},d(l){l&&p(e)}}}function Vt(r){let e,t=r[0].content+"",l;return{c(){e=g("div"),l=B(t),this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);l=H(a,t),a.forEach(p),this.h()},h(){f(e,"class","text-base-content break-words whitespace-pre-wrap")},m(s,a){N(s,e,a),u(e,l)},p(s,a){a&1&&t!==(t=s[0].content+"")&&K(l,t)},d(s){s&&p(e)}}}function Mt(r){let e,t,l=ne(r[0].attachments),s=[];for(let n=0;n<l.length;n+=1)s[n]=Nt(yt(r,l,n));const a=n=>Y(s[n],1,1,()=>{s[n]=null});return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=be()},l(n){for(let i=0;i<s.length;i+=1)s[i].l(n);e=be()},m(n,i){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(n,i);N(n,e,i),t=!0},p(n,i){if(i&1){l=ne(n[0].attachments);let o;for(o=0;o<l.length;o+=1){const c=yt(n,l,o);s[o]?(s[o].p(c,i),z(s[o],1)):(s[o]=Nt(c),s[o].c(),z(s[o],1),s[o].m(e.parentNode,e))}for(ve(),o=l.length;o<s.length;o+=1)a(o);_e()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)z(s[i]);t=!0}},o(n){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Y(s[i]);t=!1},d(n){n&&p(e),Se(s,n)}}}function Nt(r){let e,t;return e=new ns({props:{attachment:r[17]}}),{c(){Ee(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,s){we(e,l,s),t=!0},p(l,s){const a={};s&1&&(a.attachment=l[17]),e.$set(a)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){Y(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function Pt(r){let e,t,l=ne(r[0].embeds),s=[];for(let n=0;n<l.length;n+=1)s[n]=jt(Ct(r,l,n));const a=n=>Y(s[n],1,1,()=>{s[n]=null});return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=be()},l(n){for(let i=0;i<s.length;i+=1)s[i].l(n);e=be()},m(n,i){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(n,i);N(n,e,i),t=!0},p(n,i){if(i&1){l=ne(n[0].embeds);let o;for(o=0;o<l.length;o+=1){const c=Ct(n,l,o);s[o]?(s[o].p(c,i),z(s[o],1)):(s[o]=jt(c),s[o].c(),z(s[o],1),s[o].m(e.parentNode,e))}for(ve(),o=l.length;o<s.length;o+=1)a(o);_e()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)z(s[i]);t=!0}},o(n){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Y(s[i]);t=!1},d(n){n&&p(e),Se(s,n)}}}function jt(r){let e,t;return e=new us({props:{embed:r[14]}}),{c(){Ee(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,s){we(e,l,s),t=!0},p(l,s){const a={};s&1&&(a.embed=l[14]),e.$set(a)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){Y(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function Ht(r){let e,t=ne(r[0].stickers),l=[];for(let s=0;s<t.length;s+=1)l[s]=Bt(Dt(r,t,s));return{c(){e=g("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);for(let n=0;n<l.length;n+=1)l[n].l(a);a.forEach(p),this.h()},h(){f(e,"class","mt-2 flex flex-wrap gap-2")},m(s,a){N(s,e,a);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(s,a){if(a&1){t=ne(s[0].stickers);let n;for(n=0;n<t.length;n+=1){const i=Dt(s,t,n);l[n]?l[n].p(i,a):(l[n]=Bt(i),l[n].c(),l[n].m(e,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=t.length}},d(s){s&&p(e),Se(l,s)}}}function Bt(r){let e,t,l,s=r[11].name+"",a,n,i;return{c(){e=g("div"),t=g("span"),l=B("[Sticker: "),a=B(s),n=B("]"),i=I(),this.h()},l(o){e=b(o,"DIV",{class:!0});var c=k(e);t=b(c,"SPAN",{class:!0});var h=k(t);l=H(h,"[Sticker: "),a=H(h,s),n=H(h,"]"),h.forEach(p),i=y(c),c.forEach(p),this.h()},h(){f(t,"class","font-medium"),f(e,"class","text-sm text-base-content/70")},m(o,c){N(o,e,c),u(e,t),u(t,l),u(t,a),u(t,n),u(e,i)},p(o,c){c&1&&s!==(s=o[11].name+"")&&K(a,s)},d(o){o&&p(e)}}}function Ot(r){let e,t,l=ne(r[0].reactions),s=[];for(let n=0;n<l.length;n+=1)s[n]=Ft(St(r,l,n));const a=n=>Y(s[n],1,1,()=>{s[n]=null});return{c(){e=g("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=b(n,"DIV",{class:!0});var i=k(e);for(let o=0;o<s.length;o+=1)s[o].l(i);i.forEach(p),this.h()},h(){f(e,"class","flex flex-wrap gap-1 mt-2")},m(n,i){N(n,e,i);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(n,i){if(i&1){l=ne(n[0].reactions);let o;for(o=0;o<l.length;o+=1){const c=St(n,l,o);s[o]?(s[o].p(c,i),z(s[o],1)):(s[o]=Ft(c),s[o].c(),z(s[o],1),s[o].m(e,null))}for(ve(),o=l.length;o<s.length;o+=1)a(o);_e()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)z(s[i]);t=!0}},o(n){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Y(s[i]);t=!1},d(n){n&&p(e),Se(s,n)}}}function Ft(r){let e,t;return e=new ds({props:{reaction:r[8]}}),{c(){Ee(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,s){we(e,l,s),t=!0},p(l,s){const a={};s&1&&(a.reaction=l[8]),e.$set(a)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){Y(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function vs(r){let e,t,l,s,a,n,i,o,c,h,d,_;function m(A,C){return A[1]&&!A[4]?ps:ms}let v=m(r),w=v(r),E=r[1]&&!r[4]&&It(r),S=r[0].reference&&Lt(),M=r[0].content&&Vt(r),P=r[0].attachments.length>0&&Mt(r),j=r[0].embeds.length>0&&Pt(r),V=r[0].stickers.length>0&&Ht(r),U=r[0].reactions.length>0&&Ot(r);return{c(){e=g("div"),t=g("div"),l=g("div"),w.c(),s=I(),a=g("div"),E&&E.c(),n=I(),S&&S.c(),i=I(),M&&M.c(),o=I(),P&&P.c(),c=I(),j&&j.c(),h=I(),V&&V.c(),d=I(),U&&U.c(),this.h()},l(A){e=b(A,"DIV",{class:!0});var C=k(e);t=b(C,"DIV",{class:!0});var D=k(t);l=b(D,"DIV",{class:!0});var T=k(l);w.l(T),T.forEach(p),s=y(D),a=b(D,"DIV",{class:!0});var L=k(a);E&&E.l(L),n=y(L),S&&S.l(L),i=y(L),M&&M.l(L),o=y(L),P&&P.l(L),c=y(L),j&&j.l(L),h=y(L),V&&V.l(L),d=y(L),U&&U.l(L),L.forEach(p),D.forEach(p),C.forEach(p),this.h()},h(){f(l,"class","w-10 flex-shrink-0 mt-0.5"),f(a,"class","flex-1 min-w-0"),f(t,"class","flex gap-4"),f(e,"class","message-container group hover:bg-base-200/50 py-0.5 px-4 transition svelte-1x2tzye")},m(A,C){N(A,e,C),u(e,t),u(t,l),w.m(l,null),u(t,s),u(t,a),E&&E.m(a,null),u(a,n),S&&S.m(a,null),u(a,i),M&&M.m(a,null),u(a,o),P&&P.m(a,null),u(a,c),j&&j.m(a,null),u(a,h),V&&V.m(a,null),u(a,d),U&&U.m(a,null),_=!0},p(A,[C]){v===(v=m(A))&&w?w.p(A,C):(w.d(1),w=v(A),w&&(w.c(),w.m(l,null))),A[1]&&!A[4]?E?E.p(A,C):(E=It(A),E.c(),E.m(a,n)):E&&(E.d(1),E=null),A[0].reference?S||(S=Lt(),S.c(),S.m(a,i)):S&&(S.d(1),S=null),A[0].content?M?M.p(A,C):(M=Vt(A),M.c(),M.m(a,o)):M&&(M.d(1),M=null),A[0].attachments.length>0?P?(P.p(A,C),C&1&&z(P,1)):(P=Mt(A),P.c(),z(P,1),P.m(a,c)):P&&(ve(),Y(P,1,1,()=>{P=null}),_e()),A[0].embeds.length>0?j?(j.p(A,C),C&1&&z(j,1)):(j=Pt(A),j.c(),z(j,1),j.m(a,h)):j&&(ve(),Y(j,1,1,()=>{j=null}),_e()),A[0].stickers.length>0?V?V.p(A,C):(V=Ht(A),V.c(),V.m(a,d)):V&&(V.d(1),V=null),A[0].reactions.length>0?U?(U.p(A,C),C&1&&z(U,1)):(U=Ot(A),U.c(),z(U,1),U.m(a,null)):U&&(ve(),Y(U,1,1,()=>{U=null}),_e())},i(A){_||(z(P),z(j),z(U),_=!0)},o(A){Y(P),Y(j),Y(U),_=!1},d(A){A&&p(e),w.d(),E&&E.d(),S&&S.d(),M&&M.d(),P&&P.d(),j&&j.d(),V&&V.d(),U&&U.d()}}}function _s(r){const e=new Date(r),t=new Date,l=e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear(),s=new Date(t);s.setDate(s.getDate()-1);const a=e.getDate()===s.getDate()&&e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear(),n=e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return l?`Today at ${n}`:a?`Yesterday at ${n}`:`${e.toLocaleDateString()} at ${n}`}function bs(r,e,t){let l,s,a,n,i,{message:o}=e,{showAvatar:c=!0}=e,{previousMessage:h=null}=e;return r.$$set=d=>{"message"in d&&t(0,o=d.message),"showAvatar"in d&&t(1,c=d.showAvatar),"previousMessage"in d&&t(7,h=d.previousMessage)},r.$$.update=()=>{r.$$.dirty&1&&t(6,l=_s(o.timestamp)),r.$$.dirty&1&&t(5,s=new Date(o.timestamp).toLocaleString()),r.$$.dirty&131&&t(4,a=!c&&h&&h.author.id===o.author.id&&new Date(o.timestamp).getTime()-new Date(h.timestamp).getTime()<5*60*1e3),r.$$.dirty&1&&t(3,n=o.author.nickname||o.author.name),r.$$.dirty&1&&t(2,i=o.author.isBot)},[o,c,i,n,a,s,l,h]}class gs extends de{constructor(e){super(),me(this,e,bs,vs,he,{message:0,showAvatar:1,previousMessage:7})}}function qt(r){let e,t,l;return{c(){e=g("img"),this.h()},l(s){e=b(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ue(e.src,t=r[0].iconUrl)||f(e,"src",t),f(e,"alt",l=r[0].name),f(e,"class","w-8 h-8 rounded-full")},m(s,a){N(s,e,a)},p(s,a){a&1&&!ue(e.src,t=s[0].iconUrl)&&f(e,"src",t),a&1&&l!==(l=s[0].name)&&f(e,"alt",l)},d(s){s&&p(e)}}}function Rt(r){let e,t="ðŸ”’";return{c(){e=g("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1vmpw4h"&&(e.textContent=t),this.h()},h(){f(e,"class","text-lg")},m(l,s){N(l,e,s)},d(l){l&&p(e)}}}function Gt(r){let e,t="â€¢",l,s=r[1].category+"",a;return{c(){e=g("span"),e.textContent=t,l=I(),a=B(s),this.h()},l(n){e=b(n,"SPAN",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-3gu6cy"&&(e.textContent=t),l=y(n),a=H(n,s),this.h()},h(){f(e,"class","mx-1")},m(n,i){N(n,e,i),N(n,l,i),N(n,a,i)},p(n,i){i&2&&s!==(s=n[1].category+"")&&K(a,s)},d(n){n&&(p(e),p(l),p(a))}}}function zt(r){let e,t=r[1].topic+"",l;return{c(){e=g("div"),l=B(t),this.h()},l(s){e=b(s,"DIV",{class:!0});var a=k(e);l=H(a,t),a.forEach(p),this.h()},h(){f(e,"class","mt-2 text-sm text-base-content/70")},m(s,a){N(s,e,a),u(e,l)},p(s,a){a&2&&t!==(t=s[1].topic+"")&&K(l,t)},d(s){s&&p(e)}}}function ws(r){let e,t,l,s,a,n,i="#",o,c,h=r[1].name+"",d,_,m=r[2].export_path.endsWith(".enc"),v,w,E=r[0].name+"",S,M,P,j,V,U,A,C=new Date(r[2].exported_at).toLocaleString()+"",D,T,L,F,O,R=r[3]===1?"message":"messages",X,ae,ie,ee=r[2].format+"",Z,q=r[0].iconUrl&&qt(r),te=m&&Rt(),le=r[1].category&&Gt(r),Q=r[1].topic&&zt(r);return{c(){e=g("div"),t=g("div"),q&&q.c(),l=I(),s=g("div"),a=g("div"),n=g("span"),n.textContent=i,o=I(),c=g("h2"),d=B(h),_=I(),te&&te.c(),v=I(),w=g("div"),S=B(E),M=I(),le&&le.c(),P=I(),Q&&Q.c(),j=I(),V=g("div"),U=g("span"),A=B("Exported: "),D=B(C),T=I(),L=g("span"),F=B(r[3]),O=I(),X=B(R),ae=I(),ie=g("span"),Z=B(ee),this.h()},l(W){e=b(W,"DIV",{class:!0});var G=k(e);t=b(G,"DIV",{class:!0});var x=k(t);q&&q.l(x),l=y(x),s=b(x,"DIV",{class:!0});var oe=k(s);a=b(oe,"DIV",{class:!0});var fe=k(a);n=b(fe,"SPAN",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-kcoxxm"&&(n.textContent=i),o=y(fe),c=b(fe,"H2",{class:!0});var De=k(c);d=H(De,h),De.forEach(p),_=y(fe),te&&te.l(fe),fe.forEach(p),v=y(oe),w=b(oe,"DIV",{class:!0});var ye=k(w);S=H(ye,E),M=y(ye),le&&le.l(ye),ye.forEach(p),oe.forEach(p),x.forEach(p),P=y(G),Q&&Q.l(G),j=y(G),V=b(G,"DIV",{class:!0});var Ce=k(V);U=b(Ce,"SPAN",{});var Re=k(U);A=H(Re,"Exported: "),D=H(Re,C),Re.forEach(p),T=y(Ce),L=b(Ce,"SPAN",{});var He=k(L);F=H(He,r[3]),O=y(He),X=H(He,R),He.forEach(p),ae=y(Ce),ie=b(Ce,"SPAN",{class:!0});var We=k(ie);Z=H(We,ee),We.forEach(p),Ce.forEach(p),G.forEach(p),this.h()},h(){f(n,"class","text-base-content/60"),f(c,"class","text-lg font-semibold"),f(a,"class","flex items-center gap-2"),f(w,"class","text-sm text-base-content/60"),f(s,"class","flex-1"),f(t,"class","flex items-center gap-3"),f(ie,"class","uppercase font-semibold"),f(V,"class","mt-2 text-xs text-base-content/50 flex gap-4"),f(e,"class","p-4 bg-base-200 border-b border-base-300")},m(W,G){N(W,e,G),u(e,t),q&&q.m(t,null),u(t,l),u(t,s),u(s,a),u(a,n),u(a,o),u(a,c),u(c,d),u(a,_),te&&te.m(a,null),u(s,v),u(s,w),u(w,S),u(w,M),le&&le.m(w,null),u(e,P),Q&&Q.m(e,null),u(e,j),u(e,V),u(V,U),u(U,A),u(U,D),u(V,T),u(V,L),u(L,F),u(L,O),u(L,X),u(V,ae),u(V,ie),u(ie,Z)},p(W,[G]){W[0].iconUrl?q?q.p(W,G):(q=qt(W),q.c(),q.m(t,l)):q&&(q.d(1),q=null),G&2&&h!==(h=W[1].name+"")&&K(d,h),G&4&&(m=W[2].export_path.endsWith(".enc")),m?te||(te=Rt(),te.c(),te.m(a,null)):te&&(te.d(1),te=null),G&1&&E!==(E=W[0].name+"")&&K(S,E),W[1].category?le?le.p(W,G):(le=Gt(W),le.c(),le.m(w,null)):le&&(le.d(1),le=null),W[1].topic?Q?Q.p(W,G):(Q=zt(W),Q.c(),Q.m(e,j)):Q&&(Q.d(1),Q=null),G&4&&C!==(C=new Date(W[2].exported_at).toLocaleString()+"")&&K(D,C),G&8&&K(F,W[3]),G&8&&R!==(R=W[3]===1?"message":"messages")&&K(X,R),G&4&&ee!==(ee=W[2].format+"")&&K(Z,ee)},i:$,o:$,d(W){W&&p(e),q&&q.d(),te&&te.d(),le&&le.d(),Q&&Q.d()}}}function ks(r,e,t){let{guild:l}=e,{channel:s}=e,{archive:a}=e,{messageCount:n}=e;return r.$$set=i=>{"guild"in i&&t(0,l=i.guild),"channel"in i&&t(1,s=i.channel),"archive"in i&&t(2,a=i.archive),"messageCount"in i&&t(3,n=i.messageCount)},[l,s,a,n]}class Es extends de{constructor(e){super(),me(this,e,ks,ws,he,{guild:0,channel:1,archive:2,messageCount:3})}}function Kt(r,e,t){const l=r.slice();return l[7]=e[t],l[9]=t,l}function Ss(r){let e,t,l,s,a,n,i=r[2]===1?"message":"messages",o,c,h=ne(r[1]),d=[];for(let m=0;m<h.length;m+=1)d[m]=Wt(Kt(r,h,m));const _=m=>Y(d[m],1,1,()=>{d[m]=null});return{c(){e=g("div");for(let m=0;m<d.length;m+=1)d[m].c();t=I(),l=g("div"),s=B("End of archive â€¢ "),a=B(r[2]),n=I(),o=B(i),this.h()},l(m){e=b(m,"DIV",{class:!0});var v=k(e);for(let E=0;E<d.length;E+=1)d[E].l(v);v.forEach(p),t=y(m),l=b(m,"DIV",{class:!0});var w=k(l);s=H(w,"End of archive â€¢ "),a=H(w,r[2]),n=y(w),o=H(w,i),w.forEach(p),this.h()},h(){f(e,"class","py-4"),f(l,"class","px-4 pb-4 text-center text-sm text-base-content/50")},m(m,v){N(m,e,v);for(let w=0;w<d.length;w+=1)d[w]&&d[w].m(e,null);N(m,t,v),N(m,l,v),u(l,s),u(l,a),u(l,n),u(l,o),c=!0},p(m,v){if(v&34){h=ne(m[1]);let w;for(w=0;w<h.length;w+=1){const E=Kt(m,h,w);d[w]?(d[w].p(E,v),z(d[w],1)):(d[w]=Wt(E),d[w].c(),z(d[w],1),d[w].m(e,null))}for(ve(),w=h.length;w<d.length;w+=1)_(w);_e()}(!c||v&4)&&K(a,m[2]),(!c||v&4)&&i!==(i=m[2]===1?"message":"messages")&&K(o,i)},i(m){if(!c){for(let v=0;v<h.length;v+=1)z(d[v]);c=!0}},o(m){d=d.filter(Boolean);for(let v=0;v<d.length;v+=1)Y(d[v]);c=!1},d(m){m&&(p(e),p(t),p(l)),Se(d,m)}}}function Ds(r){let e,t='<div class="text-6xl mb-4">ðŸ’¬</div> <div class="text-lg">No messages in this archive</div>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-aq7gij"&&(e.innerHTML=t),this.h()},h(){f(e,"class","flex flex-col items-center justify-center h-full text-base-content/40")},m(l,s){N(l,e,s)},p:$,i:$,o:$,d(l){l&&p(e)}}}function Wt(r){let e,t;return e=new gs({props:{message:r[7],showAvatar:r[5](r[9]),previousMessage:r[9]>0?r[1][r[9]-1]:null}}),{c(){Ee(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,s){we(e,l,s),t=!0},p(l,s){const a={};s&2&&(a.message=l[7]),s&2&&(a.previousMessage=l[9]>0?l[1][l[9]-1]:null),e.$set(a)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){Y(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function Cs(r){let e,t,l,s,a,n,i;t=new Es({props:{guild:r[4],channel:r[3],archive:r[0],messageCount:r[2]}});const o=[Ds,Ss],c=[];function h(d,_){return d[1].length===0?0:1}return a=h(r),n=c[a]=o[a](r),{c(){e=g("div"),Ee(t.$$.fragment),l=I(),s=g("div"),n.c(),this.h()},l(d){e=b(d,"DIV",{class:!0});var _=k(e);ke(t.$$.fragment,_),l=y(_),s=b(_,"DIV",{class:!0});var m=k(s);n.l(m),m.forEach(p),_.forEach(p),this.h()},h(){f(s,"class","flex-1 overflow-y-auto"),f(e,"class","flex flex-col h-full bg-base-100")},m(d,_){N(d,e,_),we(t,e,null),u(e,l),u(e,s),c[a].m(s,null),i=!0},p(d,[_]){const m={};_&16&&(m.guild=d[4]),_&8&&(m.channel=d[3]),_&1&&(m.archive=d[0]),_&4&&(m.messageCount=d[2]),t.$set(m);let v=a;a=h(d),a===v?c[a].p(d,_):(ve(),Y(c[v],1,1,()=>{c[v]=null}),_e(),n=c[a],n?n.p(d,_):(n=c[a]=o[a](d),n.c()),z(n,1),n.m(s,null))},i(d){i||(z(t.$$.fragment,d),z(n),i=!0)},o(d){Y(t.$$.fragment,d),Y(n),i=!1},d(d){d&&p(e),ge(t),c[a].d()}}}function ys(r,e,t){let l,s,a,n,{jsonData:i}=e,{archive:o}=e;function c(h){if(h===0)return!0;const d=l[h],_=l[h-1];return d.author.id!==_.author.id?!0:new Date(d.timestamp).getTime()-new Date(_.timestamp).getTime()>5*60*1e3}return r.$$set=h=>{"jsonData"in h&&t(6,i=h.jsonData),"archive"in h&&t(0,o=h.archive)},r.$$.update=()=>{r.$$.dirty&64&&t(1,l=i.messages||[]),r.$$.dirty&64&&t(4,s=i.guild),r.$$.dirty&64&&t(3,a=i.channel),r.$$.dirty&64&&t(2,n=i.messageCount)},[o,l,n,a,s,c,i]}class Is extends de{constructor(e){super(),me(this,e,ys,Cs,he,{jsonData:6,archive:0})}}function Ts(r){let e,t='<div class="text-6xl mb-4">ðŸ“–</div> <div class="text-lg">Select a channel from the sidebar to start browsing</div>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1qodbfi"&&(e.innerHTML=t),this.h()},h(){f(e,"class","flex flex-col items-center justify-center h-full text-base-content/40")},m(l,s){N(l,e,s)},p:$,i:$,o:$,d(l){l&&p(e)}}}function As(r){let e,t,l="âš ï¸",s,a,n,i=r[0].format+"",o,c,h,d="Supported: HTML, JSON";return{c(){e=g("div"),t=g("div"),t.textContent=l,s=I(),a=g("div"),n=B("Unsupported format: "),o=B(i),c=I(),h=g("div"),h.textContent=d,this.h()},l(_){e=b(_,"DIV",{class:!0});var m=k(e);t=b(m,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-gp558o"&&(t.textContent=l),s=y(m),a=b(m,"DIV",{class:!0});var v=k(a);n=H(v,"Unsupported format: "),o=H(v,i),v.forEach(p),c=y(m),h=b(m,"DIV",{class:!0,"data-svelte-h":!0}),J(h)!=="svelte-vafbzw"&&(h.textContent=d),m.forEach(p),this.h()},h(){f(t,"class","text-6xl mb-4"),f(a,"class","text-lg"),f(h,"class","text-sm mt-2"),f(e,"class","flex flex-col items-center justify-center h-full text-base-content/40")},m(_,m){N(_,e,m),u(e,t),u(e,s),u(e,a),u(a,n),u(a,o),u(e,c),u(e,h)},p(_,m){m&1&&i!==(i=_[0].format+"")&&K(o,i)},i:$,o:$,d(_){_&&p(e)}}}function Us(r){let e,t,l,s,a=(r[0]?.channel_name||r[0]?.channel_id||"Archive")+"",n,i,o=r[0]?.export_path.endsWith(".enc"),c,h,d,_=(r[0]?new Date(r[0].exported_at).toLocaleString():"N/A")+"",m,v,w=r[0]?.format.toUpperCase()+"",E,S,M,P,j=o&&Jt();return{c(){e=g("div"),t=g("div"),l=g("div"),s=g("h2"),n=B(a),i=I(),j&&j.c(),c=I(),h=g("div"),d=B("Latest export: "),m=B(_),v=B(" â€¢ "),E=B(w),S=I(),M=g("iframe"),this.h()},l(V){e=b(V,"DIV",{class:!0});var U=k(e);t=b(U,"DIV",{class:!0});var A=k(t);l=b(A,"DIV",{class:!0});var C=k(l);s=b(C,"H2",{class:!0});var D=k(s);n=H(D,a),i=y(D),j&&j.l(D),D.forEach(p),C.forEach(p),c=y(A),h=b(A,"DIV",{class:!0});var T=k(h);d=H(T,"Latest export: "),m=H(T,_),v=H(T," â€¢ "),E=H(T,w),T.forEach(p),A.forEach(p),S=y(U),M=b(U,"IFRAME",{src:!0,title:!0,class:!0}),k(M).forEach(p),U.forEach(p),this.h()},h(){f(s,"class","text-lg font-semibold"),f(l,"class","flex items-center gap-2"),f(h,"class","text-sm text-base-content/60 mt-1"),f(t,"class","p-4 bg-base-200 border-b border-base-300"),ue(M.src,P=r[1])||f(M,"src",P),f(M,"title","Archive viewer"),f(M,"class","flex-1 w-full border-0"),f(e,"class","flex-1 flex flex-col")},m(V,U){N(V,e,U),u(e,t),u(t,l),u(l,s),u(s,n),u(s,i),j&&j.m(s,null),u(t,c),u(t,h),u(h,d),u(h,m),u(h,v),u(h,E),u(e,S),u(e,M)},p(V,U){U&1&&a!==(a=(V[0]?.channel_name||V[0]?.channel_id||"Archive")+"")&&K(n,a),U&1&&(o=V[0]?.export_path.endsWith(".enc")),o?j||(j=Jt(),j.c(),j.m(s,null)):j&&(j.d(1),j=null),U&1&&_!==(_=(V[0]?new Date(V[0].exported_at).toLocaleString():"N/A")+"")&&K(m,_),U&1&&w!==(w=V[0]?.format.toUpperCase()+"")&&K(E,w),U&2&&!ue(M.src,P=V[1])&&f(M,"src",P)},i:$,o:$,d(V){V&&p(e),j&&j.d()}}}function Ls(r){let e,t;return e=new Is({props:{jsonData:r[2],archive:r[0]}}),{c(){Ee(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,s){we(e,l,s),t=!0},p(l,s){const a={};s&4&&(a.jsonData=l[2]),s&1&&(a.archive=l[0]),e.$set(a)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){Y(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function Vs(r){let e,t='<div class="loading loading-spinner loading-lg"></div>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1urjiaz"&&(e.innerHTML=t),this.h()},h(){f(e,"class","flex items-center justify-center h-full")},m(l,s){N(l,e,s)},p:$,i:$,o:$,d(l){l&&p(e)}}}function Jt(r){let e,t="ðŸ”’";return{c(){e=g("span"),e.textContent=t,this.h()},l(l){e=b(l,"SPAN",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-1cny2mi"&&(e.textContent=t),this.h()},h(){f(e,"class","ml-2")},m(l,s){N(l,e,s)},d(l){l&&p(e)}}}function Ms(r){let e,t,l,s,a;const n=[Vs,Ls,Us,As,Ts],i=[];function o(c,h){return c[3]?0:c[5]&&c[2]&&c[0]?1:c[4]&&c[1]?2:c[0]?3:4}return l=o(r),s=i[l]=n[l](r),{c(){e=g("div"),t=g("div"),s.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var h=k(e);t=b(h,"DIV",{class:!0});var d=k(t);s.l(d),d.forEach(p),h.forEach(p),this.h()},h(){f(t,"class","flex-1 overflow-hidden"),f(e,"class","flex-1 flex flex-col bg-base-100")},m(c,h){N(c,e,h),u(e,t),i[l].m(t,null),a=!0},p(c,[h]){let d=l;l=o(c),l===d?i[l].p(c,h):(ve(),Y(i[d],1,1,()=>{i[d]=null}),_e(),s=i[l],s?s.p(c,h):(s=i[l]=n[l](c),s.c()),z(s,1),s.m(t,null))},i(c){a||(z(s),a=!0)},o(c){Y(s),a=!1},d(c){c&&p(e),i[l].d()}}}function Ns(r,e,t){let l,s,{archive:a=null}=e,{blobUrl:n=null}=e,{jsonData:i=null}=e,{isLoading:o=!1}=e;return r.$$set=c=>{"archive"in c&&t(0,a=c.archive),"blobUrl"in c&&t(1,n=c.blobUrl),"jsonData"in c&&t(2,i=c.jsonData),"isLoading"in c&&t(3,o=c.isLoading)},r.$$.update=()=>{r.$$.dirty&1&&t(5,l=a?.format==="json"),r.$$.dirty&1&&t(4,s=a?.format?.startsWith("html")||!1)},[a,n,i,o,s,l]}class Ps extends de{constructor(e){super(),me(this,e,Ns,Ms,he,{archive:0,blobUrl:1,jsonData:2,isLoading:3})}}function Yt(r,e,t){const l=r.slice();return l[21]=e[t],l}function Zt(r){let e,t;return e=new Pl({}),e.$on("openSettings",r[12]),{c(){Ee(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,s){we(e,l,s),t=!0},p:$,i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){Y(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function Qt(r){let e,t,l,s;return e=new Ql({props:{$$slots:{default:[js]},$$scope:{ctx:r}}}),e.$on("openSettings",r[12]),l=new Ps({props:{archive:r[3],blobUrl:r[4],jsonData:r[5],isLoading:r[6]}}),{c(){Ee(e.$$.fragment),t=I(),Ee(l.$$.fragment)},l(a){ke(e.$$.fragment,a),t=y(a),ke(l.$$.fragment,a)},m(a,n){we(e,a,n),N(a,t,n),we(l,a,n),s=!0},p(a,n){const i={};n&16777728&&(i.$$scope={dirty:n,ctx:a}),e.$set(i);const o={};n&8&&(o.archive=a[3]),n&16&&(o.blobUrl=a[4]),n&32&&(o.jsonData=a[5]),n&64&&(o.isLoading=a[6]),l.$set(o)},i(a){s||(z(e.$$.fragment,a),z(l.$$.fragment,a),s=!0)},o(a){Y(e.$$.fragment,a),Y(l.$$.fragment,a),s=!1},d(a){a&&p(t),ge(e,a),ge(l,a)}}}function Xt(r){let e,t;return e=new $l({props:{server:r[21]}}),e.$on("selectChannel",r[10]),{c(){Ee(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,s){we(e,l,s),t=!0},p(l,s){const a={};s&512&&(a.server=l[21]),e.$set(a)},i(l){t||(z(e.$$.fragment,l),t=!0)},o(l){Y(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function js(r){let e,t,l=ne(r[9]),s=[];for(let n=0;n<l.length;n+=1)s[n]=Xt(Yt(r,l,n));const a=n=>Y(s[n],1,1,()=>{s[n]=null});return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=be()},l(n){for(let i=0;i<s.length;i+=1)s[i].l(n);e=be()},m(n,i){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(n,i);N(n,e,i),t=!0},p(n,i){if(i&1536){l=ne(n[9]);let o;for(o=0;o<l.length;o+=1){const c=Yt(n,l,o);s[o]?(s[o].p(c,i),z(s[o],1)):(s[o]=Xt(c),s[o].c(),z(s[o],1),s[o].m(e.parentNode,e))}for(ve(),o=l.length;o<s.length;o+=1)a(o);_e()}},i(n){if(!t){for(let i=0;i<l.length;i+=1)z(s[i]);t=!0}},o(n){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)Y(s[i]);t=!1},d(n){n&&p(e),Se(s,n)}}}function Hs(r){let e,t,l,s,a,n,i,o,c,h=!r[2].isUnlocked&&r[1]&&Zt(r);function d(w){r[15](w)}let _={archive:r[8]};r[7]!==void 0&&(_.show=r[7]),s=new Bl({props:_}),xt.push(()=>pl(s,"show",d)),s.$on("unlock",r[11]);let m={required:!r[1]&&!r[2].isUnlocked};i=new Jl({props:m}),r[16](i);let v=r[2].isUnlocked&&Qt(r);return{c(){e=I(),t=g("div"),h&&h.c(),l=I(),Ee(s.$$.fragment),n=I(),Ee(i.$$.fragment),o=I(),v&&v.c(),this.h()},l(w){dl("svelte-1nkvhcm",document.head).forEach(p),e=y(w),t=b(w,"DIV",{class:!0});var S=k(t);h&&h.l(S),l=y(S),ke(s.$$.fragment,S),n=y(S),ke(i.$$.fragment,S),o=y(S),v&&v.l(S),S.forEach(p),this.h()},h(){document.title="Discord Archive Browser",f(t,"class","flex h-screen overflow-hidden")},m(w,E){N(w,e,E),N(w,t,E),h&&h.m(t,null),u(t,l),we(s,t,null),u(t,n),we(i,t,null),u(t,o),v&&v.m(t,null),c=!0},p(w,[E]){!w[2].isUnlocked&&w[1]?h?(h.p(w,E),E&6&&z(h,1)):(h=Zt(w),h.c(),z(h,1),h.m(t,l)):h&&(ve(),Y(h,1,1,()=>{h=null}),_e());const S={};E&256&&(S.archive=w[8]),!a&&E&128&&(a=!0,S.show=w[7],hl(()=>a=!1)),s.$set(S);const M={};E&6&&(M.required=!w[1]&&!w[2].isUnlocked),i.$set(M),w[2].isUnlocked?v?(v.p(w,E),E&4&&z(v,1)):(v=Qt(w),v.c(),z(v,1),v.m(t,null)):v&&(ve(),Y(v,1,1,()=>{v=null}),_e())},i(w){c||(z(h),z(s.$$.fragment,w),z(i.$$.fragment,w),z(v),c=!0)},o(w){Y(h),Y(s.$$.fragment,w),Y(i.$$.fragment,w),Y(v),c=!1},d(w){w&&(p(e),p(t)),h&&h.d(),ge(s),r[16](null),ge(i),v&&v.d()}}}function Bs(r,e,t){let l,s,a,n,i,o;Le(r,Te,C=>t(14,n=C)),Le(r,Ie,C=>t(2,i=C)),Le(r,kl,C=>t(9,o=C));let c=null,h=null,d=null,_=!1,m=!1,v=null,w,E=!1;ml(async()=>{if(l&&!n.archiveSource)try{await new Fe(n.localServerUrl).testConnection()?Te.update(T=>({...T,archiveSource:"local"})):Te.update(T=>({...T,archiveSource:"github"}))}catch{Te.update(C=>({...C,archiveSource:"github"}))}});async function S(C){const D=C.detail;if(t(3,c=D),t(5,d=null),h&&h.startsWith("blob:")&&URL.revokeObjectURL(h),t(4,h=null),D.export_path.endsWith(".enc")){const T=el.get(D.secret_hint);T?await P(D,T):(t(8,v=D),t(7,m=!0))}else await j(D)}async function M(C){const{archive:D,password:T}=C.detail;await P(D,T),t(7,m=!1)}async function P(C,D){t(6,_=!0);try{const T=await Ll(C.export_path,D,a);if(C.format==="json"){const F=new TextDecoder().decode(T);t(5,d=JSON.parse(F)),t(4,h=null)}else t(4,h=Vl(T,C)),t(5,d=null)}catch(T){console.error("Failed to load encrypted archive:",T);const L=T instanceof Error?T.message:"The file may be corrupted.";alert(`Failed to decrypt and load archive: ${L}`)}finally{t(6,_=!1)}}async function j(C){t(6,_=!0);try{const D=await a.fetchFile(C.export_path);if(C.format==="json"){const L=new TextDecoder().decode(D);t(5,d=JSON.parse(L)),t(4,h=null)}else{const T=C.format.startsWith("html")?"text/html":"text/plain",L=new Blob([new Uint8Array(D)],{type:T});t(4,h=URL.createObjectURL(L)),t(5,d=null)}}catch(D){console.error("Failed to load unencrypted archive:",D);const T=D instanceof Error?D.message:"Failed to load from GitHub";alert(`Failed to load archive: ${T}`)}finally{t(6,_=!1)}}function V(){w.open()}function U(C){m=C,t(7,m)}function A(C){xt[C?"unshift":"push"](()=>{w=C,t(0,w)})}return r.$$.update=()=>{r.$$.dirty&16384&&t(1,s=n.archiveSource==="local"?!0:!!n.github.repoUrl),r.$$.dirty&8199&&!s&&!i.isUnlocked&&!E&&(t(13,E=!0),setTimeout(()=>w?.open(),100)),r.$$.dirty&16384&&(a=n.archiveSource==="local"?new Fe(n.localServerUrl):new Ke(n.github))},l=["localhost","127.0.0.1","0.0.0.0"].includes(window.location.hostname),[w,s,i,c,h,d,_,m,v,o,S,M,V,E,n,U,A]}class zs extends de{constructor(e){super(),me(this,e,Bs,Hs,he,{})}}export{zs as component,Gs as universal};
